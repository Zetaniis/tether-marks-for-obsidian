/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => TetherMarksPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian6 = require("obsidian");

// src/pluginOperations.ts
var import_obsidian2 = require("obsidian");

// ../../../../../../../Projects/tether-marks-core/dist/marks.js
function findFirstUnusedRegister(marks, registers) {
  for (const reg of registers) {
    if (!marks.map((m) => m.symbol).includes(reg)) {
      return reg;
    }
  }
  return null;
}
function getMarkBySymbol(marks, symbol) {
  return marks.find((m) => m.symbol === symbol);
}
function sortMarksAlphabetically(marks) {
  marks.sort((a, b) => a.symbol.localeCompare(b.symbol));
}
function getSortedAndFilteredMarks(marks, isHarpoonMode, settings) {
  const availableRegisters = new Set((!isHarpoonMode ? settings.registerList : settings.harpoonRegisterList).split(""));
  const filteredMarks = marks.filter((el) => availableRegisters.has(el.symbol));
  if (!isHarpoonMode && settings.registerSortByList) {
    const registerList = settings.registerList;
    sortMarksBySettingsRegisterOrder(filteredMarks, registerList);
  } else if (isHarpoonMode && settings.harpoonRegisterSortByList) {
    const registerList = settings.harpoonRegisterList;
    sortMarksBySettingsRegisterOrder(filteredMarks, registerList);
  } else {
    sortMarksAlphabetically(filteredMarks);
  }
  return filteredMarks;
}
function sortMarksBySettingsRegisterOrder(marks, registers) {
  const registerOrder = new Map([...registers].map((symbol, index) => [symbol, index]));
  marks.sort((a, b) => {
    var _a, _b;
    return ((_a = registerOrder.get(a.symbol)) !== null && _a !== void 0 ? _a : Infinity) - ((_b = registerOrder.get(b.symbol)) !== null && _b !== void 0 ? _b : Infinity);
  });
}
function removeGapsForHarpoonMarks(marksToCopy, harpoonRegisters) {
  let marks = [...marksToCopy];
  let leftCur = 0;
  let rightCur = 0;
  while (rightCur < harpoonRegisters.length) {
    const markEl = marks.find((el) => el.symbol === harpoonRegisters[rightCur]);
    if (markEl !== void 0) {
      const symbolToSetTo = harpoonRegisters[leftCur];
      let filteredMarks = marks.filter((el) => el.symbol !== harpoonRegisters[leftCur]);
      filteredMarks.push({ symbol: symbolToSetTo, filePath: markEl.filePath });
      marks = filteredMarks;
      leftCur += 1;
    }
    rightCur += 1;
  }
  while (leftCur < harpoonRegisters.length) {
    marks = marks.filter((el) => el.symbol !== harpoonRegisters[leftCur]);
    leftCur += 1;
  }
  return marks;
}
function restoreLastChangedMark(marks, lastChangedMark) {
  const markToRestore = { ...lastChangedMark };
  const markToDiscard = marks.find((m) => m.symbol === markToRestore.symbol);
  const marksWithoutDiscarded = marks.filter((m) => m.symbol !== markToRestore.symbol);
  marksWithoutDiscarded.push({ symbol: markToRestore.symbol, filePath: markToRestore.filePath });
  return { marks: marksWithoutDiscarded, markToDiscard };
}
function setNewOrOverwriteMark(marks, setMark, filePath) {
  const { marks: filteredMarks, deletedMark: overwrittenMark } = deleteMark(marks, setMark);
  filteredMarks.push({ symbol: setMark.symbol, filePath });
  return { marks: filteredMarks, overwrittenMark };
}
function deleteMark(marks, markToDelete) {
  const cMark = { ...markToDelete };
  const deletedMark = marks.find((m) => m.symbol === cMark.symbol);
  const filteredMarks = marks.filter((m) => m.symbol !== cMark.symbol);
  return { marks: filteredMarks, deletedMark };
}

// ../../../../../../../Projects/tether-marks-core/dist/defaultValues.js
var defaultBasicMarksSettings = {
  registerList: "abcdefghijklmnopqrstuvwxyz",
  registerSortByList: true,
  harpoonRegisterList: "qwer",
  harpoonRegisterSortByList: true,
  harpoonRegisterGapRemoval: true
};
var modeDescription = {
  "set": "Set mark",
  "goto": "Go to mark",
  "delete": "Delete mark"
};

// src/utils/obsidianUtils.ts
var import_obsidian = require("obsidian");
function openNewFileByPath(filePath, openFileInNewTab, app) {
  const file = app.vault.getAbstractFileByPath(filePath);
  if (file instanceof import_obsidian.TFile) {
    if (openFileInNewTab) {
      app.workspace.getLeaf("tab").openFile(file);
    } else {
      app.workspace.getLeaf().openFile(file);
    }
  } else {
    new import_obsidian.Notice(`File not found for path ${filePath}. The file may have been deleted, moved or renamed.`);
  }
}
function getAllOpenedFilesExperimental(app) {
  var _a;
  const tabGroups = (_a = app.workspace.getLayout().main) == null ? void 0 : _a.children;
  const out = [];
  for (const el of tabGroups) {
    out.push(...el.children);
  }
  return out;
}
function getAllWorkspaceLeaves(app) {
  const list = [];
  app.workspace.iterateAllLeaves((leaf) => {
    list.push(leaf);
  });
  return list;
}
function navigateToOpenedFileByPath(filePath, experimentalGoto, app) {
  if (experimentalGoto) {
    const openedFiles = getAllOpenedFilesExperimental(app);
    for (const openedFile of openedFiles) {
      if (openedFile.type == "leaf" && openedFile.state.state.file === filePath) {
        const leaf = app.workspace.getLeafById(openedFile.id);
        if (leaf && leaf.parent === app.workspace.getLeaf().parent) {
          app.workspace.setActiveLeaf(leaf, { focus: true });
          return true;
        }
      }
    }
  } else {
    const leaves = getAllWorkspaceLeaves(app);
    for (const leaf of leaves) {
      const view = leaf.view;
      if (view.file && view.file.path === filePath && leaf.parent === app.workspace.getLeaf().parent) {
        app.workspace.setActiveLeaf(leaf, { focus: true });
        return true;
      }
    }
  }
  return false;
}

// src/pluginOperations.ts
async function pluginSetNewOrOverwriteMark(plugin, mark) {
  const file = plugin.app.workspace.getActiveFile();
  if (!file) {
    new import_obsidian2.Notice("No active file to mark.");
    return;
  }
  const { marks, overwrittenMark } = setNewOrOverwriteMark(plugin.marks, mark, file.path);
  await plugin.saveMarks(marks);
  if (overwrittenMark) {
    await plugin.saveLastChangedMark(overwrittenMark);
  }
  new import_obsidian2.Notice(`Set mark '${mark.symbol}' to ${file.name}`);
}
function pluginGoToMark(plugin, mark) {
  const success = navigateToOpenedFileByPath(mark.filePath, plugin.settings.experimentalGoto, plugin.app);
  if (!success) {
    openNewFileByPath(mark.filePath, plugin.settings.openMarkInNewTab, plugin.app);
  }
}
async function pluginDeleteMark(plugin, mark) {
  const { marks, deletedMark } = deleteMark(plugin.marks, mark);
  await plugin.saveMarks(marks);
  if (deletedMark) {
    await plugin.saveLastChangedMark(deletedMark);
  }
  if (plugin.settings.harpoonRegisterGapRemoval) {
    pluginRemoveGapsForHarpoonMarks(plugin);
  }
  new import_obsidian2.Notice(`Deleted mark '${deletedMark == null ? void 0 : deletedMark.symbol}'`);
}
async function pluginRestoreLastChangedMark(plugin) {
  if (plugin.lastChangedMark) {
    const out = restoreLastChangedMark(plugin.marks, plugin.lastChangedMark);
    await plugin.saveMarks(out.marks);
    new import_obsidian2.Notice(`Restored mark '${plugin.lastChangedMark.symbol}' to ${plugin.lastChangedMark.filePath}`);
    if (out.markToDiscard) {
      plugin.saveLastChangedMark(out.markToDiscard);
    }
  } else {
    new import_obsidian2.Notice("No last changed mark to restore.");
  }
}
function pluginAddFileToHarpoon(plugin) {
  const harpoonRegisters = plugin.settings.harpoonRegisterList.split("");
  const reg = findFirstUnusedRegister(plugin.marks, harpoonRegisters);
  if (reg) {
    const file = plugin.app.workspace.getActiveFile();
    if (!file) {
      new import_obsidian2.Notice("No active file to mark.");
      return;
    }
    pluginSetNewOrOverwriteMark(plugin, { symbol: reg, filePath: file.path });
  } else {
    new import_obsidian2.Notice("Harpoon registers are full, cannot add more marks.");
  }
}
async function pluginRemoveGapsForHarpoonMarks(plugin) {
  const harpoonRegisters = plugin.settings.harpoonRegisterList.split("");
  const marks = removeGapsForHarpoonMarks(plugin.marks, harpoonRegisters);
  await plugin.saveMarks(marks);
}

// src/ui/MarkListModal.ts
var import_obsidian3 = require("obsidian");

// src/utils/defaultValues.ts
var modalDefaultKeybinds = {
  up: ["ctrl+k", "ctrl+p"],
  down: ["ctrl+j", "ctrl+n"],
  delete: ["ctrl+d"],
  select: ["Enter"],
  cancel: ["Escape"],
  undo: ["ctrl+u"]
};
var modalDefaultKeybindsMac = {
  up: ["cmd+k", "cmd+p"],
  down: ["cmd+j", "cmd+n"],
  delete: ["cmd+d"],
  select: ["Enter"],
  cancel: ["Escape"],
  undo: ["cmd+u"]
};
var modalMarkSymbolClass = "mark-symbol";
var modalMarkFilepathClass = "mark-file-path";
var modalMarkHarpoonSign = "harpoon-sign";
var JSONschemaVersion = 1;
var defaultObsidianMarksSettings = {
  ...defaultBasicMarksSettings,
  // hideMarkListDuringInput: false,
  openMarkInNewTab: false,
  // If true, open mark in new tab, else in current tab
  experimentalGoto: false,
  modalListUp: "",
  modalListDown: "",
  modalListSelect: "",
  modalListUndo: "",
  modalListDelete: "",
  modalListCancel: ""
};

// src/utils/keybinds.ts
function prepareKeybinds(isMacOS, settings) {
  let keybinds = !isMacOS ? { ...modalDefaultKeybinds } : { ...modalDefaultKeybindsMac };
  if (settings.modalListUp) {
    keybinds.up = [settings.modalListUp];
  }
  if (settings.modalListDown) {
    keybinds.down = [settings.modalListDown];
  }
  if (settings.modalListDelete) {
    keybinds.delete = [settings.modalListDelete];
  }
  if (settings.modalListSelect) {
    keybinds.select = [settings.modalListSelect];
  }
  if (settings.modalListUndo) {
    keybinds.undo = [settings.modalListUndo];
  }
  if (settings.modalListCancel) {
    keybinds.cancel = [settings.modalListCancel];
  }
  return keybinds;
}
function matchKeybind(evt, keybind) {
  const parts = keybind.split("+").map((p) => p.trim());
  let required = { ctrl: false, shift: false, alt: false, meta: false, key: "" };
  for (const part of parts) {
    if (part === "ctrl")
      required.ctrl = true;
    else if (part === "shift")
      required.shift = true;
    else if (part === "alt")
      required.alt = true;
    else if (part === "meta" || part === "cmd" || part === "win")
      required.meta = true;
    else
      required.key = part;
  }
  if (evt.ctrlKey !== required.ctrl)
    return false;
  if (evt.shiftKey !== required.shift)
    return false;
  if (evt.altKey !== required.alt)
    return false;
  if (evt.metaKey !== required.meta)
    return false;
  return evt.key === required.key;
}

// src/ui/MarkListModal.ts
var MarkListModal = class extends import_obsidian3.SuggestModal {
  constructor(app, plugin, mode, isHarpoonMode = false) {
    super(app);
    this.plugin = plugin;
    this.mode = mode;
    this.isHarpoonMode = isHarpoonMode;
  }
  getInstructions(modalKeybinds) {
    return [
      { command: modalKeybinds.up.join("/"), purpose: "Up" },
      { command: modalKeybinds.down.join("/"), purpose: "Down" },
      { command: "[Symbol]", purpose: modeDescription[this.mode] },
      { command: modalKeybinds.select.join("/"), purpose: modeDescription[this.mode] },
      { command: modalKeybinds.delete.join("/"), purpose: "Delete" },
      { command: modalKeybinds.cancel.join("/"), purpose: "Cancel" },
      { command: modalKeybinds.undo.join("/"), purpose: "Undo" }
    ];
  }
  getSuggestions(query) {
    return getSortedAndFilteredMarks(this.plugin.marks, this.isHarpoonMode, this.plugin.settings);
  }
  renderSuggestion(mark, el) {
    var _a;
    const symbolEl = el.createEl("span", { text: mark.symbol, cls: modalMarkSymbolClass });
    el.createEl("span", { text: mark.filePath, cls: modalMarkFilepathClass });
    if (this.plugin.settings.harpoonRegisterList.contains(mark.symbol)) {
      el.createEl("span", { text: "H", cls: modalMarkHarpoonSign });
    }
    if (((_a = this.app.workspace.getActiveFile()) == null ? void 0 : _a.path) === mark.filePath) {
      symbolEl.addClass("highlight");
    }
    el.addEventListener("click", async (evt) => {
      await this.onChooseSuggestion(mark, evt);
      this.close();
    });
  }
  onOpen() {
    super.onOpen();
    if (this.inputEl) {
      this.inputEl.style.display = "none";
    }
    this.modalEl.addClass("marks-modal");
    const modalKeybinds = prepareKeybinds(import_obsidian3.Platform.isMacOS, this.plugin.settings);
    this.setInstructions(this.getInstructions(modalKeybinds));
    this._keyHandler = this.getModalKeyHandler(modalKeybinds);
    window.addEventListener("keydown", this._keyHandler, true);
  }
  onClose() {
    if (this._keyHandler) {
      window.removeEventListener("keydown", this._keyHandler, true);
      this._keyHandler = void 0;
    }
    super.onClose();
  }
  getModalKeyHandler(keybinds) {
    return async (evt) => {
      const availableRegisters = new Set((!this.isHarpoonMode ? this.plugin.settings.registerList : this.plugin.settings.harpoonRegisterList).split(""));
      const chooser = this.chooser;
      if (keybinds.up.some((kb) => matchKeybind(evt, kb))) {
        evt.preventDefault();
        this.moveSelection(-1);
      } else if (keybinds.down.some((kb) => matchKeybind(evt, kb))) {
        evt.preventDefault();
        this.moveSelection(1);
      } else if (keybinds.delete.some((kb) => matchKeybind(evt, kb))) {
        evt.preventDefault();
        if (chooser.values) {
          const prevIdx = chooser.selectedItem;
          const selected = chooser.values[prevIdx];
          if (selected) {
            await pluginDeleteMark(this.plugin, selected);
            chooser.values = getSortedAndFilteredMarks(this.plugin.marks, this.isHarpoonMode, this.plugin.settings);
            chooser.setSuggestions(chooser.values);
            chooser.setSelectedItem(Math.max(0, Math.min(prevIdx, chooser.values.length)), false);
          }
        }
      } else if (keybinds.undo.some((kb) => matchKeybind(evt, kb))) {
        evt.preventDefault();
        await pluginRestoreLastChangedMark(this.plugin);
        chooser.values = getSortedAndFilteredMarks(this.plugin.marks, this.isHarpoonMode, this.plugin.settings);
        const prevIdx = chooser.selectedItem;
        chooser.setSuggestions(chooser.values);
        chooser.setSelectedItem(Math.max(0, prevIdx), false);
      } else if (keybinds.select.some((kb) => matchKeybind(evt, kb))) {
        evt.preventDefault();
        const ind = chooser.selectedItem;
        const selected = chooser.values[ind];
        if (selected) {
          this.onChooseSuggestion(selected, evt);
          this.close();
        }
      } else if (keybinds.cancel.some((kb) => matchKeybind(evt, kb))) {
        evt.preventDefault();
        this.close();
      } else if (availableRegisters.has(evt.key)) {
        let mark = getMarkBySymbol(this.plugin.marks, evt.key);
        if (this.mode === "set") {
          if (mark == null) {
            mark = { symbol: evt.key, filePath: "" };
          }
          evt.preventDefault();
          await this.onChooseSuggestion(mark, evt);
          this.close();
        } else if (this.mode === "goto" && mark) {
          evt.preventDefault();
          await this.onChooseSuggestion(mark, evt);
          this.close();
        } else if (this.mode === "delete" && mark) {
          evt.preventDefault();
          await this.onChooseSuggestion(mark, evt);
          this.close();
        }
      }
    };
  }
  async onChooseSuggestion(mark, evt) {
    if (this.mode === "set") {
      pluginSetNewOrOverwriteMark(this.plugin, mark);
    } else if (this.mode === "goto") {
      pluginGoToMark(this.plugin, mark);
    } else if (this.mode === "delete") {
      pluginDeleteMark(this.plugin, mark);
    }
  }
  moveSelection(delta) {
    const chooser = this.chooser;
    if (!chooser)
      return;
    let idx = chooser.selectedItem;
    if (typeof idx !== "number")
      idx = 0;
    if (!chooser.values)
      return;
    const max = chooser.values.length;
    let next = idx + delta;
    if (next < 0)
      next = max - 1;
    if (next >= max)
      next = 0;
    chooser.setSelectedItem(next, 0);
  }
};

// src/commands.ts
async function setGlobalMark(plugin) {
  new MarkListModal(plugin.app, plugin, "set").open();
}
async function goToGlobalMark(plugin) {
  new MarkListModal(plugin.app, plugin, "goto").open();
}
async function deleteGlobalMark(plugin) {
  new MarkListModal(plugin.app, plugin, "delete").open();
}
async function addFileToHarpoon(plugin) {
  pluginAddFileToHarpoon(plugin);
}
async function goToHarpoonMark(plugin) {
  new MarkListModal(plugin.app, plugin, "goto", true).open();
}

// src/ui/SettingsTab.ts
var import_obsidian4 = require("obsidian");
var SettingsTab = class extends import_obsidian4.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    const ds = defaultObsidianMarksSettings;
    new import_obsidian4.Setting(containerEl).setName("Open mark in new tab").setDesc('Open a file in the new tab when using "go to" command. If disabled, it will open the file in the current tab.').addToggle(
      (toggle) => {
        var _a;
        return toggle.setValue((_a = this.plugin.settings.openMarkInNewTab) != null ? _a : ds.openMarkInNewTab).onChange(async (value) => {
          this.plugin.settings.openMarkInNewTab = value;
          await this.plugin.saveSettings();
        });
      }
    );
    new import_obsidian4.Setting(containerEl).setName("No duplication of opened files when using Go to commands (experimental)").setDesc("Prevents duplicate tabs when switching to already opened files using the mark list after restarting Obsidian. (Experimental: may not work in future Obsidian versions.)").addToggle(
      (toggle) => {
        var _a;
        return toggle.setValue((_a = this.plugin.settings.experimentalGoto) != null ? _a : ds.experimentalGoto).onChange(async (value) => {
          this.plugin.settings.experimentalGoto = value;
          await this.plugin.saveSettings();
        });
      }
    );
    new import_obsidian4.Setting(containerEl).setName("General registers").setHeading();
    this.createRegisterListSetting(containerEl, "Register list", ds.registerList, "Key symbols to be used as registers. Only include symbols that you can input with a single keystroke.", "registerList").addExtraButton((btn) => {
      btn.setIcon("refresh-ccw").setTooltip("Reset to default register list").onClick(
        async () => {
          this.plugin.settings.registerList = ds.registerList;
          await this.plugin.saveSettings();
          this.display();
        }
      );
    });
    new import_obsidian4.Setting(containerEl).setName("Sort all marks by register list").setDesc("Sort marks by the order of the key symbols in the register list. If disabled, marks will be sorted alphabetically according to the current locale.").addToggle(
      (toggle) => {
        var _a;
        return toggle.setValue((_a = this.plugin.settings.registerSortByList) != null ? _a : ds.registerSortByList).onChange(async (value) => {
          this.plugin.settings.registerSortByList = value;
          await this.plugin.saveSettings();
        });
      }
    );
    new import_obsidian4.Setting(containerEl).setName("Harpoon registers").setHeading();
    this.createRegisterListSetting(containerEl, "Harpoon register list", ds.harpoonRegisterList, "Key symbols to be used as Harpoon registers. Only include symbols that you can input with a single keystroke.", "harpoonRegisterList").addExtraButton((btn) => {
      btn.setIcon("refresh-ccw").setTooltip("Reset to default Harpoon register list").onClick(
        async () => {
          this.plugin.settings.harpoonRegisterList = ds.harpoonRegisterList;
          await this.plugin.saveSettings();
          this.display();
        }
      );
    });
    new import_obsidian4.Setting(containerEl).setName("Sort Harpoon marks by Harpoon register list").setDesc("Sort Harpoon marks by the order of the key symbols in the Harpoon register list. If disabled, marks will be sorted alphabetically according to the current locale.").addToggle(
      (toggle) => {
        var _a;
        return toggle.setValue((_a = this.plugin.settings.harpoonRegisterSortByList) != null ? _a : ds.harpoonRegisterSortByList).onChange(async (value) => {
          this.plugin.settings.harpoonRegisterSortByList = value;
          await this.plugin.saveSettings();
        });
      }
    );
    new import_obsidian4.Setting(containerEl).setName("Remove gaps inbetween Harpoon marks").setDesc("Harpoon marks will be shifted to the left for every gap (register with no mark) based on the order of the Harpoon register list.").addToggle(
      (toggle) => {
        var _a;
        return toggle.setValue((_a = this.plugin.settings.harpoonRegisterGapRemoval) != null ? _a : ds.harpoonRegisterGapRemoval).onChange(async (value) => {
          this.plugin.settings.harpoonRegisterGapRemoval = value;
          await this.plugin.saveSettings();
        });
      }
    );
    containerEl.createEl("h4", { text: "List navigation shortcuts" });
    this.createShortcutSetting(containerEl, "Up", ds.modalListUp, "Shortcut for moving up in the list", "modalListUp");
    this.createShortcutSetting(containerEl, "Down", ds.modalListDown, "Shortcut for moving down in the list", "modalListDown");
    this.createShortcutSetting(containerEl, "Select mark", ds.modalListSelect, "Shortcut for selecting a mark", "modalListSelect");
    this.createShortcutSetting(containerEl, "Cancel modal", ds.modalListCancel, "Shortcut for cancelling the modal", "modalListCancel");
    this.createShortcutSetting(containerEl, "Delete mark", ds.modalListDelete, "Shortcut for deleting a mark", "modalListDelete");
    this.createShortcutSetting(containerEl, "Restore last changed mark", ds.modalListUndo, "Shortcut for undoing last action of changing a mark", "modalListUndo");
  }
  // use only for string values from Settings type
  createShortcutSetting(containerEl, name, defaultValue, desc, key) {
    new import_obsidian4.Setting(containerEl).setName(name).setDesc(desc).addText((text) => {
      var _a;
      return text.setValue(String((_a = this.plugin.settings[key]) != null ? _a : defaultValue)).onChange(async (value) => {
        this.plugin.settings[key] = value;
        await this.plugin.saveSettings();
      });
    });
  }
  createRegisterListSetting(containerEl, name, defaultValue, desc, key) {
    return new import_obsidian4.Setting(containerEl).setName(name).setDesc(desc).addText((text) => {
      var _a;
      return text.setValue(String((_a = this.plugin.settings[key]) != null ? _a : defaultValue)).onChange(async (value) => {
        this.plugin.settings[key] = value;
        await this.plugin.saveSettings();
      });
    });
  }
};

// src/utils/storage.ts
var import_obsidian5 = require("obsidian");
async function loadSettings(plugin) {
  var _a;
  return ((_a = await plugin.loadData()) == null ? void 0 : _a.settings) || defaultObsidianMarksSettings;
}
async function saveSettings(plugin, settings) {
  const data = await plugin.loadData() || {};
  data.settings = settings;
  await plugin.saveData(data);
}
async function loadMarks(plugin) {
  var _a;
  return ((_a = await plugin.loadData()) == null ? void 0 : _a.marks) || [];
}
async function saveMarks(plugin, marks) {
  const data = await plugin.loadData() || {};
  data.marks = marks;
  await plugin.saveData(data);
}
async function loadLastChangedMark(plugin) {
  var _a;
  return ((_a = await plugin.loadData()) == null ? void 0 : _a.lastChangedMark) || {};
}
async function saveLastChangedMark(plugin, lastChangedMark) {
  const data = await plugin.loadData() || {};
  data.lastChangedMark = lastChangedMark;
  await plugin.saveData(data);
}
async function JSONschemaCheck(plugin) {
  const data = await plugin.loadData() || { schemaVersion: JSONschemaVersion };
  if (data.schemaVersion && data.schemaVersion === JSONschemaVersion) {
    return;
  }
  new import_obsidian5.Notice(plugin.manifest.name + ": Faulty data. Check developer tools for more info.");
  console.error(plugin.manifest.id + ": The data loaded is not in correct format. The plugin may not work properly. This usually happens after plugin update that changes the JSON schema. ");
}

// src/main.ts
var TetherMarksPlugin = class extends import_obsidian6.Plugin {
  constructor() {
    super(...arguments);
    this.marks = [];
    this.lastChangedMark = null;
  }
  async onload() {
    await JSONschemaCheck(this);
    this.settings = await loadSettings(this);
    this.marks = await loadMarks(this);
    this.lastChangedMark = await loadLastChangedMark(this);
    this.addCommand({
      id: "set-mark",
      name: "Set mark",
      callback: () => setGlobalMark(this)
    });
    this.addCommand({
      id: "go-to-mark",
      name: "Go to mark",
      callback: () => goToGlobalMark(this)
    });
    this.addCommand({
      id: "delete-mark",
      name: "Delete mark",
      callback: () => deleteGlobalMark(this)
    });
    this.addCommand({
      id: "add-file-to-harpoon",
      name: "Add file to Harpoon",
      callback: () => addFileToHarpoon(this)
    });
    this.addCommand({
      id: "go-to-harpoon-mark",
      name: "Go to Harpoon mark",
      callback: () => goToHarpoonMark(this)
    });
    this.addSettingTab(new SettingsTab(this.app, this));
    console.log("loading " + this.manifest.id);
  }
  async saveSettings() {
    await saveSettings(this, this.settings);
  }
  async saveMarks(marks) {
    this.marks = marks;
    await saveMarks(this, marks);
  }
  async saveLastChangedMark(lastChangedMark) {
    this.lastChangedMark = lastChangedMark;
    await saveLastChangedMark(this, lastChangedMark);
  }
  onunload() {
    console.log("unloading " + this.manifest.id);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3BsdWdpbk9wZXJhdGlvbnMudHMiLCAiLi4vLi4vLi4vLi4vLi4vLi4vLi4vUHJvamVjdHMvdGV0aGVyLW1hcmtzLWNvcmUvZGlzdC9tYXJrcy5qcyIsICIuLi8uLi8uLi8uLi8uLi8uLi8uLi9Qcm9qZWN0cy90ZXRoZXItbWFya3MtY29yZS9kaXN0L2RlZmF1bHRWYWx1ZXMuanMiLCAic3JjL3V0aWxzL29ic2lkaWFuVXRpbHMudHMiLCAic3JjL3VpL01hcmtMaXN0TW9kYWwudHMiLCAic3JjL3V0aWxzL2RlZmF1bHRWYWx1ZXMudHMiLCAic3JjL3V0aWxzL2tleWJpbmRzLnRzIiwgInNyYy9jb21tYW5kcy50cyIsICJzcmMvdWkvU2V0dGluZ3NUYWIudHMiLCAic3JjL3V0aWxzL3N0b3JhZ2UudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IFBsdWdpbiB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IHNldEdsb2JhbE1hcmssIGdvVG9HbG9iYWxNYXJrLCBnb1RvSGFycG9vbk1hcmssIGFkZEZpbGVUb0hhcnBvb24sIGRlbGV0ZUdsb2JhbE1hcmsgfSBmcm9tICcuL2NvbW1hbmRzJztcbmltcG9ydCB7IFNldHRpbmdzVGFiIH0gZnJvbSAnLi91aS9TZXR0aW5nc1RhYic7XG5pbXBvcnQgeyBsb2FkU2V0dGluZ3MsIHNhdmVTZXR0aW5ncywgbG9hZE1hcmtzLCBzYXZlTWFya3MsIGxvYWRMYXN0Q2hhbmdlZE1hcmssIHNhdmVMYXN0Q2hhbmdlZE1hcmssIEpTT05zY2hlbWFDaGVjayB9IGZyb20gJy4vdXRpbHMvc3RvcmFnZSc7XG5pbXBvcnQgeyBNYXJrIH0gZnJvbSAndGV0aGVyLW1hcmtzLWNvcmUnO1xuaW1wb3J0IHsgT2JzaWRpYW5NYXJrc1NldHRpbmdzIH0gZnJvbSAnLi90eXBlcyc7XG5cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGV0aGVyTWFya3NQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuICAgIHNldHRpbmdzITogT2JzaWRpYW5NYXJrc1NldHRpbmdzO1xuICAgIG1hcmtzOiBNYXJrW10gPSBbXTtcbiAgICBsYXN0Q2hhbmdlZE1hcms6IE1hcmsgfCBudWxsID0gbnVsbDtcblxuICAgIGFzeW5jIG9ubG9hZCgpIHtcbiAgICAgICAgYXdhaXQgSlNPTnNjaGVtYUNoZWNrKHRoaXMpO1xuXG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBhd2FpdCBsb2FkU2V0dGluZ3ModGhpcyk7XG4gICAgICAgIHRoaXMubWFya3MgPSBhd2FpdCBsb2FkTWFya3ModGhpcyk7XG4gICAgICAgIHRoaXMubGFzdENoYW5nZWRNYXJrID0gYXdhaXQgbG9hZExhc3RDaGFuZ2VkTWFyayh0aGlzKTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdzZXQtbWFyaycsXG4gICAgICAgICAgICBuYW1lOiAnU2V0IG1hcmsnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHNldEdsb2JhbE1hcmsodGhpcyksXG4gICAgICAgIH0pO1xuXG5cblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdnby10by1tYXJrJyxcbiAgICAgICAgICAgIG5hbWU6ICdHbyB0byBtYXJrJyxcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiBnb1RvR2xvYmFsTWFyayh0aGlzKSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnZGVsZXRlLW1hcmsnLFxuICAgICAgICAgICAgbmFtZTogJ0RlbGV0ZSBtYXJrJyxcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiBkZWxldGVHbG9iYWxNYXJrKHRoaXMpLFxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdhZGQtZmlsZS10by1oYXJwb29uJyxcbiAgICAgICAgICAgIG5hbWU6ICdBZGQgZmlsZSB0byBIYXJwb29uJyxcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiBhZGRGaWxlVG9IYXJwb29uKHRoaXMpLFxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdnby10by1oYXJwb29uLW1hcmsnLFxuICAgICAgICAgICAgbmFtZTogJ0dvIHRvIEhhcnBvb24gbWFyaycsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4gZ29Ub0hhcnBvb25NYXJrKHRoaXMpLFxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IFNldHRpbmdzVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG5cbiAgICAgICAgY29uc29sZS5sb2coJ2xvYWRpbmcgJyArIHRoaXMubWFuaWZlc3QuaWQpO1xuICAgIH1cblxuICAgIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcbiAgICAgICAgYXdhaXQgc2F2ZVNldHRpbmdzKHRoaXMsIHRoaXMuc2V0dGluZ3MpO1xuICAgIH1cblxuICAgIGFzeW5jIHNhdmVNYXJrcyhtYXJrczogTWFya1tdKSB7XG4gICAgICAgIHRoaXMubWFya3MgPSBtYXJrcztcbiAgICAgICAgYXdhaXQgc2F2ZU1hcmtzKHRoaXMsIG1hcmtzKTtcbiAgICB9XG5cbiAgICBhc3luYyBzYXZlTGFzdENoYW5nZWRNYXJrKGxhc3RDaGFuZ2VkTWFyazogTWFyaykge1xuICAgICAgICB0aGlzLmxhc3RDaGFuZ2VkTWFyayA9IGxhc3RDaGFuZ2VkTWFyaztcbiAgICAgICAgYXdhaXQgc2F2ZUxhc3RDaGFuZ2VkTWFyayh0aGlzLCBsYXN0Q2hhbmdlZE1hcmspO1xuICAgIH1cblxuICAgIG9udW5sb2FkKCkge1xuICAgICAgICBjb25zb2xlLmxvZygndW5sb2FkaW5nICcgKyB0aGlzLm1hbmlmZXN0LmlkKTtcbiAgICB9XG59IiwgImltcG9ydCB7IE5vdGljZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgVGV0aGVyTWFya3NQbHVnaW4gZnJvbSBcIi4vbWFpblwiO1xyXG5pbXBvcnQgeyBkZWxldGVNYXJrLCBmaW5kRmlyc3RVbnVzZWRSZWdpc3RlciwgTWFyaywgcmVtb3ZlR2Fwc0ZvckhhcnBvb25NYXJrcywgcmVzdG9yZUxhc3RDaGFuZ2VkTWFyaywgc2V0TmV3T3JPdmVyd3JpdGVNYXJrIH0gZnJvbSBcInRldGhlci1tYXJrcy1jb3JlXCI7XHJcbmltcG9ydCB7IG5hdmlnYXRlVG9PcGVuZWRGaWxlQnlQYXRoLCBvcGVuTmV3RmlsZUJ5UGF0aCB9IGZyb20gXCIuL3V0aWxzL29ic2lkaWFuVXRpbHNcIjtcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwbHVnaW5TZXROZXdPck92ZXJ3cml0ZU1hcmsocGx1Z2luOiBUZXRoZXJNYXJrc1BsdWdpbiwgbWFyazogTWFyaykge1xyXG4gICAgY29uc3QgZmlsZSA9IHBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcclxuICAgIGlmICghZmlsZSkge1xyXG4gICAgICAgIG5ldyBOb3RpY2UoJ05vIGFjdGl2ZSBmaWxlIHRvIG1hcmsuJyk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgeyBtYXJrcywgb3ZlcndyaXR0ZW5NYXJrIH0gPSBzZXROZXdPck92ZXJ3cml0ZU1hcmsocGx1Z2luLm1hcmtzLCBtYXJrLCBmaWxlLnBhdGgpO1xyXG4gICAgYXdhaXQgcGx1Z2luLnNhdmVNYXJrcyhtYXJrcyk7XHJcbiAgICBpZiAob3ZlcndyaXR0ZW5NYXJrKSB7XHJcbiAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVMYXN0Q2hhbmdlZE1hcmsob3ZlcndyaXR0ZW5NYXJrKTtcclxuICAgIH1cclxuICAgIG5ldyBOb3RpY2UoYFNldCBtYXJrICcke21hcmsuc3ltYm9sfScgdG8gJHtmaWxlLm5hbWV9YCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBwbHVnaW5Hb1RvTWFyayhwbHVnaW46IFRldGhlck1hcmtzUGx1Z2luLCBtYXJrOiBNYXJrKSB7XHJcbiAgICBjb25zdCBzdWNjZXNzID0gbmF2aWdhdGVUb09wZW5lZEZpbGVCeVBhdGgobWFyay5maWxlUGF0aCwgcGx1Z2luLnNldHRpbmdzLmV4cGVyaW1lbnRhbEdvdG8sIHBsdWdpbi5hcHApO1xyXG4gICAgLy8gSWYgZmlsZSBub3Qgb3BlbiwgdGhlbiBvcGVuIGl0IGluIHRoZSBwcmVmZXJyZWQgdGFiXHJcbiAgICBpZiAoIXN1Y2Nlc3MpIHtcclxuICAgICAgICBvcGVuTmV3RmlsZUJ5UGF0aChtYXJrLmZpbGVQYXRoLCBwbHVnaW4uc2V0dGluZ3Mub3Blbk1hcmtJbk5ld1RhYiwgcGx1Z2luLmFwcCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwbHVnaW5EZWxldGVNYXJrKHBsdWdpbjogVGV0aGVyTWFya3NQbHVnaW4sIG1hcms6IE1hcmspIHtcclxuICAgIGNvbnN0IHsgbWFya3MsIGRlbGV0ZWRNYXJrIH0gPSBkZWxldGVNYXJrKHBsdWdpbi5tYXJrcywgbWFyayk7XHJcbiAgICBhd2FpdCBwbHVnaW4uc2F2ZU1hcmtzKG1hcmtzKTtcclxuXHJcbiAgICBpZiAoZGVsZXRlZE1hcmspIHtcclxuICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZUxhc3RDaGFuZ2VkTWFyayhkZWxldGVkTWFyayk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHBsdWdpbi5zZXR0aW5ncy5oYXJwb29uUmVnaXN0ZXJHYXBSZW1vdmFsKSB7XHJcbiAgICAgICAgcGx1Z2luUmVtb3ZlR2Fwc0ZvckhhcnBvb25NYXJrcyhwbHVnaW4pO1xyXG4gICAgfVxyXG5cclxuICAgIG5ldyBOb3RpY2UoYERlbGV0ZWQgbWFyayAnJHtkZWxldGVkTWFyaz8uc3ltYm9sfSdgKTtcclxufTtcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwbHVnaW5SZXN0b3JlTGFzdENoYW5nZWRNYXJrKHBsdWdpbjogVGV0aGVyTWFya3NQbHVnaW4pIHtcclxuICAgIC8vIFVuZG8gdGhlIGxhc3QgY2hhbmdlZCBtYXJrXHJcbiAgICBpZiAocGx1Z2luLmxhc3RDaGFuZ2VkTWFyaykge1xyXG4gICAgICAgIGNvbnN0IG91dCA9IHJlc3RvcmVMYXN0Q2hhbmdlZE1hcmsocGx1Z2luLm1hcmtzLCBwbHVnaW4ubGFzdENoYW5nZWRNYXJrKVxyXG4gICAgICAgIGF3YWl0IHBsdWdpbi5zYXZlTWFya3Mob3V0Lm1hcmtzKTtcclxuICAgICAgICBuZXcgTm90aWNlKGBSZXN0b3JlZCBtYXJrICcke3BsdWdpbi5sYXN0Q2hhbmdlZE1hcmsuc3ltYm9sfScgdG8gJHtwbHVnaW4ubGFzdENoYW5nZWRNYXJrLmZpbGVQYXRofWApO1xyXG4gICAgICAgIGlmIChvdXQubWFya1RvRGlzY2FyZCkge1xyXG4gICAgICAgICAgICBwbHVnaW4uc2F2ZUxhc3RDaGFuZ2VkTWFyayhvdXQubWFya1RvRGlzY2FyZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBuZXcgTm90aWNlKCdObyBsYXN0IGNoYW5nZWQgbWFyayB0byByZXN0b3JlLicpO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcGx1Z2luQWRkRmlsZVRvSGFycG9vbihwbHVnaW46IFRldGhlck1hcmtzUGx1Z2luKSB7XHJcbiAgICAvLyBBZGQgdGhlIHNlbGVjdGVkIG1hcmsgdG8gdGhlIEhhcnBvb24gbGlzdFxyXG4gICAgY29uc3QgaGFycG9vblJlZ2lzdGVycyA9IHBsdWdpbi5zZXR0aW5ncy5oYXJwb29uUmVnaXN0ZXJMaXN0LnNwbGl0KCcnKTtcclxuICAgIGNvbnN0IHJlZyA9IGZpbmRGaXJzdFVudXNlZFJlZ2lzdGVyKHBsdWdpbi5tYXJrcywgaGFycG9vblJlZ2lzdGVycyk7XHJcblxyXG4gICAgaWYgKHJlZykge1xyXG4gICAgICAgIGNvbnN0IGZpbGUgPSBwbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XHJcbiAgICAgICAgaWYgKCFmaWxlKSB7XHJcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ05vIGFjdGl2ZSBmaWxlIHRvIG1hcmsuJyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgcGx1Z2luU2V0TmV3T3JPdmVyd3JpdGVNYXJrKHBsdWdpbiwgeyBzeW1ib2w6IHJlZywgZmlsZVBhdGg6IGZpbGUucGF0aCB9KTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIElmIGFsbCByZWdpc3RlcnMgYXJlIHVzZWQsIHNob3cgYSBub3RpY2VcclxuICAgICAgICBuZXcgTm90aWNlKCdIYXJwb29uIHJlZ2lzdGVycyBhcmUgZnVsbCwgY2Fubm90IGFkZCBtb3JlIG1hcmtzLicpO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcGx1Z2luUmVtb3ZlR2Fwc0ZvckhhcnBvb25NYXJrcyhwbHVnaW46IFRldGhlck1hcmtzUGx1Z2luKSB7XHJcbiAgICBjb25zdCBoYXJwb29uUmVnaXN0ZXJzID0gcGx1Z2luLnNldHRpbmdzLmhhcnBvb25SZWdpc3Rlckxpc3Quc3BsaXQoJycpO1xyXG4gICAgY29uc3QgbWFya3MgPSByZW1vdmVHYXBzRm9ySGFycG9vbk1hcmtzKHBsdWdpbi5tYXJrcywgaGFycG9vblJlZ2lzdGVycyk7XHJcbiAgICBhd2FpdCBwbHVnaW4uc2F2ZU1hcmtzKG1hcmtzKTtcclxufVxyXG4iLCAiZXhwb3J0IGZ1bmN0aW9uIGZpbmRGaXJzdFVudXNlZFJlZ2lzdGVyKG1hcmtzLCByZWdpc3RlcnMpIHtcbiAgICBmb3IgKGNvbnN0IHJlZyBvZiByZWdpc3RlcnMpIHtcbiAgICAgICAgLy8gaWYgcmVnaXN0ZXIgbm90IHVzZWQgYWxyZWFkeSwgdGhlbiB1c2UgaXRcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ0NoZWNraW5nIHJlZ2lzdGVyOicsIHJlZyk7XG4gICAgICAgIGlmICghKG1hcmtzLm1hcChtID0+IG0uc3ltYm9sKS5pbmNsdWRlcyhyZWcpKSkge1xuICAgICAgICAgICAgcmV0dXJuIHJlZztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRNYXJrQnlTeW1ib2wobWFya3MsIHN5bWJvbCkge1xuICAgIHJldHVybiBtYXJrcy5maW5kKG0gPT4gbS5zeW1ib2wgPT09IHN5bWJvbCk7XG59XG5leHBvcnQgZnVuY3Rpb24gc29ydE1hcmtzQWxwaGFiZXRpY2FsbHkobWFya3MpIHtcbiAgICBtYXJrcy5zb3J0KChhLCBiKSA9PiBhLnN5bWJvbC5sb2NhbGVDb21wYXJlKGIuc3ltYm9sKSk7XG59XG5leHBvcnQgZnVuY3Rpb24gZ2V0U29ydGVkQW5kRmlsdGVyZWRNYXJrcyhtYXJrcywgaXNIYXJwb29uTW9kZSwgc2V0dGluZ3MpIHtcbiAgICBjb25zdCBhdmFpbGFibGVSZWdpc3RlcnMgPSBuZXcgU2V0KCghaXNIYXJwb29uTW9kZSA/IHNldHRpbmdzLnJlZ2lzdGVyTGlzdCA6IHNldHRpbmdzLmhhcnBvb25SZWdpc3Rlckxpc3QpLnNwbGl0KCcnKSk7XG4gICAgY29uc3QgZmlsdGVyZWRNYXJrcyA9IG1hcmtzLmZpbHRlcihlbCA9PiBhdmFpbGFibGVSZWdpc3RlcnMuaGFzKGVsLnN5bWJvbCkpO1xuICAgIGlmICghaXNIYXJwb29uTW9kZSAmJiBzZXR0aW5ncy5yZWdpc3RlclNvcnRCeUxpc3QpIHtcbiAgICAgICAgLy8gU29ydCBtYXJrcyBieSB0aGUgb3JkZXIgb2YgdGhlIGtleSBzeW1ib2xzIGluIHRoZSByZWdpc3RlciBsaXN0XG4gICAgICAgIGNvbnN0IHJlZ2lzdGVyTGlzdCA9IHNldHRpbmdzLnJlZ2lzdGVyTGlzdDtcbiAgICAgICAgc29ydE1hcmtzQnlTZXR0aW5nc1JlZ2lzdGVyT3JkZXIoZmlsdGVyZWRNYXJrcywgcmVnaXN0ZXJMaXN0KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoaXNIYXJwb29uTW9kZSAmJiBzZXR0aW5ncy5oYXJwb29uUmVnaXN0ZXJTb3J0QnlMaXN0KSB7XG4gICAgICAgIC8vIFNvcnQgbWFya3MgYnkgdGhlIG9yZGVyIG9mIHRoZSBrZXkgc3ltYm9scyBpbiB0aGUgaGFycG9vbiByZWdpc3RlciBsaXN0XG4gICAgICAgIGNvbnN0IHJlZ2lzdGVyTGlzdCA9IHNldHRpbmdzLmhhcnBvb25SZWdpc3Rlckxpc3Q7XG4gICAgICAgIHNvcnRNYXJrc0J5U2V0dGluZ3NSZWdpc3Rlck9yZGVyKGZpbHRlcmVkTWFya3MsIHJlZ2lzdGVyTGlzdCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBzb3J0TWFya3NBbHBoYWJldGljYWxseShmaWx0ZXJlZE1hcmtzKTtcbiAgICB9XG4gICAgcmV0dXJuIGZpbHRlcmVkTWFya3M7XG59XG5leHBvcnQgZnVuY3Rpb24gc29ydE1hcmtzQnlTZXR0aW5nc1JlZ2lzdGVyT3JkZXIobWFya3MsIHJlZ2lzdGVycykge1xuICAgIGNvbnN0IHJlZ2lzdGVyT3JkZXIgPSBuZXcgTWFwKFsuLi5yZWdpc3RlcnNdLm1hcCgoc3ltYm9sLCBpbmRleCkgPT4gW3N5bWJvbCwgaW5kZXhdKSk7XG4gICAgbWFya3Muc29ydCgoYSwgYikgPT4geyB2YXIgX2EsIF9iOyByZXR1cm4gKChfYSA9IHJlZ2lzdGVyT3JkZXIuZ2V0KGEuc3ltYm9sKSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogSW5maW5pdHkpIC0gKChfYiA9IHJlZ2lzdGVyT3JkZXIuZ2V0KGIuc3ltYm9sKSkgIT09IG51bGwgJiYgX2IgIT09IHZvaWQgMCA/IF9iIDogSW5maW5pdHkpOyB9KTtcbn1cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVHYXBzRm9ySGFycG9vbk1hcmtzKG1hcmtzVG9Db3B5LCBoYXJwb29uUmVnaXN0ZXJzKSB7XG4gICAgbGV0IG1hcmtzID0gWy4uLm1hcmtzVG9Db3B5XTtcbiAgICBsZXQgbGVmdEN1ciA9IDA7XG4gICAgbGV0IHJpZ2h0Q3VyID0gMDtcbiAgICB3aGlsZSAocmlnaHRDdXIgPCBoYXJwb29uUmVnaXN0ZXJzLmxlbmd0aCkge1xuICAgICAgICBjb25zdCBtYXJrRWwgPSBtYXJrcy5maW5kKGVsID0+IGVsLnN5bWJvbCA9PT0gaGFycG9vblJlZ2lzdGVyc1tyaWdodEN1cl0pO1xuICAgICAgICBpZiAobWFya0VsICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHN5bWJvbFRvU2V0VG8gPSBoYXJwb29uUmVnaXN0ZXJzW2xlZnRDdXJdO1xuICAgICAgICAgICAgbGV0IGZpbHRlcmVkTWFya3MgPSBtYXJrcy5maWx0ZXIoZWwgPT4gZWwuc3ltYm9sICE9PSBoYXJwb29uUmVnaXN0ZXJzW2xlZnRDdXJdKTtcbiAgICAgICAgICAgIGZpbHRlcmVkTWFya3MucHVzaCh7IHN5bWJvbDogc3ltYm9sVG9TZXRUbywgZmlsZVBhdGg6IG1hcmtFbC5maWxlUGF0aCB9KTtcbiAgICAgICAgICAgIG1hcmtzID0gZmlsdGVyZWRNYXJrcztcbiAgICAgICAgICAgIGxlZnRDdXIgKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByaWdodEN1ciArPSAxO1xuICAgIH1cbiAgICB3aGlsZSAobGVmdEN1ciA8IGhhcnBvb25SZWdpc3RlcnMubGVuZ3RoKSB7XG4gICAgICAgIG1hcmtzID0gbWFya3MuZmlsdGVyKGVsID0+IGVsLnN5bWJvbCAhPT0gaGFycG9vblJlZ2lzdGVyc1tsZWZ0Q3VyXSk7XG4gICAgICAgIGxlZnRDdXIgKz0gMTtcbiAgICB9XG4gICAgcmV0dXJuIG1hcmtzO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHJlc3RvcmVMYXN0Q2hhbmdlZE1hcmsobWFya3MsIGxhc3RDaGFuZ2VkTWFyaykge1xuICAgIGNvbnN0IG1hcmtUb1Jlc3RvcmUgPSB7IC4uLmxhc3RDaGFuZ2VkTWFyayB9O1xuICAgIGNvbnN0IG1hcmtUb0Rpc2NhcmQgPSBtYXJrcy5maW5kKG0gPT4gbS5zeW1ib2wgPT09IG1hcmtUb1Jlc3RvcmUuc3ltYm9sKTtcbiAgICBjb25zdCBtYXJrc1dpdGhvdXREaXNjYXJkZWQgPSBtYXJrcy5maWx0ZXIobSA9PiBtLnN5bWJvbCAhPT0gbWFya1RvUmVzdG9yZS5zeW1ib2wpO1xuICAgIG1hcmtzV2l0aG91dERpc2NhcmRlZC5wdXNoKHsgc3ltYm9sOiBtYXJrVG9SZXN0b3JlLnN5bWJvbCwgZmlsZVBhdGg6IG1hcmtUb1Jlc3RvcmUuZmlsZVBhdGggfSk7XG4gICAgcmV0dXJuIHsgbWFya3M6IG1hcmtzV2l0aG91dERpc2NhcmRlZCwgbWFya1RvRGlzY2FyZDogbWFya1RvRGlzY2FyZCB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIHNldE5ld09yT3ZlcndyaXRlTWFyayhtYXJrcywgc2V0TWFyaywgZmlsZVBhdGgpIHtcbiAgICBjb25zdCB7IG1hcmtzOiBmaWx0ZXJlZE1hcmtzLCBkZWxldGVkTWFyazogb3ZlcndyaXR0ZW5NYXJrIH0gPSBkZWxldGVNYXJrKG1hcmtzLCBzZXRNYXJrKTtcbiAgICBmaWx0ZXJlZE1hcmtzLnB1c2goeyBzeW1ib2w6IHNldE1hcmsuc3ltYm9sLCBmaWxlUGF0aDogZmlsZVBhdGggfSk7XG4gICAgcmV0dXJuIHsgbWFya3M6IGZpbHRlcmVkTWFya3MsIG92ZXJ3cml0dGVuTWFyayB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGRlbGV0ZU1hcmsobWFya3MsIG1hcmtUb0RlbGV0ZSkge1xuICAgIGNvbnN0IGNNYXJrID0geyAuLi5tYXJrVG9EZWxldGUgfTtcbiAgICBjb25zdCBkZWxldGVkTWFyayA9IG1hcmtzLmZpbmQobSA9PiBtLnN5bWJvbCA9PT0gY01hcmsuc3ltYm9sKTtcbiAgICBjb25zdCBmaWx0ZXJlZE1hcmtzID0gbWFya3MuZmlsdGVyKG0gPT4gbS5zeW1ib2wgIT09IGNNYXJrLnN5bWJvbCk7XG4gICAgcmV0dXJuIHsgbWFya3M6IGZpbHRlcmVkTWFya3MsIGRlbGV0ZWRNYXJrIH07XG59XG5leHBvcnQgZnVuY3Rpb24gaXNNYXJrSW5MaXN0KG1hcmtzLCBtYXJrKSB7XG4gICAgcmV0dXJuIG1hcmtzLnNvbWUobSA9PiBtLnN5bWJvbCA9PT0gbWFyay5zeW1ib2wgJiYgbS5maWxlUGF0aCA9PT0gbWFyay5maWxlUGF0aCk7XG59XG5leHBvcnQgZnVuY3Rpb24gaXNNYXJrSW5MaXN0QnlTeW1ib2wobWFya3MsIHN5bWJvbCkge1xuICAgIHJldHVybiBtYXJrcy5zb21lKG0gPT4gbS5zeW1ib2wgPT09IHN5bWJvbCk7XG59XG5leHBvcnQgZnVuY3Rpb24gaXNNYXJrSW5MaXN0QnlGaWxlUGF0aChtYXJrcywgZmlsZVBhdGgpIHtcbiAgICByZXR1cm4gbWFya3Muc29tZShtID0+IG0uZmlsZVBhdGggPT09IGZpbGVQYXRoKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBnb3RvTWFya05leHQobWFya3MsIHJlZ2lzdGVycywgY3VycmVudE1hcmspIHtcbiAgICBjb25zdCBzb3J0ZWRNYXJrcyA9IFsuLi5tYXJrc107XG4gICAgc29ydE1hcmtzQnlTZXR0aW5nc1JlZ2lzdGVyT3JkZXIoc29ydGVkTWFya3MsIHJlZ2lzdGVycyk7XG4gICAgY29uc3QgY3VycmVudEluZGV4ID0gc29ydGVkTWFya3MuZmluZEluZGV4KG0gPT4gbS5zeW1ib2wgPT09IGN1cnJlbnRNYXJrLnN5bWJvbCAmJiBtLmZpbGVQYXRoID09PSBjdXJyZW50TWFyay5maWxlUGF0aCk7XG4gICAgaWYgKGN1cnJlbnRJbmRleCA9PT0gLTEgfHwgY3VycmVudEluZGV4ID09PSBtYXJrcy5sZW5ndGggLSAxKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7IC8vIE5vIG5leHQgbWFya1xuICAgIH1cbiAgICByZXR1cm4gc29ydGVkTWFya3NbY3VycmVudEluZGV4ICsgMV07XG59XG5leHBvcnQgZnVuY3Rpb24gZ290b01hcmtQcmV2aW91cyhtYXJrcywgcmVnaXN0ZXJzLCBjdXJyZW50TWFyaykge1xuICAgIGNvbnN0IHNvcnRlZE1hcmtzID0gWy4uLm1hcmtzXTtcbiAgICBzb3J0TWFya3NCeVNldHRpbmdzUmVnaXN0ZXJPcmRlcihzb3J0ZWRNYXJrcywgcmVnaXN0ZXJzKTtcbiAgICBjb25zdCBjdXJyZW50SW5kZXggPSBzb3J0ZWRNYXJrcy5maW5kSW5kZXgobSA9PiBtLnN5bWJvbCA9PT0gY3VycmVudE1hcmsuc3ltYm9sICYmIG0uZmlsZVBhdGggPT09IGN1cnJlbnRNYXJrLmZpbGVQYXRoKTtcbiAgICBpZiAoY3VycmVudEluZGV4IDw9IDApIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsgLy8gTm8gcHJldmlvdXMgbWFya1xuICAgIH1cbiAgICByZXR1cm4gbWFya3NbY3VycmVudEluZGV4IC0gMV07XG59XG4iLCAiLy8gVGhpcyBpcyBub3QgdXNlZCBmb3Igbm93XG5leHBvcnQgY29uc3QgbW9kYWxQbGFjZWhvbGRlck1lc3NhZ2VzID0ge1xuICAgIHNldDogJ1NlbGVjdCBhIG1hcmsgdG8gc2V0JyxcbiAgICBnb3RvOiAnU2VsZWN0IGEgbWFyayB0byBnbyB0bycsXG4gICAgZGVsZXRlOiAnU2VsZWN0IGEgbWFyayB0byBkZWxldGUnLFxufTtcbmV4cG9ydCBjb25zdCBkZWZhdWx0QmFzaWNNYXJrc1NldHRpbmdzID0ge1xuICAgIHJlZ2lzdGVyTGlzdDogJ2FiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6JyxcbiAgICByZWdpc3RlclNvcnRCeUxpc3Q6IHRydWUsXG4gICAgaGFycG9vblJlZ2lzdGVyTGlzdDogJ3F3ZXInLFxuICAgIGhhcnBvb25SZWdpc3RlclNvcnRCeUxpc3Q6IHRydWUsXG4gICAgaGFycG9vblJlZ2lzdGVyR2FwUmVtb3ZhbDogdHJ1ZSxcbn07XG5leHBvcnQgY29uc3QgbW9kZURlc2NyaXB0aW9uID0ge1xuICAgICdzZXQnOiAnU2V0IG1hcmsnLFxuICAgICdnb3RvJzogJ0dvIHRvIG1hcmsnLFxuICAgICdkZWxldGUnOiAnRGVsZXRlIG1hcmsnXG59O1xuIiwgImltcG9ydCB7IEFwcCwgbm9ybWFsaXplUGF0aCwgTm90aWNlLCBURmlsZSwgV29ya3NwYWNlTGVhZiB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG9wZW5OZXdGaWxlQnlQYXRoKGZpbGVQYXRoOiBzdHJpbmcsIG9wZW5GaWxlSW5OZXdUYWI6IGJvb2xlYW4sIGFwcDogQXBwKSB7XHJcbiAgICBjb25zdCBmaWxlID0gYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlUGF0aCk7XHJcbiAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcbiAgICAgICAgaWYgKG9wZW5GaWxlSW5OZXdUYWIpIHtcclxuICAgICAgICAgICAgYXBwLndvcmtzcGFjZS5nZXRMZWFmKCd0YWInKS5vcGVuRmlsZShmaWxlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBhcHAud29ya3NwYWNlLmdldExlYWYoKS5vcGVuRmlsZShmaWxlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBuZXcgTm90aWNlKGBGaWxlIG5vdCBmb3VuZCBmb3IgcGF0aCAke2ZpbGVQYXRofS4gVGhlIGZpbGUgbWF5IGhhdmUgYmVlbiBkZWxldGVkLCBtb3ZlZCBvciByZW5hbWVkLmApO1xyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICogRmluZHMgYWxsIG9wZW5lZCBmaWxlcyBpbiB0aGUgbWFpbiBhcmVhIHRocm91Z2ggd29ya3NwYWNlLmdldExheW91dCgpLiBOb3QgQVBJIGNvbXBsaWFudC4gQ2FuIGJyZWFrIGFueXRpbWUuIEdldHMgYWxsIG9wZW5lZCBmaWxlcyByZWdhcmRsZXNzIG9mIHN0YXRlLiBcclxuICogKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEFsbE9wZW5lZEZpbGVzRXhwZXJpbWVudGFsKGFwcDogQXBwKTogYW55IHtcclxuICAgIC8vIEB0cy1pZ25vcmVcclxuICAgIGNvbnN0IHRhYkdyb3VwcyA9IGFwcC53b3Jrc3BhY2UuZ2V0TGF5b3V0KCkubWFpbj8uY2hpbGRyZW47XHJcbiAgICBjb25zdCBvdXQgPSBbXTtcclxuICAgIGZvciAoY29uc3QgZWwgb2YgdGFiR3JvdXBzKSB7XHJcbiAgICAgICAgb3V0LnB1c2goLi4uZWwuY2hpbGRyZW4pXHJcbiAgICB9XHJcbiAgICByZXR1cm4gb3V0O1xyXG59XHJcblxyXG4vKipcclxuICogRmluZHMgYWxsIHdvcmtzcGFjZSBsZWF2ZXMgdGhyb3VnaCB3b3Jrc3BhY2UuaXRlcmF0ZUFsbExlYXZlcy4gQVBJIGNvbXBsaWFudC4gSWdub3JlcyBhbGwgdGhlIG5vbiBpbnN0YW50aWF0ZWQgbGVhdmVzLlxyXG4gKiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0QWxsV29ya3NwYWNlTGVhdmVzKGFwcDogQXBwKTogV29ya3NwYWNlTGVhZltdIHtcclxuICAgIGNvbnN0IGxpc3Q6IFdvcmtzcGFjZUxlYWZbXSA9IFtdXHJcbiAgICBhcHAud29ya3NwYWNlLml0ZXJhdGVBbGxMZWF2ZXMobGVhZiA9PiB7XHJcbiAgICAgICAgbGlzdC5wdXNoKGxlYWYpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIGxpc3Q7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTZXRzIGFjdGl2ZSBhbiBvcGVuZWQgZmlsZSB0aGF0IG1hdGNoZXMgdGhlIGlucHV0IGZpbGUgcGF0aC4gUmVzcGVjdHMgdGFiIGdyb3VwaW5nLiBSZXR1cm5zIHN1Y2Nlc3MgYm9vbC4gIFxyXG4gKiBAcHVibGljXHJcbiAqICovXHJcbmV4cG9ydCBmdW5jdGlvbiBuYXZpZ2F0ZVRvT3BlbmVkRmlsZUJ5UGF0aChmaWxlUGF0aDogc3RyaW5nLCBleHBlcmltZW50YWxHb3RvOiBib29sZWFuLCBhcHA6IEFwcCk6IGJvb2xlYW4ge1xyXG4gICAgaWYgKGV4cGVyaW1lbnRhbEdvdG8pIHtcclxuICAgICAgICBjb25zdCBvcGVuZWRGaWxlcyA9IGdldEFsbE9wZW5lZEZpbGVzRXhwZXJpbWVudGFsKGFwcClcclxuICAgICAgICBmb3IgKGNvbnN0IG9wZW5lZEZpbGUgb2Ygb3BlbmVkRmlsZXMpIHtcclxuICAgICAgICAgICAgaWYgKG9wZW5lZEZpbGUudHlwZSA9PSAnbGVhZicgJiYgb3BlbmVkRmlsZS5zdGF0ZS5zdGF0ZS5maWxlID09PSBmaWxlUGF0aCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbGVhZiA9IGFwcC53b3Jrc3BhY2UuZ2V0TGVhZkJ5SWQob3BlbmVkRmlsZS5pZCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobGVhZiAmJiBsZWFmLnBhcmVudCA9PT0gYXBwLndvcmtzcGFjZS5nZXRMZWFmKCkucGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXBwLndvcmtzcGFjZS5zZXRBY3RpdmVMZWFmKGxlYWYsIHsgZm9jdXM6IHRydWUgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBjb25zdCBsZWF2ZXMgPSBnZXRBbGxXb3Jrc3BhY2VMZWF2ZXMoYXBwKTtcclxuICAgICAgICBmb3IgKGNvbnN0IGxlYWYgb2YgbGVhdmVzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHZpZXcgPSBsZWFmLnZpZXc7XHJcbiAgICAgICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3JcclxuICAgICAgICAgICAgaWYgKHZpZXcuZmlsZSAmJiB2aWV3LmZpbGUucGF0aCA9PT0gZmlsZVBhdGggJiYgbGVhZi5wYXJlbnQgPT09IGFwcC53b3Jrc3BhY2UuZ2V0TGVhZigpLnBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgYXBwLndvcmtzcGFjZS5zZXRBY3RpdmVMZWFmKGxlYWYsIHsgZm9jdXM6IHRydWUgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn0iLCAiaW1wb3J0IHsgQXBwLCBTdWdnZXN0TW9kYWwsIFBsYXRmb3JtLCBJbnN0cnVjdGlvbiB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBUZXRoZXJNYXJrc1BsdWdpbiBmcm9tICcuLi9tYWluJztcbmltcG9ydCB7IG1vZGFsTWFya0ZpbGVwYXRoQ2xhc3MsIG1vZGFsTWFya1N5bWJvbENsYXNzLCBtb2RhbE1hcmtIYXJwb29uU2lnbiB9IGZyb20gJy4uL3V0aWxzL2RlZmF1bHRWYWx1ZXMnO1xuaW1wb3J0IHsgbWF0Y2hLZXliaW5kLCBwcmVwYXJlS2V5YmluZHMgfSBmcm9tICcuLi91dGlscy9rZXliaW5kcyc7XG5pbXBvcnQgeyBwbHVnaW5EZWxldGVNYXJrLCBwbHVnaW5Hb1RvTWFyaywgcGx1Z2luUmVzdG9yZUxhc3RDaGFuZ2VkTWFyaywgcGx1Z2luU2V0TmV3T3JPdmVyd3JpdGVNYXJrIH0gZnJvbSAnLi4vcGx1Z2luT3BlcmF0aW9ucyc7XG5pbXBvcnQgeyBnZXRNYXJrQnlTeW1ib2wsIGdldFNvcnRlZEFuZEZpbHRlcmVkTWFya3MsIE1hcmssIE1vZGUsIG1vZGVEZXNjcmlwdGlvbiB9IGZyb20gJ3RldGhlci1tYXJrcy1jb3JlJztcbmltcG9ydCB7IE1vZGFsS2V5YmluZHMgfSBmcm9tICcuLi90eXBlcyc7XG5cblxuZXhwb3J0IGNsYXNzIE1hcmtMaXN0TW9kYWwgZXh0ZW5kcyBTdWdnZXN0TW9kYWw8TWFyaz4ge1xuICAgIHBsdWdpbjogVGV0aGVyTWFya3NQbHVnaW47XG4gICAgbW9kZTogTW9kZTtcbiAgICBwcml2YXRlIF9rZXlIYW5kbGVyPzogKGV2dDogS2V5Ym9hcmRFdmVudCkgPT4gdm9pZDtcbiAgICBpc0hhcnBvb25Nb2RlOiBib29sZWFuO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogVGV0aGVyTWFya3NQbHVnaW4sIG1vZGU6IE1vZGUsIGlzSGFycG9vbk1vZGU6IGJvb2xlYW4gPSBmYWxzZSkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICAgICAgdGhpcy5tb2RlID0gbW9kZTtcbiAgICAgICAgLy8gbm90IHVzZWQsIG5vIGlucHV0IGZpZWxkXG4gICAgICAgIC8vIHRoaXMuc2V0UGxhY2Vob2xkZXIobW9kYWxQbGFjZWhvbGRlck1lc3NhZ2VzW3RoaXMubW9kZV0pO1xuICAgICAgICB0aGlzLmlzSGFycG9vbk1vZGUgPSBpc0hhcnBvb25Nb2RlO1xuICAgIH1cblxuICAgIGdldEluc3RydWN0aW9ucyhtb2RhbEtleWJpbmRzOiBNb2RhbEtleWJpbmRzKTogSW5zdHJ1Y3Rpb25bXSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICB7IGNvbW1hbmQ6IG1vZGFsS2V5YmluZHMudXAuam9pbihcIi9cIiksIHB1cnBvc2U6ICdVcCcgfSxcbiAgICAgICAgICAgIHsgY29tbWFuZDogbW9kYWxLZXliaW5kcy5kb3duLmpvaW4oXCIvXCIpLCBwdXJwb3NlOiAnRG93bicgfSxcbiAgICAgICAgICAgIHsgY29tbWFuZDogJ1tTeW1ib2xdJywgcHVycG9zZTogbW9kZURlc2NyaXB0aW9uW3RoaXMubW9kZV0gfSxcbiAgICAgICAgICAgIHsgY29tbWFuZDogbW9kYWxLZXliaW5kcy5zZWxlY3Quam9pbihcIi9cIiksIHB1cnBvc2U6IG1vZGVEZXNjcmlwdGlvblt0aGlzLm1vZGVdIH0sXG4gICAgICAgICAgICB7IGNvbW1hbmQ6IG1vZGFsS2V5YmluZHMuZGVsZXRlLmpvaW4oXCIvXCIpLCBwdXJwb3NlOiAnRGVsZXRlJyB9LFxuICAgICAgICAgICAgeyBjb21tYW5kOiBtb2RhbEtleWJpbmRzLmNhbmNlbC5qb2luKFwiL1wiKSwgcHVycG9zZTogJ0NhbmNlbCcgfSxcbiAgICAgICAgICAgIHsgY29tbWFuZDogbW9kYWxLZXliaW5kcy51bmRvLmpvaW4oXCIvXCIpLCBwdXJwb3NlOiAnVW5kbycgfSxcblxuICAgICAgICBdO1xuICAgIH1cblxuICAgIGdldFN1Z2dlc3Rpb25zKHF1ZXJ5OiBzdHJpbmcpOiBNYXJrW10ge1xuICAgICAgICAvLyBObyBzZWFyY2ggaW5wdXRcbiAgICAgICAgcmV0dXJuIGdldFNvcnRlZEFuZEZpbHRlcmVkTWFya3ModGhpcy5wbHVnaW4ubWFya3MsIHRoaXMuaXNIYXJwb29uTW9kZSwgdGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuICAgIH1cblxuICAgIHJlbmRlclN1Z2dlc3Rpb24obWFyazogTWFyaywgZWw6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IHN5bWJvbEVsID0gZWwuY3JlYXRlRWwoJ3NwYW4nLCB7IHRleHQ6IG1hcmsuc3ltYm9sLCBjbHM6IG1vZGFsTWFya1N5bWJvbENsYXNzIH0pO1xuICAgICAgICBlbC5jcmVhdGVFbCgnc3BhbicsIHsgdGV4dDogbWFyay5maWxlUGF0aCwgY2xzOiBtb2RhbE1hcmtGaWxlcGF0aENsYXNzIH0pO1xuICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuaGFycG9vblJlZ2lzdGVyTGlzdC5jb250YWlucyhtYXJrLnN5bWJvbCkpIHtcbiAgICAgICAgICAgIGVsLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiBcIkhcIiwgY2xzOiBtb2RhbE1hcmtIYXJwb29uU2lnbiB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKT8ucGF0aCA9PT0gbWFyay5maWxlUGF0aCl7XG4gICAgICAgICAgICBzeW1ib2xFbC5hZGRDbGFzcygnaGlnaGxpZ2h0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoZXZ0KSA9PiB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLm9uQ2hvb3NlU3VnZ2VzdGlvbihtYXJrLCBldnQpO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIHN1cGVyLm9uT3BlbigpO1xuICAgICAgICAvLyBIaWRlIHRoZSBpbnB1dCBib3gsIGFzIGl0J3Mgbm90IG5lZWRlZFxuICAgICAgICBpZiAodGhpcy5pbnB1dEVsKSB7XG4gICAgICAgICAgICB0aGlzLmlucHV0RWwuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1vZGFsRWwuYWRkQ2xhc3MoJ21hcmtzLW1vZGFsJyk7XG5cbiAgICAgICAgY29uc3QgbW9kYWxLZXliaW5kcyA9IHByZXBhcmVLZXliaW5kcyhQbGF0Zm9ybS5pc01hY09TLCB0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XG4gICAgICAgIHRoaXMuc2V0SW5zdHJ1Y3Rpb25zKHRoaXMuZ2V0SW5zdHJ1Y3Rpb25zKG1vZGFsS2V5YmluZHMpKTtcblxuICAgICAgICB0aGlzLl9rZXlIYW5kbGVyID0gdGhpcy5nZXRNb2RhbEtleUhhbmRsZXIobW9kYWxLZXliaW5kcyk7XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5fa2V5SGFuZGxlciwgdHJ1ZSk7XG4gICAgfVxuXG4gICAgb25DbG9zZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuX2tleUhhbmRsZXIpIHtcbiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5fa2V5SGFuZGxlciwgdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLl9rZXlIYW5kbGVyID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHN1cGVyLm9uQ2xvc2UoKTtcbiAgICB9XG5cbiAgICBnZXRNb2RhbEtleUhhbmRsZXIoa2V5YmluZHM6IE1vZGFsS2V5YmluZHMpIHtcbiAgICAgICAgcmV0dXJuIGFzeW5jIChldnQ6IEtleWJvYXJkRXZlbnQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGF2YWlsYWJsZVJlZ2lzdGVycyA9IG5ldyBTZXQoKCF0aGlzLmlzSGFycG9vbk1vZGUgPyB0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZWdpc3Rlckxpc3QgOiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5oYXJwb29uUmVnaXN0ZXJMaXN0KS5zcGxpdCgnJykpO1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgY29uc3QgY2hvb3NlciA9IHRoaXMuY2hvb3NlcjtcbiAgICAgICAgICAgIGlmIChrZXliaW5kcy51cC5zb21lKGtiID0+IG1hdGNoS2V5YmluZChldnQsIGtiKSkpIHtcbiAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1vdmVTZWxlY3Rpb24oLTEpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChrZXliaW5kcy5kb3duLnNvbWUoa2IgPT4gbWF0Y2hLZXliaW5kKGV2dCwga2IpKSkge1xuICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHRoaXMubW92ZVNlbGVjdGlvbigxKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoa2V5YmluZHMuZGVsZXRlLnNvbWUoa2IgPT4gbWF0Y2hLZXliaW5kKGV2dCwga2IpKSkge1xuICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIGlmIChjaG9vc2VyLnZhbHVlcykge1xuICAgICAgICAgICAgICAgICAgICAvLyBEZWxldGUgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCBtYXJrXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZJZHggPSBjaG9vc2VyLnNlbGVjdGVkSXRlbTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWQ6IE1hcmsgPSBjaG9vc2VyLnZhbHVlc1twcmV2SWR4XTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBwbHVnaW5EZWxldGVNYXJrKHRoaXMucGx1Z2luLCBzZWxlY3RlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWZyZXNoIHRoZSBtb2RhbCBsaXN0XG4gICAgICAgICAgICAgICAgICAgICAgICBjaG9vc2VyLnZhbHVlcyA9IGdldFNvcnRlZEFuZEZpbHRlcmVkTWFya3ModGhpcy5wbHVnaW4ubWFya3MsIHRoaXMuaXNIYXJwb29uTW9kZSwgdGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hvb3Nlci5zZXRTdWdnZXN0aW9ucyhjaG9vc2VyLnZhbHVlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBQcmVzZXJ2ZSBzZWxlY3Rpb24gaW5kZXhcbiAgICAgICAgICAgICAgICAgICAgICAgIGNob29zZXIuc2V0U2VsZWN0ZWRJdGVtKE1hdGgubWF4KDAsIE1hdGgubWluKHByZXZJZHgsIGNob29zZXIudmFsdWVzLmxlbmd0aCkpLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChrZXliaW5kcy51bmRvLnNvbWUoa2IgPT4gbWF0Y2hLZXliaW5kKGV2dCwga2IpKSkge1xuICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIC8vIFJlc3RvcmUgdGhlIGxhc3QgY2hhbmdlZCBtYXJrXG4gICAgICAgICAgICAgICAgYXdhaXQgcGx1Z2luUmVzdG9yZUxhc3RDaGFuZ2VkTWFyayh0aGlzLnBsdWdpbik7XG4gICAgICAgICAgICAgICAgLy8gUmVmcmVzaCB0aGUgbW9kYWwgbGlzdFxuICAgICAgICAgICAgICAgIGNob29zZXIudmFsdWVzID0gZ2V0U29ydGVkQW5kRmlsdGVyZWRNYXJrcyh0aGlzLnBsdWdpbi5tYXJrcywgdGhpcy5pc0hhcnBvb25Nb2RlLCB0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XG4gICAgICAgICAgICAgICAgY29uc3QgcHJldklkeCA9IGNob29zZXIuc2VsZWN0ZWRJdGVtO1xuICAgICAgICAgICAgICAgIGNob29zZXIuc2V0U3VnZ2VzdGlvbnMoY2hvb3Nlci52YWx1ZXMpO1xuICAgICAgICAgICAgICAgIGNob29zZXIuc2V0U2VsZWN0ZWRJdGVtKE1hdGgubWF4KDAsIHByZXZJZHgpLCBmYWxzZSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGtleWJpbmRzLnNlbGVjdC5zb21lKGtiID0+IG1hdGNoS2V5YmluZChldnQsIGtiKSkpIHtcbiAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAvLyBEZWxldGUgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCBtYXJrXG4gICAgICAgICAgICAgICAgY29uc3QgaW5kID0gY2hvb3Nlci5zZWxlY3RlZEl0ZW07XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWQ6IE1hcmsgPSBjaG9vc2VyLnZhbHVlc1tpbmRdO1xuICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uQ2hvb3NlU3VnZ2VzdGlvbihzZWxlY3RlZCwgZXZ0KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoa2V5YmluZHMuY2FuY2VsLnNvbWUoa2IgPT4gbWF0Y2hLZXliaW5kKGV2dCwga2IpKSkge1xuICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYXZhaWxhYmxlUmVnaXN0ZXJzLmhhcyhldnQua2V5KSkge1xuICAgICAgICAgICAgICAgIGxldCBtYXJrID0gZ2V0TWFya0J5U3ltYm9sKHRoaXMucGx1Z2luLm1hcmtzLCBldnQua2V5KTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5tb2RlID09PSAnc2V0Jykge1xuICAgICAgICAgICAgICAgICAgICBpZiAobWFyayA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXJrID0geyBzeW1ib2w6IGV2dC5rZXksIGZpbGVQYXRoOiBcIlwiIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMub25DaG9vc2VTdWdnZXN0aW9uKG1hcmssIGV2dCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMubW9kZSA9PT0gJ2dvdG8nICYmIG1hcmspIHtcbiAgICAgICAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMub25DaG9vc2VTdWdnZXN0aW9uKG1hcmssIGV2dCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5tb2RlID09PSAnZGVsZXRlJyAmJiBtYXJrKSB7XG4gICAgICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLm9uQ2hvb3NlU3VnZ2VzdGlvbihtYXJrLCBldnQpO1xuICAgICAgICAgICAgICAgICAgICAvLyBSZWZyZXNoIHRoZSBtb2RhbCBsaXN0XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgYXN5bmMgb25DaG9vc2VTdWdnZXN0aW9uKG1hcms6IE1hcmssIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgaWYgKHRoaXMubW9kZSA9PT0gJ3NldCcpIHtcbiAgICAgICAgICAgIHBsdWdpblNldE5ld09yT3ZlcndyaXRlTWFyayh0aGlzLnBsdWdpbiwgbWFyayk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5tb2RlID09PSAnZ290bycpIHtcbiAgICAgICAgICAgIHBsdWdpbkdvVG9NYXJrKHRoaXMucGx1Z2luLCBtYXJrKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLm1vZGUgPT09ICdkZWxldGUnKSB7XG4gICAgICAgICAgICBwbHVnaW5EZWxldGVNYXJrKHRoaXMucGx1Z2luLCBtYXJrKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG1vdmVTZWxlY3Rpb24oZGVsdGE6IG51bWJlcikge1xuICAgICAgICAvLyBNb3ZlIHRoZSBzZWxlY3Rpb24gdXAgb3IgZG93biBieSBkZWx0YVxuICAgICAgICAvLyB0aGlzLmNob29zZXIgaXMgU3VnZ2VzdE1vZGFsJ3MgaW50ZXJuYWwgY2hvb3NlclxuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGNvbnN0IGNob29zZXIgPSB0aGlzLmNob29zZXI7XG4gICAgICAgIGlmICghY2hvb3NlcikgcmV0dXJuO1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGxldCBpZHggPSBjaG9vc2VyLnNlbGVjdGVkSXRlbTtcbiAgICAgICAgaWYgKHR5cGVvZiBpZHggIT09ICdudW1iZXInKSBpZHggPSAwO1xuICAgICAgICBpZiAoIWNob29zZXIudmFsdWVzKSByZXR1cm47XG4gICAgICAgIGNvbnN0IG1heCA9IGNob29zZXIudmFsdWVzLmxlbmd0aDtcbiAgICAgICAgbGV0IG5leHQgPSBpZHggKyBkZWx0YTtcbiAgICAgICAgaWYgKG5leHQgPCAwKSBuZXh0ID0gbWF4IC0gMTtcbiAgICAgICAgaWYgKG5leHQgPj0gbWF4KSBuZXh0ID0gMDtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBjaG9vc2VyLnNldFNlbGVjdGVkSXRlbShuZXh0LCAwIGFzIEtleWJvYXJkRXZlbnQpO1xuICAgIH1cblxufSIsICJpbXBvcnQgeyBkZWZhdWx0QmFzaWNNYXJrc1NldHRpbmdzIH0gZnJvbSBcInRldGhlci1tYXJrcy1jb3JlXCI7XHJcbmltcG9ydCB7IE1vZGFsS2V5YmluZHMsIE9ic2lkaWFuTWFya3NTZXR0aW5nc30gZnJvbSBcIi4uL3R5cGVzXCI7XHJcblxyXG5leHBvcnQgY29uc3QgbW9kYWxEZWZhdWx0S2V5YmluZHM6IE1vZGFsS2V5YmluZHMgPSB7XHJcbiAgICB1cDogWydjdHJsK2snLCAnY3RybCtwJ10gYXMgc3RyaW5nW10sXHJcbiAgICBkb3duOiBbJ2N0cmwraicsICdjdHJsK24nXSBhcyBzdHJpbmdbXSxcclxuICAgIGRlbGV0ZTogWydjdHJsK2QnXSBhcyBzdHJpbmdbXSxcclxuICAgIHNlbGVjdDogWydFbnRlciddIGFzIHN0cmluZ1tdLFxyXG4gICAgY2FuY2VsOiBbJ0VzY2FwZSddIGFzIHN0cmluZ1tdLFxyXG4gICAgdW5kbzogWydjdHJsK3UnXSBhcyBzdHJpbmdbXSxcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IG1vZGFsRGVmYXVsdEtleWJpbmRzTWFjOiBNb2RhbEtleWJpbmRzID0ge1xyXG4gICAgdXA6IFsnY21kK2snLCAnY21kK3AnXSBhcyBzdHJpbmdbXSxcclxuICAgIGRvd246IFsnY21kK2onLCAnY21kK24nXSBhcyBzdHJpbmdbXSxcclxuICAgIGRlbGV0ZTogWydjbWQrZCddIGFzIHN0cmluZ1tdLFxyXG4gICAgc2VsZWN0OiBbJ0VudGVyJ10gYXMgc3RyaW5nW10sXHJcbiAgICBjYW5jZWw6IFsnRXNjYXBlJ10gYXMgc3RyaW5nW10sXHJcbiAgICB1bmRvOiBbJ2NtZCt1J10gYXMgc3RyaW5nW10sXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBtb2RhbEluc3RydWN0aW9uRWxDbGFzcyA9ICdtb2RhbC1pbnN0cnVjdGlvbi1lbCc7XHJcbmV4cG9ydCBjb25zdCBtb2RhbE1hcmtTeW1ib2xDbGFzcyA9ICdtYXJrLXN5bWJvbCc7XHJcbmV4cG9ydCBjb25zdCBtb2RhbE1hcmtGaWxlcGF0aENsYXNzID0gJ21hcmstZmlsZS1wYXRoJztcclxuZXhwb3J0IGNvbnN0IG1vZGFsTWFya0hhcnBvb25TaWduID0gJ2hhcnBvb24tc2lnbic7XHJcblxyXG5leHBvcnQgY29uc3QgSlNPTnNjaGVtYVZlcnNpb24gPSAxO1xyXG5cclxuZXhwb3J0IGNvbnN0IGRlZmF1bHRPYnNpZGlhbk1hcmtzU2V0dGluZ3MgOiBPYnNpZGlhbk1hcmtzU2V0dGluZ3MgPSB7XHJcbiAgICAuLi5kZWZhdWx0QmFzaWNNYXJrc1NldHRpbmdzLFxyXG4gICAgLy8gaGlkZU1hcmtMaXN0RHVyaW5nSW5wdXQ6IGZhbHNlLFxyXG4gICAgb3Blbk1hcmtJbk5ld1RhYjogZmFsc2UsIC8vIElmIHRydWUsIG9wZW4gbWFyayBpbiBuZXcgdGFiLCBlbHNlIGluIGN1cnJlbnQgdGFiXHJcbiAgICBleHBlcmltZW50YWxHb3RvOiBmYWxzZSxcclxuICAgIG1vZGFsTGlzdFVwOiAnJyxcclxuICAgIG1vZGFsTGlzdERvd246ICcnLFxyXG4gICAgbW9kYWxMaXN0U2VsZWN0OiAnJyxcclxuICAgIG1vZGFsTGlzdFVuZG86ICcnLFxyXG4gICAgbW9kYWxMaXN0RGVsZXRlOiAnJyxcclxuICAgIG1vZGFsTGlzdENhbmNlbDogJycsXHJcbn1cclxuXHJcbiIsICJpbXBvcnQgeyBtb2RhbERlZmF1bHRLZXliaW5kcywgbW9kYWxEZWZhdWx0S2V5YmluZHNNYWMgfSBmcm9tIFwiLi9kZWZhdWx0VmFsdWVzXCI7XHJcbmltcG9ydCB7IE1vZGFsS2V5YmluZHMgfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuaW1wb3J0IHsgT2JzaWRpYW5NYXJrc1NldHRpbmdzIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcblxyXG4vLyBVdGlsaXR5IHRvIHByZXBhcmUga2V5YmluZHMgb2JqZWN0XHJcbmV4cG9ydCBmdW5jdGlvbiBwcmVwYXJlS2V5YmluZHMoaXNNYWNPUzogYm9vbGVhbiwgc2V0dGluZ3M6IE9ic2lkaWFuTWFya3NTZXR0aW5ncykge1xyXG4gICAgbGV0IGtleWJpbmRzOiBNb2RhbEtleWJpbmRzID0gKCFpc01hY09TKSA/IHsgLi4ubW9kYWxEZWZhdWx0S2V5YmluZHMgfSA6IHsgLi4ubW9kYWxEZWZhdWx0S2V5YmluZHNNYWMgfTtcclxuXHJcbiAgICBpZiAoc2V0dGluZ3MubW9kYWxMaXN0VXApIHtcclxuICAgICAgICBrZXliaW5kcy51cCA9IFtzZXR0aW5ncy5tb2RhbExpc3RVcF07XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHNldHRpbmdzLm1vZGFsTGlzdERvd24pIHtcclxuICAgICAgICBrZXliaW5kcy5kb3duID0gW3NldHRpbmdzLm1vZGFsTGlzdERvd25dO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChzZXR0aW5ncy5tb2RhbExpc3REZWxldGUpIHtcclxuICAgICAgICBrZXliaW5kcy5kZWxldGUgPSBbc2V0dGluZ3MubW9kYWxMaXN0RGVsZXRlXTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoc2V0dGluZ3MubW9kYWxMaXN0U2VsZWN0KSB7XHJcbiAgICAgICAga2V5YmluZHMuc2VsZWN0ID0gW3NldHRpbmdzLm1vZGFsTGlzdFNlbGVjdF07XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHNldHRpbmdzLm1vZGFsTGlzdFVuZG8pIHtcclxuICAgICAgICBrZXliaW5kcy51bmRvID0gW3NldHRpbmdzLm1vZGFsTGlzdFVuZG9dO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChzZXR0aW5ncy5tb2RhbExpc3RDYW5jZWwpIHtcclxuICAgICAgICBrZXliaW5kcy5jYW5jZWwgPSBbc2V0dGluZ3MubW9kYWxMaXN0Q2FuY2VsXTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ga2V5YmluZHM7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbWF0Y2hLZXliaW5kKGV2dDogS2V5Ym9hcmRFdmVudCwga2V5YmluZDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICAvLyBQYXJzZSBrZXliaW5kIHN0cmluZyBsaWtlICdjdHJsK3NoaWZ0K3AnLCAnY21kK24nLCBldGMuXHJcbiAgICBjb25zdCBwYXJ0cyA9IGtleWJpbmQuc3BsaXQoJysnKS5tYXAocCA9PiBwLnRyaW0oKSk7XHJcbiAgICBsZXQgcmVxdWlyZWQgPSB7IGN0cmw6IGZhbHNlLCBzaGlmdDogZmFsc2UsIGFsdDogZmFsc2UsIG1ldGE6IGZhbHNlLCBrZXk6ICcnIH07XHJcbiAgICBmb3IgKGNvbnN0IHBhcnQgb2YgcGFydHMpIHtcclxuICAgICAgICBpZiAocGFydCA9PT0gJ2N0cmwnKSByZXF1aXJlZC5jdHJsID0gdHJ1ZTtcclxuICAgICAgICBlbHNlIGlmIChwYXJ0ID09PSAnc2hpZnQnKSByZXF1aXJlZC5zaGlmdCA9IHRydWU7XHJcbiAgICAgICAgZWxzZSBpZiAocGFydCA9PT0gJ2FsdCcpIHJlcXVpcmVkLmFsdCA9IHRydWU7XHJcbiAgICAgICAgZWxzZSBpZiAocGFydCA9PT0gJ21ldGEnIHx8IHBhcnQgPT09ICdjbWQnIHx8IHBhcnQgPT09ICd3aW4nKSByZXF1aXJlZC5tZXRhID0gdHJ1ZTtcclxuICAgICAgICBlbHNlIHJlcXVpcmVkLmtleSA9IHBhcnQ7XHJcbiAgICB9XHJcbiAgICAvLyBDaGVjayBtb2RpZmllcnNcclxuICAgIGlmIChldnQuY3RybEtleSAhPT0gcmVxdWlyZWQuY3RybCkgcmV0dXJuIGZhbHNlO1xyXG4gICAgaWYgKGV2dC5zaGlmdEtleSAhPT0gcmVxdWlyZWQuc2hpZnQpIHJldHVybiBmYWxzZTtcclxuICAgIGlmIChldnQuYWx0S2V5ICE9PSByZXF1aXJlZC5hbHQpIHJldHVybiBmYWxzZTtcclxuICAgIGlmIChldnQubWV0YUtleSAhPT0gcmVxdWlyZWQubWV0YSkgcmV0dXJuIGZhbHNlO1xyXG4gICAgLy8gQ2hlY2sga2V5IChjYXNlLWluc2Vuc2l0aXZlKVxyXG4gICAgcmV0dXJuIGV2dC5rZXkgPT09IHJlcXVpcmVkLmtleTtcclxufSIsICJpbXBvcnQgVGV0aGVyTWFya3NQbHVnaW4gZnJvbSAnLi9tYWluJztcclxuaW1wb3J0IHsgcGx1Z2luQWRkRmlsZVRvSGFycG9vbiB9IGZyb20gJy4vcGx1Z2luT3BlcmF0aW9ucyc7XHJcbmltcG9ydCB7IE1hcmtMaXN0TW9kYWwgfSBmcm9tICcuL3VpL01hcmtMaXN0TW9kYWwnO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNldEdsb2JhbE1hcmsocGx1Z2luOiBUZXRoZXJNYXJrc1BsdWdpbikge1xyXG4gICAgbmV3IE1hcmtMaXN0TW9kYWwocGx1Z2luLmFwcCwgcGx1Z2luLCAnc2V0Jykub3BlbigpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ29Ub0dsb2JhbE1hcmsocGx1Z2luOiBUZXRoZXJNYXJrc1BsdWdpbikge1xyXG4gICAgbmV3IE1hcmtMaXN0TW9kYWwocGx1Z2luLmFwcCwgcGx1Z2luLCAnZ290bycpLm9wZW4oKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUdsb2JhbE1hcmsocGx1Z2luOiBUZXRoZXJNYXJrc1BsdWdpbikge1xyXG4gICAgbmV3IE1hcmtMaXN0TW9kYWwocGx1Z2luLmFwcCwgcGx1Z2luLCAnZGVsZXRlJykub3BlbigpO1xyXG59XHJcblxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFkZEZpbGVUb0hhcnBvb24ocGx1Z2luOiBUZXRoZXJNYXJrc1BsdWdpbikge1xyXG4gICAgcGx1Z2luQWRkRmlsZVRvSGFycG9vbihwbHVnaW4pO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ29Ub0hhcnBvb25NYXJrKHBsdWdpbjogVGV0aGVyTWFya3NQbHVnaW4pIHtcclxuICAgIG5ldyBNYXJrTGlzdE1vZGFsKHBsdWdpbi5hcHAsIHBsdWdpbiwgJ2dvdG8nLCB0cnVlKS5vcGVuKCk7XHJcbn0iLCAiaW1wb3J0IHsgQXBwLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IFRldGhlck1hcmtzUGx1Z2luIGZyb20gJy4uL21haW4nO1xuaW1wb3J0IHsgT2JzaWRpYW5NYXJrc1NldHRpbmdzIH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgZGVmYXVsdE9ic2lkaWFuTWFya3NTZXR0aW5ncyB9IGZyb20gJy4uL3V0aWxzL2RlZmF1bHRWYWx1ZXMnO1xuXG5leHBvcnQgY2xhc3MgU2V0dGluZ3NUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcbiAgICBwbHVnaW46IFRldGhlck1hcmtzUGx1Z2luO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogVGV0aGVyTWFya3NQbHVnaW4pIHtcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB9XG5cbiAgICBkaXNwbGF5KCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuICAgICAgICBjb25zdCBkcyA9IGRlZmF1bHRPYnNpZGlhbk1hcmtzU2V0dGluZ3M7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnT3BlbiBtYXJrIGluIG5ldyB0YWInKVxuICAgICAgICAgICAgLnNldERlc2MoJ09wZW4gYSBmaWxlIGluIHRoZSBuZXcgdGFiIHdoZW4gdXNpbmcgXCJnbyB0b1wiIGNvbW1hbmQuIElmIGRpc2FibGVkLCBpdCB3aWxsIG9wZW4gdGhlIGZpbGUgaW4gdGhlIGN1cnJlbnQgdGFiLicpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Mub3Blbk1hcmtJbk5ld1RhYiA/PyBkcy5vcGVuTWFya0luTmV3VGFiKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mub3Blbk1hcmtJbk5ld1RhYiA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdObyBkdXBsaWNhdGlvbiBvZiBvcGVuZWQgZmlsZXMgd2hlbiB1c2luZyBHbyB0byBjb21tYW5kcyAoZXhwZXJpbWVudGFsKScpXG4gICAgICAgICAgICAuc2V0RGVzYygnUHJldmVudHMgZHVwbGljYXRlIHRhYnMgd2hlbiBzd2l0Y2hpbmcgdG8gYWxyZWFkeSBvcGVuZWQgZmlsZXMgdXNpbmcgdGhlIG1hcmsgbGlzdCBhZnRlciByZXN0YXJ0aW5nIE9ic2lkaWFuLiAoRXhwZXJpbWVudGFsOiBtYXkgbm90IHdvcmsgaW4gZnV0dXJlIE9ic2lkaWFuIHZlcnNpb25zLiknKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmV4cGVyaW1lbnRhbEdvdG8gPz8gZHMuZXhwZXJpbWVudGFsR290bylcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmV4cGVyaW1lbnRhbEdvdG8gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpLnNldE5hbWUoJ0dlbmVyYWwgcmVnaXN0ZXJzJykuc2V0SGVhZGluZygpO1xuICAgICAgICB0aGlzLmNyZWF0ZVJlZ2lzdGVyTGlzdFNldHRpbmcoY29udGFpbmVyRWwsIFwiUmVnaXN0ZXIgbGlzdFwiLCBkcy5yZWdpc3Rlckxpc3QsICdLZXkgc3ltYm9scyB0byBiZSB1c2VkIGFzIHJlZ2lzdGVycy4gT25seSBpbmNsdWRlIHN5bWJvbHMgdGhhdCB5b3UgY2FuIGlucHV0IHdpdGggYSBzaW5nbGUga2V5c3Ryb2tlLicsICdyZWdpc3Rlckxpc3QnKVxuICAgICAgICAgICAgLmFkZEV4dHJhQnV0dG9uKChidG4pID0+IHtcbiAgICAgICAgICAgICAgICBidG5cbiAgICAgICAgICAgICAgICAgICAgLnNldEljb24oJ3JlZnJlc2gtY2N3JylcbiAgICAgICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoJ1Jlc2V0IHRvIGRlZmF1bHQgcmVnaXN0ZXIgbGlzdCcpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnJlZ2lzdGVyTGlzdCA9IGRzLnJlZ2lzdGVyTGlzdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7IC8vIFJlZnJlc2ggdGhlIHNldHRpbmdzIHRhYiB0byBzaG93IHRoZSB1cGRhdGVkIHZhbHVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnU29ydCBhbGwgbWFya3MgYnkgcmVnaXN0ZXIgbGlzdCcpXG4gICAgICAgICAgICAuc2V0RGVzYygnU29ydCBtYXJrcyBieSB0aGUgb3JkZXIgb2YgdGhlIGtleSBzeW1ib2xzIGluIHRoZSByZWdpc3RlciBsaXN0LiBJZiBkaXNhYmxlZCwgbWFya3Mgd2lsbCBiZSBzb3J0ZWQgYWxwaGFiZXRpY2FsbHkgYWNjb3JkaW5nIHRvIHRoZSBjdXJyZW50IGxvY2FsZS4nKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnJlZ2lzdGVyU29ydEJ5TGlzdCA/PyBkcy5yZWdpc3RlclNvcnRCeUxpc3QpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZWdpc3RlclNvcnRCeUxpc3QgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgLy8gVE9ETzogaW1wbGVtZW50IHRoaXMgZmVhdHVyZVxuICAgICAgICAvLyBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgLy8gICAgIC5zZXROYW1lKCdIaWRlIG1hcmsgbGlzdCcpXG4gICAgICAgIC8vICAgICAuc2V0RGVzYygnSGlkZSB0aGUgZ2xvYmFsIG1hcmsgbGlzdCBmb3IgYm90aCBjb21tYW5kcyAoZm9yIGZhc3QgaW5wdXQsIG5vIGZsaWNrZXIpLicpXG4gICAgICAgIC8vICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgLy8gICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuaGlkZU1hcmtMaXN0RHVyaW5nSW5wdXQgPz8gZHMuaGlkZU1hcmtMaXN0RHVyaW5nSW5wdXQpXG4gICAgICAgIC8vICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAvLyAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5oaWRlTWFya0xpc3REdXJpbmdJbnB1dCA9IHZhbHVlO1xuICAgICAgICAvLyAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgLy8gICAgICAgICB9KSk7XG5cblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZSgnSGFycG9vbiByZWdpc3RlcnMnKS5zZXRIZWFkaW5nKCk7XG4gICAgICAgIHRoaXMuY3JlYXRlUmVnaXN0ZXJMaXN0U2V0dGluZyhjb250YWluZXJFbCwgXCJIYXJwb29uIHJlZ2lzdGVyIGxpc3RcIiwgZHMuaGFycG9vblJlZ2lzdGVyTGlzdCwgJ0tleSBzeW1ib2xzIHRvIGJlIHVzZWQgYXMgSGFycG9vbiByZWdpc3RlcnMuIE9ubHkgaW5jbHVkZSBzeW1ib2xzIHRoYXQgeW91IGNhbiBpbnB1dCB3aXRoIGEgc2luZ2xlIGtleXN0cm9rZS4nLCAnaGFycG9vblJlZ2lzdGVyTGlzdCcpXG4gICAgICAgICAgICAuYWRkRXh0cmFCdXR0b24oKGJ0bikgPT4ge1xuICAgICAgICAgICAgICAgIGJ0blxuICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbigncmVmcmVzaC1jY3cnKVxuICAgICAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcCgnUmVzZXQgdG8gZGVmYXVsdCBIYXJwb29uIHJlZ2lzdGVyIGxpc3QnKVxuICAgICAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5oYXJwb29uUmVnaXN0ZXJMaXN0ID0gZHMuaGFycG9vblJlZ2lzdGVyTGlzdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7IC8vIFJlZnJlc2ggdGhlIHNldHRpbmdzIHRhYiB0byBzaG93IHRoZSB1cGRhdGVkIHZhbHVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnU29ydCBIYXJwb29uIG1hcmtzIGJ5IEhhcnBvb24gcmVnaXN0ZXIgbGlzdCcpXG4gICAgICAgICAgICAuc2V0RGVzYygnU29ydCBIYXJwb29uIG1hcmtzIGJ5IHRoZSBvcmRlciBvZiB0aGUga2V5IHN5bWJvbHMgaW4gdGhlIEhhcnBvb24gcmVnaXN0ZXIgbGlzdC4gSWYgZGlzYWJsZWQsIG1hcmtzIHdpbGwgYmUgc29ydGVkIGFscGhhYmV0aWNhbGx5IGFjY29yZGluZyB0byB0aGUgY3VycmVudCBsb2NhbGUuJylcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5oYXJwb29uUmVnaXN0ZXJTb3J0QnlMaXN0ID8/IGRzLmhhcnBvb25SZWdpc3RlclNvcnRCeUxpc3QpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5oYXJwb29uUmVnaXN0ZXJTb3J0QnlMaXN0ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1JlbW92ZSBnYXBzIGluYmV0d2VlbiBIYXJwb29uIG1hcmtzJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdIYXJwb29uIG1hcmtzIHdpbGwgYmUgc2hpZnRlZCB0byB0aGUgbGVmdCBmb3IgZXZlcnkgZ2FwIChyZWdpc3RlciB3aXRoIG5vIG1hcmspIGJhc2VkIG9uIHRoZSBvcmRlciBvZiB0aGUgSGFycG9vbiByZWdpc3RlciBsaXN0LicpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuaGFycG9vblJlZ2lzdGVyR2FwUmVtb3ZhbCA/PyBkcy5oYXJwb29uUmVnaXN0ZXJHYXBSZW1vdmFsKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaGFycG9vblJlZ2lzdGVyR2FwUmVtb3ZhbCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcblxuXG4gICAgICAgIC8vIEFkZCBrZXlib2FyZCBzaG9ydGN1dCBzZXR0aW5nc1xuICAgICAgICAvLyBUT0RPOiBzZXR0aW5nIHRob3NlIHZhbHVlcyBoZXJlIGxpa2UgZmVlbHMgd3JvbmcsIGVzcGVjaWFsbHkgcGFzc2luZyBvYmplY3QgcHJvcGVydHkgYXMgc3RyaW5nXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0xpc3QgbmF2aWdhdGlvbiBzaG9ydGN1dHMnIH0pO1xuICAgICAgICB0aGlzLmNyZWF0ZVNob3J0Y3V0U2V0dGluZyhjb250YWluZXJFbCwgJ1VwJywgZHMubW9kYWxMaXN0VXAsICdTaG9ydGN1dCBmb3IgbW92aW5nIHVwIGluIHRoZSBsaXN0JywgJ21vZGFsTGlzdFVwJyk7XG4gICAgICAgIHRoaXMuY3JlYXRlU2hvcnRjdXRTZXR0aW5nKGNvbnRhaW5lckVsLCAnRG93bicsIGRzLm1vZGFsTGlzdERvd24sICdTaG9ydGN1dCBmb3IgbW92aW5nIGRvd24gaW4gdGhlIGxpc3QnLCAnbW9kYWxMaXN0RG93bicpO1xuICAgICAgICB0aGlzLmNyZWF0ZVNob3J0Y3V0U2V0dGluZyhjb250YWluZXJFbCwgJ1NlbGVjdCBtYXJrJywgZHMubW9kYWxMaXN0U2VsZWN0LCAnU2hvcnRjdXQgZm9yIHNlbGVjdGluZyBhIG1hcmsnLCAnbW9kYWxMaXN0U2VsZWN0Jyk7XG4gICAgICAgIHRoaXMuY3JlYXRlU2hvcnRjdXRTZXR0aW5nKGNvbnRhaW5lckVsLCAnQ2FuY2VsIG1vZGFsJywgZHMubW9kYWxMaXN0Q2FuY2VsLCAnU2hvcnRjdXQgZm9yIGNhbmNlbGxpbmcgdGhlIG1vZGFsJywgJ21vZGFsTGlzdENhbmNlbCcpO1xuICAgICAgICB0aGlzLmNyZWF0ZVNob3J0Y3V0U2V0dGluZyhjb250YWluZXJFbCwgJ0RlbGV0ZSBtYXJrJywgZHMubW9kYWxMaXN0RGVsZXRlLCAnU2hvcnRjdXQgZm9yIGRlbGV0aW5nIGEgbWFyaycsICdtb2RhbExpc3REZWxldGUnKTtcbiAgICAgICAgdGhpcy5jcmVhdGVTaG9ydGN1dFNldHRpbmcoY29udGFpbmVyRWwsICdSZXN0b3JlIGxhc3QgY2hhbmdlZCBtYXJrJywgZHMubW9kYWxMaXN0VW5kbywgJ1Nob3J0Y3V0IGZvciB1bmRvaW5nIGxhc3QgYWN0aW9uIG9mIGNoYW5naW5nIGEgbWFyaycsICdtb2RhbExpc3RVbmRvJyk7XG5cblxuICAgIH1cblxuICAgIC8vIHVzZSBvbmx5IGZvciBzdHJpbmcgdmFsdWVzIGZyb20gU2V0dGluZ3MgdHlwZVxuICAgIGNyZWF0ZVNob3J0Y3V0U2V0dGluZyhjb250YWluZXJFbDogSFRNTEVsZW1lbnQsIG5hbWU6IHN0cmluZywgZGVmYXVsdFZhbHVlOiBzdHJpbmcsIGRlc2M6IHN0cmluZywga2V5OiBrZXlvZiBPYnNpZGlhbk1hcmtzU2V0dGluZ3MpIHtcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShuYW1lKVxuICAgICAgICAgICAgLnNldERlc2MoZGVzYylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShTdHJpbmcodGhpcy5wbHVnaW4uc2V0dGluZ3Nba2V5XSA/PyBkZWZhdWx0VmFsdWUpKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgKHRoaXMucGx1Z2luLnNldHRpbmdzIGFzIGFueSlba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgfVxuXG4gICAgY3JlYXRlUmVnaXN0ZXJMaXN0U2V0dGluZyhjb250YWluZXJFbDogSFRNTEVsZW1lbnQsIG5hbWU6IHN0cmluZywgZGVmYXVsdFZhbHVlOiBzdHJpbmcsIGRlc2M6IHN0cmluZywga2V5OiBrZXlvZiBPYnNpZGlhbk1hcmtzU2V0dGluZ3MpOiBTZXR0aW5nIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUobmFtZSlcbiAgICAgICAgICAgIC5zZXREZXNjKGRlc2MpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUoU3RyaW5nKHRoaXMucGx1Z2luLnNldHRpbmdzW2tleV0gPz8gZGVmYXVsdFZhbHVlKSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICh0aGlzLnBsdWdpbi5zZXR0aW5ncyBhcyBhbnkpW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgIH1cbn0iLCAiaW1wb3J0IHsgTm90aWNlIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgVGV0aGVyTWFya3NQbHVnaW4gZnJvbSAnLi4vbWFpbic7XHJcbmltcG9ydCB7IGRlZmF1bHRPYnNpZGlhbk1hcmtzU2V0dGluZ3MsIEpTT05zY2hlbWFWZXJzaW9uIGFzIGxhdGVzdEpTT05TY2hlbWFWZXJzaW9uIH0gZnJvbSAnLi9kZWZhdWx0VmFsdWVzJztcclxuaW1wb3J0IHsgTWFya30gZnJvbSAndGV0aGVyLW1hcmtzLWNvcmUnO1xyXG5pbXBvcnQgeyBPYnNpZGlhbk1hcmtzU2V0dGluZ3MgfSBmcm9tICcuLi90eXBlcyc7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9hZFNldHRpbmdzKHBsdWdpbjogVGV0aGVyTWFya3NQbHVnaW4pOiBQcm9taXNlPE9ic2lkaWFuTWFya3NTZXR0aW5ncz4ge1xyXG4gICAgcmV0dXJuIChhd2FpdCBwbHVnaW4ubG9hZERhdGEoKSk/LnNldHRpbmdzIHx8IGRlZmF1bHRPYnNpZGlhbk1hcmtzU2V0dGluZ3M7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzYXZlU2V0dGluZ3MocGx1Z2luOiBUZXRoZXJNYXJrc1BsdWdpbiwgc2V0dGluZ3M6IE9ic2lkaWFuTWFya3NTZXR0aW5ncykge1xyXG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHBsdWdpbi5sb2FkRGF0YSgpIHx8IHt9O1xyXG4gICAgZGF0YS5zZXR0aW5ncyA9IHNldHRpbmdzO1xyXG4gICAgYXdhaXQgcGx1Z2luLnNhdmVEYXRhKGRhdGEpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9hZE1hcmtzKHBsdWdpbjogVGV0aGVyTWFya3NQbHVnaW4pOiBQcm9taXNlPE1hcmtbXT4ge1xyXG4gICAgcmV0dXJuIChhd2FpdCBwbHVnaW4ubG9hZERhdGEoKSk/Lm1hcmtzIHx8IFtdO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2F2ZU1hcmtzKHBsdWdpbjogVGV0aGVyTWFya3NQbHVnaW4sIG1hcmtzOiBNYXJrW10pIHtcclxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBwbHVnaW4ubG9hZERhdGEoKSB8fCB7fTtcclxuICAgIGRhdGEubWFya3MgPSBtYXJrcztcclxuICAgIGF3YWl0IHBsdWdpbi5zYXZlRGF0YShkYXRhKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvYWRMYXN0Q2hhbmdlZE1hcmsocGx1Z2luOiBUZXRoZXJNYXJrc1BsdWdpbik6IFByb21pc2U8TWFyaz4ge1xyXG4gICAgcmV0dXJuIChhd2FpdCBwbHVnaW4ubG9hZERhdGEoKSk/Lmxhc3RDaGFuZ2VkTWFyayB8fCB7fTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNhdmVMYXN0Q2hhbmdlZE1hcmsocGx1Z2luOiBUZXRoZXJNYXJrc1BsdWdpbiwgbGFzdENoYW5nZWRNYXJrOiBNYXJrKSB7XHJcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcGx1Z2luLmxvYWREYXRhKCkgfHwge307XHJcbiAgICBkYXRhLmxhc3RDaGFuZ2VkTWFyayA9IGxhc3RDaGFuZ2VkTWFyaztcclxuICAgIGF3YWl0IHBsdWdpbi5zYXZlRGF0YShkYXRhKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEpTT05zY2hlbWFDaGVjayhwbHVnaW46IFRldGhlck1hcmtzUGx1Z2luKSB7XHJcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcGx1Z2luLmxvYWREYXRhKCkgfHwge3NjaGVtYVZlcnNpb246IGxhdGVzdEpTT05TY2hlbWFWZXJzaW9ufTtcclxuXHJcbiAgICBpZiAoZGF0YS5zY2hlbWFWZXJzaW9uICYmIGRhdGEuc2NoZW1hVmVyc2lvbiA9PT0gbGF0ZXN0SlNPTlNjaGVtYVZlcnNpb24pe1xyXG4gICAgICAgIHJldHVyblxyXG4gICAgfVxyXG5cclxuICAgIG5ldyBOb3RpY2UocGx1Z2luLm1hbmlmZXN0Lm5hbWUgKyBcIjogRmF1bHR5IGRhdGEuIENoZWNrIGRldmVsb3BlciB0b29scyBmb3IgbW9yZSBpbmZvLlwiKTtcclxuICAgIGNvbnNvbGUuZXJyb3IocGx1Z2luLm1hbmlmZXN0LmlkICsgXCI6IFRoZSBkYXRhIGxvYWRlZCBpcyBub3QgaW4gY29ycmVjdCBmb3JtYXQuIFRoZSBwbHVnaW4gbWF5IG5vdCB3b3JrIHByb3Blcmx5LiBUaGlzIHVzdWFsbHkgaGFwcGVucyBhZnRlciBwbHVnaW4gdXBkYXRlIHRoYXQgY2hhbmdlcyB0aGUgSlNPTiBzY2hlbWEuIFwiKTtcclxuICAgIC8vIFRPRE86IG1ha2UgYXV0b21hdGljIGNvbnZlcnNpb25zIGhlcmUgaWYgbmVjZXNzYXJ5IGluIHRoZSBmdXR1cmUuIEJlIHN1cmUgdG8gc2F2ZSB0aGUgbGVnYWN5IHByZSBjb252ZXJzaW9uIGRhdGEgYXMgYmFja3VwIGluIHRoZSBcImxlZ2FjeVNjaGVtYURhdGFcIiBmaWVsZC4gXHJcbn0iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFBLG1CQUF1Qjs7O0FDQXZCLElBQUFDLG1CQUF1Qjs7O0FDQWhCLFNBQVMsd0JBQXdCLE9BQU8sV0FBVztBQUN0RCxhQUFXLE9BQU8sV0FBVztBQUd6QixRQUFJLENBQUUsTUFBTSxJQUFJLE9BQUssRUFBRSxNQUFNLEVBQUUsU0FBUyxHQUFHLEdBQUk7QUFDM0MsYUFBTztBQUFBLElBQ1g7QUFBQSxFQUNKO0FBQ0EsU0FBTztBQUNYO0FBQ08sU0FBUyxnQkFBZ0IsT0FBTyxRQUFRO0FBQzNDLFNBQU8sTUFBTSxLQUFLLE9BQUssRUFBRSxXQUFXLE1BQU07QUFDOUM7QUFDTyxTQUFTLHdCQUF3QixPQUFPO0FBQzNDLFFBQU0sS0FBSyxDQUFDLEdBQUcsTUFBTSxFQUFFLE9BQU8sY0FBYyxFQUFFLE1BQU0sQ0FBQztBQUN6RDtBQUNPLFNBQVMsMEJBQTBCLE9BQU8sZUFBZSxVQUFVO0FBQ3RFLFFBQU0scUJBQXFCLElBQUksS0FBSyxDQUFDLGdCQUFnQixTQUFTLGVBQWUsU0FBUyxxQkFBcUIsTUFBTSxFQUFFLENBQUM7QUFDcEgsUUFBTSxnQkFBZ0IsTUFBTSxPQUFPLFFBQU0sbUJBQW1CLElBQUksR0FBRyxNQUFNLENBQUM7QUFDMUUsTUFBSSxD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O0FBQUE7QUFFSSxpQkFBZ0IsQ0FBQztBQUNqQiwyQkFBK0I7QUFBQTtBQUFBLEVBRS9CLE1BQU0sU0FBUztBQUNYLFVBQU0sZ0JBQWdCLElBQUk7QUFFMUIsU0FBSyxXQUFXLE1BQU0sYUFBYSxJQUFJO0FBQ3ZDLFNBQUssUUFBUSxNQUFNLFVBQVUsSUFBSTtBQUNqQyxTQUFLLGtCQUFrQixNQUFNLG9CQUFvQixJQUFJO0FBRXJELFNBQUssV0FBVztBQUFBLE1BQ1osSUFBSTtBQUFBLE1BQ0osTUFBTTtBQUFBLE1BQ04sVUFBVSxNQUFNLGNBQWMsSUFBSTtBQUFBLElBQ3RDLENBQUM7QUFJRCxTQUFLLFdBQVc7QUFBQSxNQUNaLElBQUk7QUFBQSxNQUNKLE1BQU07QUFBQSxNQUNOLFVBQVUsTUFBTSxlQUFlLElBQUk7QUFBQSxJQUN2QyxDQUFDO0FBRUQsU0FBSyxXQUFXO0FBQUEsTUFDWixJQUFJO0FBQUEsTUFDSixNQUFNO0FBQUEsTUFDTixVQUFVLE1BQU0saUJBQWlCLElBQUk7QUFBQSxJQUN6QyxDQUFDO0FBRUQsU0FBSyxXQUFXO0FBQUEsTUFDWixJQUFJO0FBQUEsTUFDSixNQUFNO0FBQUEsTUFDTixVQUFVLE1BQU0saUJBQWlCLElBQUk7QUFBQSxJQUN6QyxDQUFDO0FBRUQsU0FBSyxXQUFXO0FBQUEsTUFDWixJQUFJO0FBQUEsTUFDSixNQUFNO0FBQUEsTUFDTixVQUFVLE1BQU0sZ0JBQWdCLElBQUk7QUFBQSxJQUN4QyxDQUFDO0FBRUQsU0FBSyxjQUFjLElBQUksWUFBWSxLQUFLLEtBQUssSUFBSSxDQUFDO0FBRWxELFlBQVEsSUFBSSxhQUFhLEtBQUssU0FBUyxFQUFFO0FBQUEsRUFDN0M7QUFBQSxFQUVBLE1BQU0sZUFBZTtBQUNqQixVQUFNLGFBQWEsTUFBTSxLQUFLLFFBQVE7QUFBQSxFQUMxQztBQUFBLEVBRUEsTUFBTSxVQUFVLE9BQWU7QUFDM0IsU0FBSyxRQUFRO0FBQ2IsVUFBTSxVQUFVLE1BQU0sS0FBSztBQUFBLEVBQy9CO0FBQUEsRUFFQSxNQUFNLG9CQUFvQixpQkFBdUI7QUFDN0MsU0FBSyxrQkFBa0I7QUFDdkIsVUFBTSxvQkFBb0IsTUFBTSxlQUFlO0FBQUEsRUFDbkQ7QUFBQSxFQUVBLFdBQVc7QUFDUCxZQUFRLElBQUksZUFBZSxLQUFLLFNBQVMsRUFBRTtBQUFBLEVBQy9DO0FBQ0o7IiwKICAibmFtZXMiOiBbImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iXQp9Cg==
