/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => TetherMarksPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian5 = require("obsidian");

// src/ui/MarkListModal.ts
var import_obsidian2 = require("obsidian");

// src/utils/defaultValues.ts
var modalDefaultKeybinds = {
  up: ["ctrl+k", "ctrl+p"],
  down: ["ctrl+j", "ctrl+n"],
  delete: ["ctrl+d"],
  select: ["Enter"],
  cancel: ["Escape"]
};
var modalDefaultKeybindsMac = {
  up: ["cmd+k", "cmd+p"],
  down: ["cmd+j", "cmd+n"],
  delete: ["cmd+d"],
  select: ["Enter"],
  cancel: ["Escape"]
};
var defaultSettings = {
  // hideMarkListDuringInput: false,
  modalListUp: "",
  modalListDown: "",
  modalListSelect: "",
  modalListDelete: "",
  modalListCancel: "",
  openMarkInNewTab: false,
  // If true, open mark in new tab, else in current tab
  registerList: "abcdefghijklmnopqrstuvwxyz",
  registerSortByList: true,
  harpoonRegisterList: "qwer",
  harpoonRegisterSortByList: true,
  harpoonRegisterGapRemoval: true,
  experimentalGoto: false
};
var modalInstructionElClass = "modal-instruction-el";
var modalMarkSymbolClass = "mark-symbol";
var modalMarkFilepathClass = "mark-file-path";
var modalMarkHarpoonSign = "harpoon-sign";
var JSONschemaVersion = 1;
var modeDescription = {
  "set": "Set mark",
  "goto": "Go to mark",
  "delete": "Delete mark"
};

// src/utils/marks.ts
function findFirstUnusedRegister(marks, registers) {
  for (const reg of registers) {
    if (!marks.map((m) => m.symbol).includes(reg)) {
      return reg;
    }
  }
  return null;
}
function getMarkBySymbol(marks, symbol) {
  return marks.find((m) => m.symbol === symbol);
}
function sortMarksAlphabetically(marks) {
  marks.sort((a, b) => a.symbol.localeCompare(b.symbol));
}
function getSortedAndFilteredMarks(marks, isHarpoonMode, settings) {
  const availableRegisters = new Set((!isHarpoonMode ? settings.registerList : settings.harpoonRegisterList).split(""));
  const filteredMarks = marks.filter((el) => availableRegisters.has(el.symbol));
  if (!isHarpoonMode && settings.registerSortByList) {
    const registerList = settings.registerList;
    sortMarksBySettingsRegisterOrder(filteredMarks, registerList);
  } else if (isHarpoonMode && settings.harpoonRegisterSortByList) {
    const registerList = settings.harpoonRegisterList;
    sortMarksBySettingsRegisterOrder(filteredMarks, registerList);
  } else {
    sortMarksAlphabetically(filteredMarks);
  }
  return filteredMarks;
}
function sortMarksBySettingsRegisterOrder(marks, registers) {
  const registerOrder = new Map([...registers].map((symbol, index) => [symbol, index]));
  marks.sort((a, b) => {
    var _a, _b;
    return ((_a = registerOrder.get(a.symbol)) != null ? _a : Infinity) - ((_b = registerOrder.get(b.symbol)) != null ? _b : Infinity);
  });
}
function removeGapsForHarpoonMarks(marksToCopy, harpoonRegisters) {
  let marks = [...marksToCopy];
  let leftCur = 0;
  let rightCur = 0;
  while (rightCur < harpoonRegisters.length) {
    const markEl = marks.find((el) => el.symbol === harpoonRegisters[rightCur]);
    if (markEl !== void 0) {
      const symbolToSetTo = harpoonRegisters[leftCur];
      let filteredMarks = marks.filter((el) => el.symbol !== harpoonRegisters[leftCur]);
      filteredMarks.push({ symbol: symbolToSetTo, filePath: markEl.filePath });
      marks = filteredMarks;
      leftCur += 1;
    }
    rightCur += 1;
  }
  while (leftCur < harpoonRegisters.length) {
    marks = marks.filter((el) => el.symbol !== harpoonRegisters[leftCur]);
    leftCur += 1;
  }
  return marks;
}
function setNewOrOverwriteMark(marks, setMark, filePath) {
  const outMarks = marks.filter((m) => m.symbol !== setMark.symbol);
  outMarks.push({ symbol: setMark.symbol, filePath });
  return outMarks;
}

// src/utils/keybinds.ts
function prepareKeybinds(isMacOS, settings) {
  let keybinds = !isMacOS ? { ...modalDefaultKeybinds } : { ...modalDefaultKeybindsMac };
  if (settings.modalListUp) {
    keybinds.up = [settings.modalListUp];
  }
  if (settings.modalListDown) {
    keybinds.down = [settings.modalListDown];
  }
  if (settings.modalListDelete) {
    keybinds.delete = [settings.modalListDelete];
  }
  if (settings.modalListSelect) {
    keybinds.select = [settings.modalListSelect];
  }
  if (settings.modalListCancel) {
    keybinds.cancel = [settings.modalListCancel];
  }
  return keybinds;
}
function matchKeybind(evt, keybind) {
  const parts = keybind.split("+").map((p) => p.trim());
  let required = { ctrl: false, shift: false, alt: false, meta: false, key: "" };
  for (const part of parts) {
    if (part === "ctrl")
      required.ctrl = true;
    else if (part === "shift")
      required.shift = true;
    else if (part === "alt")
      required.alt = true;
    else if (part === "meta" || part === "cmd" || part === "win")
      required.meta = true;
    else
      required.key = part;
  }
  if (evt.ctrlKey !== required.ctrl)
    return false;
  if (evt.shiftKey !== required.shift)
    return false;
  if (evt.altKey !== required.alt)
    return false;
  if (evt.metaKey !== required.meta)
    return false;
  return evt.key === required.key;
}

// src/utils/obsidianUtils.ts
var import_obsidian = require("obsidian");
function openNewFile(filePath, openFileInNewTab, app) {
  const file = app.vault.getAbstractFileByPath(filePath);
  if (file instanceof import_obsidian.TFile) {
    if (openFileInNewTab) {
      app.workspace.getLeaf("tab").openFile(file);
    } else {
      app.workspace.getLeaf().openFile(file);
    }
  } else {
    new import_obsidian.Notice(`File not found for path ${filePath}. The file may have been deleted, moved or renamed.`);
  }
}
function getAllOpenedFilesExperimental(app) {
  var _a;
  const tabGroups = (_a = app.workspace.getLayout().main) == null ? void 0 : _a.children;
  const out = [];
  for (const el of tabGroups) {
    out.push(...el.children);
  }
  return out;
}
function getAllWorkspaceLeaves(app) {
  const list = [];
  app.workspace.iterateAllLeaves((leaf) => {
    list.push(leaf);
  });
  return list;
}
function navigateToOpenedFileByPath(filePath, experimentalGoto, app) {
  if (experimentalGoto) {
    const openedFiles = getAllOpenedFilesExperimental(app);
    for (const openedFile of openedFiles) {
      if (openedFile.type == "leaf" && openedFile.state.state.file === filePath) {
        const leaf = app.workspace.getLeafById(openedFile.id);
        if (leaf && leaf.parent === app.workspace.getLeaf().parent) {
          app.workspace.setActiveLeaf(leaf, { focus: true });
          return true;
        }
      }
    }
  } else {
    const leaves = getAllWorkspaceLeaves(app);
    for (const leaf of leaves) {
      const view = leaf.view;
      if (view.file && view.file.path === filePath && leaf.parent === app.workspace.getLeaf().parent) {
        app.workspace.setActiveLeaf(leaf, { focus: true });
        return true;
      }
    }
  }
  return false;
}

// src/ui/MarkListModal.ts
var MarkListModal = class extends import_obsidian2.SuggestModal {
  constructor(app, plugin, mode, isHarpoonMode = false) {
    super(app);
    this.plugin = plugin;
    this.mode = mode;
    this.isHarpoonMode = isHarpoonMode;
  }
  getInstructions(modalKeybinds) {
    return [
      { command: modalKeybinds.up.join("/"), purpose: "Up" },
      { command: modalKeybinds.down.join("/"), purpose: "Down" },
      { command: "Symbol", purpose: modeDescription[this.mode] },
      { command: modalKeybinds.select.join("/"), purpose: modeDescription[this.mode] },
      { command: modalKeybinds.delete.join("/"), purpose: "Delete" },
      { command: modalKeybinds.cancel.join("/"), purpose: "Cancel" }
    ];
  }
  getSuggestions(query) {
    return getSortedAndFilteredMarks(this.plugin.marks, this.isHarpoonMode, this.plugin.settings);
  }
  renderSuggestion(mark, el) {
    el.createEl("span", { text: mark.symbol, cls: modalMarkSymbolClass });
    el.createEl("span", { text: mark.filePath, cls: modalMarkFilepathClass });
    if (this.plugin.settings.harpoonRegisterList.contains(mark.symbol)) {
      el.createEl("span", { text: "H", cls: modalMarkHarpoonSign });
    }
    el.addEventListener("click", async (evt) => {
      await this.onChooseSuggestion(mark, evt);
      this.close();
    });
  }
  onOpen() {
    super.onOpen();
    if (this.inputEl) {
      this.inputEl.style.display = "none";
    }
    this.modalEl.addClass("marks-modal");
    const modalKeybinds = prepareKeybinds(import_obsidian2.Platform.isMacOS, this.plugin.settings);
    this.setInstructions(this.getInstructions(modalKeybinds));
    this._keyHandler = this.getModalKeyHandler(modalKeybinds);
    window.addEventListener("keydown", this._keyHandler, true);
  }
  onClose() {
    const instructions = this.modalEl.querySelector("." + modalInstructionElClass);
    if (instructions)
      instructions.remove();
    if (this._keyHandler) {
      window.removeEventListener("keydown", this._keyHandler, true);
      this._keyHandler = void 0;
    }
    super.onClose();
  }
  getModalKeyHandler(keybinds) {
    return async (evt) => {
      const availableRegisters = new Set((!this.isHarpoonMode ? this.plugin.settings.registerList : this.plugin.settings.harpoonRegisterList).split(""));
      const chooser = this.chooser;
      if (keybinds.up.some((kb) => matchKeybind(evt, kb))) {
        evt.preventDefault();
        this.moveSelection(-1);
      } else if (keybinds.down.some((kb) => matchKeybind(evt, kb))) {
        evt.preventDefault();
        this.moveSelection(1);
      } else if (keybinds.delete.some((kb) => matchKeybind(evt, kb))) {
        evt.preventDefault();
        const prevIdx = chooser.selectedItem;
        const selected = chooser.values[prevIdx];
        if (selected) {
          await this.deleteMark(selected);
          chooser.values = getSortedAndFilteredMarks(this.plugin.marks, this.isHarpoonMode, this.plugin.settings);
          chooser.setSuggestions(chooser.values);
          let newIdx = prevIdx;
          if (newIdx >= chooser.values.length) {
            newIdx = chooser.values.length - 1;
          }
          chooser.setSelectedItem(Math.max(0, newIdx), false);
        }
      } else if (keybinds.select.some((kb) => matchKeybind(evt, kb))) {
        evt.preventDefault();
        const ind = chooser.selectedItem;
        const selected = chooser.values[ind];
        if (selected) {
          this.onChooseSuggestion(selected, evt);
          this.close();
        }
      } else if (keybinds.cancel.some((kb) => matchKeybind(evt, kb))) {
        evt.preventDefault();
        this.close();
      } else if (availableRegisters.has(evt.key)) {
        let mark = getMarkBySymbol(this.plugin.marks, evt.key);
        if (this.mode === "set") {
          if (mark == null) {
            const file = this.app.workspace.getActiveFile();
            if (!file) {
              new import_obsidian2.Notice("No active file to mark.");
              this.close();
              return;
            }
            mark = { symbol: evt.key, filePath: file.path };
          }
          evt.preventDefault();
          await this.onChooseSuggestion(mark, evt);
          this.close();
        } else if (this.mode === "goto" && mark) {
          evt.preventDefault();
          await this.onChooseSuggestion(mark, evt);
          this.close();
        } else if (this.mode === "delete" && mark) {
          evt.preventDefault();
          await this.onChooseSuggestion(mark, evt);
          this.close();
        }
      }
    };
  }
  async onChooseSuggestion(mark, evt) {
    if (this.mode === "set") {
      this.setNewOrOverwriteMark(mark);
    } else if (this.mode === "goto") {
      this.goToMark(mark);
    } else if (this.mode === "delete") {
      this.deleteMark(mark);
    }
  }
  moveSelection(delta) {
    const chooser = this.chooser;
    if (!chooser)
      return;
    let idx = chooser.selectedItem;
    if (typeof idx !== "number")
      idx = 0;
    const max = chooser.values.length;
    let next = idx + delta;
    if (next < 0)
      next = max - 1;
    if (next >= max)
      next = 0;
    chooser.setSelectedItem(next, 0);
  }
  async setNewOrOverwriteMark(mark) {
    const file = this.app.workspace.getActiveFile();
    if (!file) {
      new import_obsidian2.Notice("No active file to mark.");
      return;
    }
    const marks = setNewOrOverwriteMark(this.plugin.marks, mark, file.path);
    await this.plugin.saveMarks(marks);
    new import_obsidian2.Notice(`Set mark '${mark.symbol}' to ${file.name}`);
  }
  goToMark(mark) {
    const success = navigateToOpenedFileByPath(mark.filePath, this.plugin.settings.experimentalGoto, this.app);
    if (!success) {
      openNewFile(mark.filePath, this.plugin.settings.openMarkInNewTab, this.app);
    }
  }
  async deleteMark(mark) {
    const cMark = { ...mark };
    const filteredMarks = this.plugin.marks.filter((m) => m.symbol !== cMark.symbol);
    await this.plugin.saveMarks(filteredMarks);
    if (this.plugin.settings.harpoonRegisterGapRemoval) {
      this.removeGapsForHarpoonMarks();
    }
    new import_obsidian2.Notice(`Deleted mark '${cMark.symbol}'`);
  }
  addFileToHarpoon() {
    var _a;
    const harpoonRegisters = this.plugin.settings.harpoonRegisterList.split("");
    const reg = findFirstUnusedRegister(this.plugin.marks, harpoonRegisters);
    if (!reg) {
      new import_obsidian2.Notice("Harpoon registers are full, cannot add more marks.");
    } else {
      this.setNewOrOverwriteMark({ symbol: reg, filePath: ((_a = this.app.workspace.getActiveFile()) == null ? void 0 : _a.path) || "" });
    }
  }
  async removeGapsForHarpoonMarks() {
    const harpoonRegisters = this.plugin.settings.harpoonRegisterList.split("");
    const marks = removeGapsForHarpoonMarks(this.plugin.marks, harpoonRegisters);
    await this.plugin.saveMarks(marks);
  }
};

// src/commands.ts
async function setGlobalMark(plugin) {
  new MarkListModal(plugin.app, plugin, "set").open();
}
async function goToGlobalMark(plugin) {
  new MarkListModal(plugin.app, plugin, "goto").open();
}
async function deleteGlobalMark(plugin) {
  new MarkListModal(plugin.app, plugin, "delete").open();
}
async function addFileToHarpoon(plugin) {
  new MarkListModal(plugin.app, plugin, "goto").addFileToHarpoon();
}
async function goToHarpoonMark(plugin) {
  new MarkListModal(plugin.app, plugin, "goto", true).open();
}

// src/ui/SettingsTab.ts
var import_obsidian3 = require("obsidian");
var SettingsTab = class extends import_obsidian3.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    const ds = defaultSettings;
    new import_obsidian3.Setting(containerEl).setName("Open mark in new tab").setDesc('Open a file in the new tab when using "go to" command. If disabled, it will open the file in the current tab.').addToggle(
      (toggle) => {
        var _a;
        return toggle.setValue((_a = this.plugin.settings.openMarkInNewTab) != null ? _a : ds.openMarkInNewTab).onChange(async (value) => {
          this.plugin.settings.openMarkInNewTab = value;
          await this.plugin.saveSettings();
        });
      }
    );
    new import_obsidian3.Setting(containerEl).setName("No duplication of opened files when using Go to commands (experimental)").setDesc("Prevents duplicate tabs when switching to already opened files using the mark list after restarting Obsidian. (Experimental: may not work in future Obsidian versions.)").addToggle(
      (toggle) => {
        var _a;
        return toggle.setValue((_a = this.plugin.settings.experimentalGoto) != null ? _a : ds.experimentalGoto).onChange(async (value) => {
          this.plugin.settings.experimentalGoto = value;
          await this.plugin.saveSettings();
        });
      }
    );
    new import_obsidian3.Setting(containerEl).setName("General registers").setHeading();
    this.createRegisterListSetting(containerEl, "Register list", ds.registerList, "Key symbols to be used as registers. Only include symbols that you can input with a single keystroke.", "registerList").addExtraButton((btn) => {
      btn.setIcon("refresh-ccw").setTooltip("Reset to default register list").onClick(
        async () => {
          this.plugin.settings.registerList = ds.registerList;
          await this.plugin.saveSettings();
          this.display();
        }
      );
    });
    new import_obsidian3.Setting(containerEl).setName("Sort all marks by register list").setDesc("Sort marks by the order of the key symbols in the register list. If disabled, marks will be sorted alphabetically according to the current locale.").addToggle(
      (toggle) => {
        var _a;
        return toggle.setValue((_a = this.plugin.settings.registerSortByList) != null ? _a : ds.registerSortByList).onChange(async (value) => {
          this.plugin.settings.registerSortByList = value;
          await this.plugin.saveSettings();
        });
      }
    );
    new import_obsidian3.Setting(containerEl).setName("Harpoon registers").setHeading();
    this.createRegisterListSetting(containerEl, "Harpoon register list", ds.harpoonRegisterList, "Key symbols to be used as Harpoon registers. Only include symbols that you can input with a single keystroke.", "harpoonRegisterList").addExtraButton((btn) => {
      btn.setIcon("refresh-ccw").setTooltip("Reset to default Harpoon register list").onClick(
        async () => {
          this.plugin.settings.harpoonRegisterList = ds.harpoonRegisterList;
          await this.plugin.saveSettings();
          this.display();
        }
      );
    });
    new import_obsidian3.Setting(containerEl).setName("Sort Harpoon marks by Harpoon register list").setDesc("Sort Harpoon marks by the order of the key symbols in the Harpoon register list. If disabled, marks will be sorted alphabetically according to the current locale.").addToggle(
      (toggle) => {
        var _a;
        return toggle.setValue((_a = this.plugin.settings.harpoonRegisterSortByList) != null ? _a : ds.harpoonRegisterSortByList).onChange(async (value) => {
          this.plugin.settings.harpoonRegisterSortByList = value;
          await this.plugin.saveSettings();
        });
      }
    );
    new import_obsidian3.Setting(containerEl).setName("Remove gaps inbetween Harpoon marks").setDesc("Harpoon marks will be shifted to the left for every gap (register with no mark) based on the order of the Harpoon register list.").addToggle(
      (toggle) => {
        var _a;
        return toggle.setValue((_a = this.plugin.settings.harpoonRegisterGapRemoval) != null ? _a : ds.harpoonRegisterGapRemoval).onChange(async (value) => {
          this.plugin.settings.harpoonRegisterGapRemoval = value;
          await this.plugin.saveSettings();
        });
      }
    );
    containerEl.createEl("h4", { text: "List navigation shortcuts" });
    this.createShortcutSetting(containerEl, "Up", ds.modalListUp, "Shortcut for moving up in the list", "modalListUp");
    this.createShortcutSetting(containerEl, "Down", ds.modalListDown, "Shortcut for moving down in the list", "modalListDown");
    this.createShortcutSetting(containerEl, "Select", ds.modalListSelect, "Shortcut for selecting a mark", "modalListSelect");
    this.createShortcutSetting(containerEl, "Cancel", ds.modalListCancel, "Shortcut for cancelling the modal", "modalListCancel");
    this.createShortcutSetting(containerEl, "Delete", ds.modalListDelete, "Shortcut for deleting a mark", "modalListDelete");
  }
  // use only for string values from Settings type
  createShortcutSetting(containerEl, name, defaultValue, desc, key) {
    new import_obsidian3.Setting(containerEl).setName(name).setDesc(desc).addText((text) => {
      var _a;
      return text.setValue(String((_a = this.plugin.settings[key]) != null ? _a : defaultValue)).onChange(async (value) => {
        this.plugin.settings[key] = value;
        await this.plugin.saveSettings();
      });
    });
  }
  createRegisterListSetting(containerEl, name, defaultValue, desc, key) {
    return new import_obsidian3.Setting(containerEl).setName(name).setDesc(desc).addText((text) => {
      var _a;
      return text.setValue(String((_a = this.plugin.settings[key]) != null ? _a : defaultValue)).onChange(async (value) => {
        this.plugin.settings[key] = value;
        await this.plugin.saveSettings();
      });
    });
  }
};

// src/utils/storage.ts
var import_obsidian4 = require("obsidian");
async function loadSettings(plugin) {
  var _a;
  return ((_a = await plugin.loadData()) == null ? void 0 : _a.settings) || defaultSettings;
}
async function saveSettings(plugin, settings) {
  const data = await plugin.loadData() || {};
  data.settings = settings;
  await plugin.saveData(data);
}
async function loadMarks(plugin) {
  var _a;
  return ((_a = await plugin.loadData()) == null ? void 0 : _a.marks) || [];
}
async function saveMarks(plugin, marks) {
  const data = await plugin.loadData() || {};
  data.marks = marks;
  await plugin.saveData(data);
}
async function JSONschemaCheck(plugin) {
  const data = await plugin.loadData() || { schemaVersion: JSONschemaVersion };
  if (data.schemaVersion && data.schemaVersion === JSONschemaVersion) {
    return;
  }
  new import_obsidian4.Notice(plugin.manifest.name + ": Faulty data. Check developer tools for more info.");
  console.error(plugin.manifest.id + ": The data loaded is not in correct format. The plugin may not work properly. This usually happens after plugin update that changes the JSON schema. ");
}

// src/main.ts
var TetherMarksPlugin = class extends import_obsidian5.Plugin {
  constructor() {
    super(...arguments);
    this.marks = [];
  }
  async onload() {
    await JSONschemaCheck(this);
    this.settings = await loadSettings(this);
    this.marks = await loadMarks(this);
    this.addCommand({
      id: "set-mark",
      name: "Set mark",
      callback: () => setGlobalMark(this)
    });
    this.addCommand({
      id: "go-to-mark",
      name: "Go to mark",
      callback: () => goToGlobalMark(this)
    });
    this.addCommand({
      id: "delete-mark",
      name: "Delete mark",
      callback: () => deleteGlobalMark(this)
    });
    this.addCommand({
      id: "add-file-to-harpoon",
      name: "Add file to Harpoon",
      callback: () => addFileToHarpoon(this)
    });
    this.addCommand({
      id: "go-to-harpoon-mark",
      name: "Go to Harpoon mark",
      callback: () => goToHarpoonMark(this)
    });
    this.addSettingTab(new SettingsTab(this.app, this));
    console.log("loading " + this.manifest.id);
  }
  async saveSettings() {
    await saveSettings(this, this.settings);
  }
  async saveMarks(marks) {
    this.marks = marks;
    await saveMarks(this, marks);
  }
  onunload() {
    console.log("unloading " + this.manifest.id);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3VpL01hcmtMaXN0TW9kYWwudHMiLCAic3JjL3V0aWxzL2RlZmF1bHRWYWx1ZXMudHMiLCAic3JjL3V0aWxzL21hcmtzLnRzIiwgInNyYy91dGlscy9rZXliaW5kcy50cyIsICJzcmMvdXRpbHMvb2JzaWRpYW5VdGlscy50cyIsICJzcmMvY29tbWFuZHMudHMiLCAic3JjL3VpL1NldHRpbmdzVGFiLnRzIiwgInNyYy91dGlscy9zdG9yYWdlLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBQbHVnaW4gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBzZXRHbG9iYWxNYXJrLCBnb1RvR2xvYmFsTWFyaywgZ29Ub0hhcnBvb25NYXJrLCBhZGRGaWxlVG9IYXJwb29uLCBkZWxldGVHbG9iYWxNYXJrIH0gZnJvbSAnLi9jb21tYW5kcyc7XG5pbXBvcnQgeyBTZXR0aW5nc1RhYiB9IGZyb20gJy4vdWkvU2V0dGluZ3NUYWInO1xuaW1wb3J0IHsgbG9hZFNldHRpbmdzLCBzYXZlU2V0dGluZ3MsIGxvYWRNYXJrcywgc2F2ZU1hcmtzLCBKU09Oc2NoZW1hQ2hlY2sgfSBmcm9tICcuL3V0aWxzL3N0b3JhZ2UnO1xuaW1wb3J0IHsgU2V0dGluZ3MsIE1hcmsgfSBmcm9tICcuL3R5cGVzL2luZGV4JztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGV0aGVyTWFya3NQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuICAgIHNldHRpbmdzITogU2V0dGluZ3M7XG4gICAgbWFya3M6IE1hcmtbXSA9IFtdO1xuXG4gICAgYXN5bmMgb25sb2FkKCkge1xuICAgICAgICBhd2FpdCBKU09Oc2NoZW1hQ2hlY2sodGhpcyk7XG5cbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IGF3YWl0IGxvYWRTZXR0aW5ncyh0aGlzKTtcbiAgICAgICAgdGhpcy5tYXJrcyA9IGF3YWl0IGxvYWRNYXJrcyh0aGlzKTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdzZXQtbWFyaycsXG4gICAgICAgICAgICBuYW1lOiAnU2V0IG1hcmsnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHNldEdsb2JhbE1hcmsodGhpcyksXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ2dvLXRvLW1hcmsnLFxuICAgICAgICAgICAgbmFtZTogJ0dvIHRvIG1hcmsnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IGdvVG9HbG9iYWxNYXJrKHRoaXMpLFxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdkZWxldGUtbWFyaycsXG4gICAgICAgICAgICBuYW1lOiAnRGVsZXRlIG1hcmsnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IGRlbGV0ZUdsb2JhbE1hcmsodGhpcyksXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ2FkZC1maWxlLXRvLWhhcnBvb24nLFxuICAgICAgICAgICAgbmFtZTogJ0FkZCBmaWxlIHRvIEhhcnBvb24nLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IGFkZEZpbGVUb0hhcnBvb24odGhpcyksXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ2dvLXRvLWhhcnBvb24tbWFyaycsXG4gICAgICAgICAgICBuYW1lOiAnR28gdG8gSGFycG9vbiBtYXJrJyxcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiBnb1RvSGFycG9vbk1hcmsodGhpcyksXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgU2V0dGluZ3NUYWIodGhpcy5hcHAsIHRoaXMpKTtcblxuICAgICAgICBjb25zb2xlLmxvZygnbG9hZGluZyAnICsgdGhpcy5tYW5pZmVzdC5pZCk7XG4gICAgfVxuXG4gICAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgICAgICBhd2FpdCBzYXZlU2V0dGluZ3ModGhpcywgdGhpcy5zZXR0aW5ncyk7XG4gICAgfVxuXG4gICAgYXN5bmMgc2F2ZU1hcmtzKG1hcmtzOiBNYXJrW10pIHtcbiAgICAgICAgdGhpcy5tYXJrcyA9IG1hcmtzO1xuICAgICAgICBhd2FpdCBzYXZlTWFya3ModGhpcywgbWFya3MpO1xuICAgIH1cblxuICAgIG9udW5sb2FkKCkge1xuICAgICAgICBjb25zb2xlLmxvZygndW5sb2FkaW5nICcgKyB0aGlzLm1hbmlmZXN0LmlkKTtcbiAgICB9XG59IiwgImltcG9ydCB7IEFwcCwgTm90aWNlLCBTdWdnZXN0TW9kYWwsIFBsYXRmb3JtLCBJbnN0cnVjdGlvbiB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBUZXRoZXJNYXJrc1BsdWdpbiBmcm9tICcuLi9tYWluJztcbmltcG9ydCB7IE1vZGFsS2V5YmluZHMsIE1hcmsgfSBmcm9tICcuLi90eXBlcy9pbmRleCc7XG5pbXBvcnQgeyBtb2RhbEluc3RydWN0aW9uRWxDbGFzcywgbW9kYWxNYXJrRmlsZXBhdGhDbGFzcywgbW9kYWxNYXJrU3ltYm9sQ2xhc3MsIG1vZGFsUGxhY2Vob2xkZXJNZXNzYWdlcywgbW9kYWxNYXJrSGFycG9vblNpZ24sIG1vZGVEZXNjcmlwdGlvbiB9IGZyb20gJy4uL3V0aWxzL2RlZmF1bHRWYWx1ZXMnO1xuaW1wb3J0IHsgTW9kZSB9IGZyb20gXCIuLi90eXBlc1wiO1xuaW1wb3J0IHsgZmluZEZpcnN0VW51c2VkUmVnaXN0ZXIsIGdldE1hcmtCeVN5bWJvbCwgZ2V0U29ydGVkQW5kRmlsdGVyZWRNYXJrcywgcmVtb3ZlR2Fwc0ZvckhhcnBvb25NYXJrcywgc2V0TmV3T3JPdmVyd3JpdGVNYXJrIH0gZnJvbSAnLi4vdXRpbHMvbWFya3MnO1xuaW1wb3J0IHsgbWF0Y2hLZXliaW5kLCBwcmVwYXJlS2V5YmluZHMgfSBmcm9tICcuLi91dGlscy9rZXliaW5kcyc7XG5pbXBvcnQgeyBuYXZpZ2F0ZVRvT3BlbmVkRmlsZUJ5UGF0aCwgb3Blbk5ld0ZpbGUgYXMgb3Blbk5ld0ZpbGVCeVBhdGggfSBmcm9tICcuLi91dGlscy9vYnNpZGlhblV0aWxzJztcblxuXG5leHBvcnQgY2xhc3MgTWFya0xpc3RNb2RhbCBleHRlbmRzIFN1Z2dlc3RNb2RhbDxNYXJrPiB7XG4gICAgcGx1Z2luOiBUZXRoZXJNYXJrc1BsdWdpbjtcbiAgICBtb2RlOiBNb2RlO1xuICAgIHByaXZhdGUgX2tleUhhbmRsZXI/OiAoZXZ0OiBLZXlib2FyZEV2ZW50KSA9PiB2b2lkO1xuICAgIGlzSGFycG9vbk1vZGU6IGJvb2xlYW47XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBUZXRoZXJNYXJrc1BsdWdpbiwgbW9kZTogTW9kZSwgaXNIYXJwb29uTW9kZTogYm9vbGVhbiA9IGZhbHNlKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgICAgICB0aGlzLm1vZGUgPSBtb2RlO1xuICAgICAgICAvLyBub3QgdXNlZCwgbm8gaW5wdXQgZmllbGRcbiAgICAgICAgLy8gdGhpcy5zZXRQbGFjZWhvbGRlcihtb2RhbFBsYWNlaG9sZGVyTWVzc2FnZXNbdGhpcy5tb2RlXSk7XG4gICAgICAgIHRoaXMuaXNIYXJwb29uTW9kZSA9IGlzSGFycG9vbk1vZGU7XG4gICAgfVxuXG4gICAgZ2V0SW5zdHJ1Y3Rpb25zKG1vZGFsS2V5YmluZHM6IE1vZGFsS2V5YmluZHMpOiBJbnN0cnVjdGlvbltdIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIHsgY29tbWFuZDogbW9kYWxLZXliaW5kcy51cC5qb2luKFwiL1wiKSwgcHVycG9zZTogJ1VwJyB9LFxuICAgICAgICAgICAgeyBjb21tYW5kOiBtb2RhbEtleWJpbmRzLmRvd24uam9pbihcIi9cIiksIHB1cnBvc2U6ICdEb3duJyB9LFxuICAgICAgICAgICAgeyBjb21tYW5kOiAnU3ltYm9sJywgcHVycG9zZTogbW9kZURlc2NyaXB0aW9uW3RoaXMubW9kZV0gfSxcbiAgICAgICAgICAgIHsgY29tbWFuZDogbW9kYWxLZXliaW5kcy5zZWxlY3Quam9pbihcIi9cIiksIHB1cnBvc2U6IG1vZGVEZXNjcmlwdGlvblt0aGlzLm1vZGVdIH0sXG4gICAgICAgICAgICB7IGNvbW1hbmQ6IG1vZGFsS2V5YmluZHMuZGVsZXRlLmpvaW4oXCIvXCIpLCBwdXJwb3NlOiAnRGVsZXRlJyB9LFxuICAgICAgICAgICAgeyBjb21tYW5kOiBtb2RhbEtleWJpbmRzLmNhbmNlbC5qb2luKFwiL1wiKSwgcHVycG9zZTogJ0NhbmNlbCcgfSxcbiAgICAgICAgXTtcbiAgICB9XG5cbiAgICBnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogTWFya1tdIHtcbiAgICAgICAgLy8gTm8gc2VhcmNoIGlucHV0XG4gICAgICAgIHJldHVybiBnZXRTb3J0ZWRBbmRGaWx0ZXJlZE1hcmtzKHRoaXMucGx1Z2luLm1hcmtzLCB0aGlzLmlzSGFycG9vbk1vZGUsIHRoaXMucGx1Z2luLnNldHRpbmdzKTtcbiAgICB9XG5cbiAgICByZW5kZXJTdWdnZXN0aW9uKG1hcms6IE1hcmssIGVsOiBIVE1MRWxlbWVudCkge1xuICAgICAgICBlbC5jcmVhdGVFbCgnc3BhbicsIHsgdGV4dDogbWFyay5zeW1ib2wsIGNsczogbW9kYWxNYXJrU3ltYm9sQ2xhc3MgfSk7XG4gICAgICAgIGVsLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiBtYXJrLmZpbGVQYXRoLCBjbHM6IG1vZGFsTWFya0ZpbGVwYXRoQ2xhc3MgfSk7XG4gICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5oYXJwb29uUmVnaXN0ZXJMaXN0LmNvbnRhaW5zKG1hcmsuc3ltYm9sKSkge1xuICAgICAgICAgICAgZWwuY3JlYXRlRWwoJ3NwYW4nLCB7IHRleHQ6IFwiSFwiLCBjbHM6IG1vZGFsTWFya0hhcnBvb25TaWduIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKGV2dCkgPT4ge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5vbkNob29zZVN1Z2dlc3Rpb24obWFyaywgZXZ0KTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgb25PcGVuKCkge1xuICAgICAgICBzdXBlci5vbk9wZW4oKTtcbiAgICAgICAgLy8gSGlkZSB0aGUgaW5wdXQgYm94LCBhcyBpdCdzIG5vdCBuZWVkZWRcbiAgICAgICAgaWYgKHRoaXMuaW5wdXRFbCkge1xuICAgICAgICAgICAgdGhpcy5pbnB1dEVsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tb2RhbEVsLmFkZENsYXNzKCdtYXJrcy1tb2RhbCcpO1xuXG4gICAgICAgIGNvbnN0IG1vZGFsS2V5YmluZHMgPSBwcmVwYXJlS2V5YmluZHMoUGxhdGZvcm0uaXNNYWNPUywgdGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuXG4gICAgICAgIHRoaXMuc2V0SW5zdHJ1Y3Rpb25zKHRoaXMuZ2V0SW5zdHJ1Y3Rpb25zKG1vZGFsS2V5YmluZHMpKTtcblxuICAgICAgICB0aGlzLl9rZXlIYW5kbGVyID0gdGhpcy5nZXRNb2RhbEtleUhhbmRsZXIobW9kYWxLZXliaW5kcyk7XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5fa2V5SGFuZGxlciwgdHJ1ZSk7XG4gICAgfVxuXG4gICAgb25DbG9zZSgpIHtcbiAgICAgICAgLy8gUmVtb3ZlIGluc3RydWN0aW9ucyBwYW5lbCBpZiBwcmVzZW50XG4gICAgICAgIGNvbnN0IGluc3RydWN0aW9ucyA9IHRoaXMubW9kYWxFbC5xdWVyeVNlbGVjdG9yKFwiLlwiICsgbW9kYWxJbnN0cnVjdGlvbkVsQ2xhc3MpO1xuICAgICAgICBpZiAoaW5zdHJ1Y3Rpb25zKSBpbnN0cnVjdGlvbnMucmVtb3ZlKCk7XG5cbiAgICAgICAgaWYgKHRoaXMuX2tleUhhbmRsZXIpIHtcbiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5fa2V5SGFuZGxlciwgdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLl9rZXlIYW5kbGVyID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHN1cGVyLm9uQ2xvc2UoKTtcbiAgICB9XG5cbiAgICBnZXRNb2RhbEtleUhhbmRsZXIoa2V5YmluZHM6IE1vZGFsS2V5YmluZHMpIHtcbiAgICAgICAgcmV0dXJuIGFzeW5jIChldnQ6IEtleWJvYXJkRXZlbnQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGF2YWlsYWJsZVJlZ2lzdGVycyA9IG5ldyBTZXQoKCF0aGlzLmlzSGFycG9vbk1vZGUgPyB0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZWdpc3Rlckxpc3QgOiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5oYXJwb29uUmVnaXN0ZXJMaXN0KS5zcGxpdCgnJykpO1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgY29uc3QgY2hvb3NlciA9IHRoaXMuY2hvb3NlcjtcbiAgICAgICAgICAgIGlmIChrZXliaW5kcy51cC5zb21lKGtiID0+IG1hdGNoS2V5YmluZChldnQsIGtiKSkpIHtcbiAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1vdmVTZWxlY3Rpb24oLTEpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChrZXliaW5kcy5kb3duLnNvbWUoa2IgPT4gbWF0Y2hLZXliaW5kKGV2dCwga2IpKSkge1xuICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHRoaXMubW92ZVNlbGVjdGlvbigxKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoa2V5YmluZHMuZGVsZXRlLnNvbWUoa2IgPT4gbWF0Y2hLZXliaW5kKGV2dCwga2IpKSkge1xuICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIC8vIERlbGV0ZSB0aGUgY3VycmVudGx5IHNlbGVjdGVkIG1hcmtcbiAgICAgICAgICAgICAgICBjb25zdCBwcmV2SWR4ID0gY2hvb3Nlci5zZWxlY3RlZEl0ZW07XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWQ6IE1hcmsgPSBjaG9vc2VyLnZhbHVlc1twcmV2SWR4XTtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kZWxldGVNYXJrKHNlbGVjdGVkKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVmcmVzaCB0aGUgbW9kYWwgbGlzdFxuICAgICAgICAgICAgICAgICAgICBjaG9vc2VyLnZhbHVlcyA9IGdldFNvcnRlZEFuZEZpbHRlcmVkTWFya3ModGhpcy5wbHVnaW4ubWFya3MsIHRoaXMuaXNIYXJwb29uTW9kZSwgdGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuICAgICAgICAgICAgICAgICAgICBjaG9vc2VyLnNldFN1Z2dlc3Rpb25zKGNob29zZXIudmFsdWVzKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gUHJlc2VydmUgc2VsZWN0aW9uIGluZGV4XG4gICAgICAgICAgICAgICAgICAgIGxldCBuZXdJZHggPSBwcmV2SWR4O1xuICAgICAgICAgICAgICAgICAgICBpZiAobmV3SWR4ID49IGNob29zZXIudmFsdWVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3SWR4ID0gY2hvb3Nlci52YWx1ZXMubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjaG9vc2VyLnNldFNlbGVjdGVkSXRlbShNYXRoLm1heCgwLCBuZXdJZHgpLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChrZXliaW5kcy5zZWxlY3Quc29tZShrYiA9PiBtYXRjaEtleWJpbmQoZXZ0LCBrYikpKSB7XG4gICAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgbWFya1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZCA9IGNob29zZXIuc2VsZWN0ZWRJdGVtO1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkOiBNYXJrID0gY2hvb3Nlci52YWx1ZXNbaW5kXTtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkNob29zZVN1Z2dlc3Rpb24oc2VsZWN0ZWQsIGV2dCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGtleWJpbmRzLmNhbmNlbC5zb21lKGtiID0+IG1hdGNoS2V5YmluZChldnQsIGtiKSkpIHtcbiAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGF2YWlsYWJsZVJlZ2lzdGVycy5oYXMoZXZ0LmtleSkpIHtcbiAgICAgICAgICAgICAgICBsZXQgbWFyayA9IGdldE1hcmtCeVN5bWJvbCh0aGlzLnBsdWdpbi5tYXJrcywgZXZ0LmtleSk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubW9kZSA9PT0gJ3NldCcpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmsgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlIGEgbmV3IG1hcmsgZm9yIHRoaXMga2V5IHN5bWJvbFxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdObyBhY3RpdmUgZmlsZSB0byBtYXJrLicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXJrID0geyBzeW1ib2w6IGV2dC5rZXksIGZpbGVQYXRoOiBmaWxlLnBhdGggfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5vbkNob29zZVN1Z2dlc3Rpb24obWFyaywgZXZ0KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5tb2RlID09PSAnZ290bycgJiYgbWFyaykge1xuICAgICAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5vbkNob29zZVN1Z2dlc3Rpb24obWFyaywgZXZ0KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLm1vZGUgPT09ICdkZWxldGUnICYmIG1hcmspIHtcbiAgICAgICAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMub25DaG9vc2VTdWdnZXN0aW9uKG1hcmssIGV2dCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIFJlZnJlc2ggdGhlIG1vZGFsIGxpc3RcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBhc3luYyBvbkNob29zZVN1Z2dlc3Rpb24obWFyazogTWFyaywgZXZ0OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICBpZiAodGhpcy5tb2RlID09PSAnc2V0Jykge1xuICAgICAgICAgICAgdGhpcy5zZXROZXdPck92ZXJ3cml0ZU1hcmsobWFyayk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5tb2RlID09PSAnZ290bycpIHtcbiAgICAgICAgICAgIHRoaXMuZ29Ub01hcmsobWFyayk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5tb2RlID09PSAnZGVsZXRlJykge1xuICAgICAgICAgICAgdGhpcy5kZWxldGVNYXJrKG1hcmspO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgbW92ZVNlbGVjdGlvbihkZWx0YTogbnVtYmVyKSB7XG4gICAgICAgIC8vIE1vdmUgdGhlIHNlbGVjdGlvbiB1cCBvciBkb3duIGJ5IGRlbHRhXG4gICAgICAgIC8vIHRoaXMuY2hvb3NlciBpcyBTdWdnZXN0TW9kYWwncyBpbnRlcm5hbCBjaG9vc2VyXG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgY29uc3QgY2hvb3NlciA9IHRoaXMuY2hvb3NlcjtcbiAgICAgICAgaWYgKCFjaG9vc2VyKSByZXR1cm47XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgbGV0IGlkeCA9IGNob29zZXIuc2VsZWN0ZWRJdGVtO1xuICAgICAgICBpZiAodHlwZW9mIGlkeCAhPT0gJ251bWJlcicpIGlkeCA9IDA7XG4gICAgICAgIGNvbnN0IG1heCA9IGNob29zZXIudmFsdWVzLmxlbmd0aDtcbiAgICAgICAgbGV0IG5leHQgPSBpZHggKyBkZWx0YTtcbiAgICAgICAgaWYgKG5leHQgPCAwKSBuZXh0ID0gbWF4IC0gMTtcbiAgICAgICAgaWYgKG5leHQgPj0gbWF4KSBuZXh0ID0gMDtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBjaG9vc2VyLnNldFNlbGVjdGVkSXRlbShuZXh0LCAwIGFzIEtleWJvYXJkRXZlbnQpO1xuICAgIH1cblxuICAgIGFzeW5jIHNldE5ld09yT3ZlcndyaXRlTWFyayhtYXJrOiBNYXJrKSB7XG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBpZiAoIWZpbGUpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ05vIGFjdGl2ZSBmaWxlIHRvIG1hcmsuJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbWFya3MgPSBzZXROZXdPck92ZXJ3cml0ZU1hcmsodGhpcy5wbHVnaW4ubWFya3MsIG1hcmssIGZpbGUucGF0aCk7XG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVNYXJrcyhtYXJrcyk7XG4gICAgICAgIG5ldyBOb3RpY2UoYFNldCBtYXJrICcke21hcmsuc3ltYm9sfScgdG8gJHtmaWxlLm5hbWV9YCk7XG4gICAgfVxuXG4gICAgZ29Ub01hcmsobWFyazogTWFyaykge1xuICAgICAgICBjb25zdCBzdWNjZXNzID0gbmF2aWdhdGVUb09wZW5lZEZpbGVCeVBhdGgobWFyay5maWxlUGF0aCwgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhwZXJpbWVudGFsR290bywgdGhpcy5hcHApO1xuICAgICAgICAvLyBJZiBmaWxlIG5vdCBvcGVuLCB0aGVuIG9wZW4gaXQgaW4gdGhlIHByZWZlcnJlZCB0YWJcbiAgICAgICAgaWYgKCFzdWNjZXNzKSB7XG4gICAgICAgICAgICBvcGVuTmV3RmlsZUJ5UGF0aChtYXJrLmZpbGVQYXRoLCB0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcGVuTWFya0luTmV3VGFiLCB0aGlzLmFwcCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIGRlbGV0ZU1hcmsobWFyazogTWFyaykge1xuICAgICAgICBjb25zdCBjTWFyayA9IHsgLi4ubWFyayB9O1xuICAgICAgICBjb25zdCBmaWx0ZXJlZE1hcmtzID0gdGhpcy5wbHVnaW4ubWFya3MuZmlsdGVyKG0gPT4gbS5zeW1ib2wgIT09IGNNYXJrLnN5bWJvbCk7XG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVNYXJrcyhmaWx0ZXJlZE1hcmtzKTtcblxuICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuaGFycG9vblJlZ2lzdGVyR2FwUmVtb3ZhbCkge1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVHYXBzRm9ySGFycG9vbk1hcmtzKCk7XG4gICAgICAgIH1cblxuICAgICAgICBuZXcgTm90aWNlKGBEZWxldGVkIG1hcmsgJyR7Y01hcmsuc3ltYm9sfSdgKTtcbiAgICB9O1xuXG4gICAgYWRkRmlsZVRvSGFycG9vbigpIHtcbiAgICAgICAgLy8gQWRkIHRoZSBzZWxlY3RlZCBtYXJrIHRvIHRoZSBIYXJwb29uIGxpc3RcbiAgICAgICAgY29uc3QgaGFycG9vblJlZ2lzdGVycyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmhhcnBvb25SZWdpc3Rlckxpc3Quc3BsaXQoJycpO1xuICAgICAgICBjb25zdCByZWcgPSBmaW5kRmlyc3RVbnVzZWRSZWdpc3Rlcih0aGlzLnBsdWdpbi5tYXJrcywgaGFycG9vblJlZ2lzdGVycyk7XG5cbiAgICAgICAgaWYgKCFyZWcpIHtcbiAgICAgICAgICAgIC8vIElmIGFsbCByZWdpc3RlcnMgYXJlIHVzZWQsIHNob3cgYSBub3RpY2VcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ0hhcnBvb24gcmVnaXN0ZXJzIGFyZSBmdWxsLCBjYW5ub3QgYWRkIG1vcmUgbWFya3MuJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNldE5ld09yT3ZlcndyaXRlTWFyayh7IHN5bWJvbDogcmVnLCBmaWxlUGF0aDogdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKT8ucGF0aCB8fCAnJyB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIHJlbW92ZUdhcHNGb3JIYXJwb29uTWFya3MoKSB7XG4gICAgICAgIGNvbnN0IGhhcnBvb25SZWdpc3RlcnMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5oYXJwb29uUmVnaXN0ZXJMaXN0LnNwbGl0KCcnKTtcbiAgICAgICAgY29uc3QgbWFya3MgPSByZW1vdmVHYXBzRm9ySGFycG9vbk1hcmtzKHRoaXMucGx1Z2luLm1hcmtzLCBoYXJwb29uUmVnaXN0ZXJzKTtcbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZU1hcmtzKG1hcmtzKTtcbiAgICB9XG5cbn0iLCAiaW1wb3J0IHsgTW9kYWxLZXliaW5kcywgU2V0dGluZ3MsIE1vZGUgfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuXHJcbmV4cG9ydCBjb25zdCBtb2RhbERlZmF1bHRLZXliaW5kczogTW9kYWxLZXliaW5kcyA9IHtcclxuICAgIHVwOiBbJ2N0cmwraycsICdjdHJsK3AnXSBhcyBzdHJpbmdbXSxcclxuICAgIGRvd246IFsnY3RybCtqJywgJ2N0cmwrbiddIGFzIHN0cmluZ1tdLFxyXG4gICAgZGVsZXRlOiBbJ2N0cmwrZCddIGFzIHN0cmluZ1tdLFxyXG4gICAgc2VsZWN0OiBbJ0VudGVyJ10gYXMgc3RyaW5nW10sXHJcbiAgICBjYW5jZWw6IFsnRXNjYXBlJ10gYXMgc3RyaW5nW10sXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBtb2RhbERlZmF1bHRLZXliaW5kc01hYzogTW9kYWxLZXliaW5kcyA9IHtcclxuICAgIHVwOiBbJ2NtZCtrJywgJ2NtZCtwJ10gYXMgc3RyaW5nW10sXHJcbiAgICBkb3duOiBbJ2NtZCtqJywgJ2NtZCtuJ10gYXMgc3RyaW5nW10sXHJcbiAgICBkZWxldGU6IFsnY21kK2QnXSBhcyBzdHJpbmdbXSxcclxuICAgIHNlbGVjdDogWydFbnRlciddIGFzIHN0cmluZ1tdLFxyXG4gICAgY2FuY2VsOiBbJ0VzY2FwZSddIGFzIHN0cmluZ1tdLFxyXG59XHJcblxyXG4vLyBUaGlzIGlzIG5vdCB1c2VkIGZvciBub3dcclxuZXhwb3J0IGNvbnN0IG1vZGFsUGxhY2Vob2xkZXJNZXNzYWdlcyA6IFJlY29yZDxNb2RlLCBzdHJpbmc+ID0ge1xyXG4gICAgc2V0OiAnU2VsZWN0IGEgbWFyayB0byBzZXQnLFxyXG4gICAgZ290bzogJ1NlbGVjdCBhIG1hcmsgdG8gZ28gdG8nLFxyXG4gICAgZGVsZXRlOiAnU2VsZWN0IGEgbWFyayB0byBkZWxldGUnLFxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGRlZmF1bHRTZXR0aW5nczogU2V0dGluZ3MgPSB7XHJcbiAgICAvLyBoaWRlTWFya0xpc3REdXJpbmdJbnB1dDogZmFsc2UsXHJcbiAgICBtb2RhbExpc3RVcDogJycsXHJcbiAgICBtb2RhbExpc3REb3duOiAnJyxcclxuICAgIG1vZGFsTGlzdFNlbGVjdDogJycsXHJcbiAgICBtb2RhbExpc3REZWxldGU6ICcnLFxyXG4gICAgbW9kYWxMaXN0Q2FuY2VsOiAnJyxcclxuICAgIG9wZW5NYXJrSW5OZXdUYWI6IGZhbHNlLCAvLyBJZiB0cnVlLCBvcGVuIG1hcmsgaW4gbmV3IHRhYiwgZWxzZSBpbiBjdXJyZW50IHRhYlxyXG4gICAgcmVnaXN0ZXJMaXN0OiAnYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonLFxyXG4gICAgcmVnaXN0ZXJTb3J0QnlMaXN0OiB0cnVlLFxyXG4gICAgaGFycG9vblJlZ2lzdGVyTGlzdDogJ3F3ZXInLFxyXG4gICAgaGFycG9vblJlZ2lzdGVyU29ydEJ5TGlzdDogdHJ1ZSxcclxuICAgIGhhcnBvb25SZWdpc3RlckdhcFJlbW92YWw6IHRydWUsXHJcbiAgICBleHBlcmltZW50YWxHb3RvOiBmYWxzZSxcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBtb2RhbEluc3RydWN0aW9uRWxDbGFzcyA9ICdtb2RhbC1pbnN0cnVjdGlvbi1lbCc7XHJcbmV4cG9ydCBjb25zdCBtb2RhbE1hcmtTeW1ib2xDbGFzcyA9ICdtYXJrLXN5bWJvbCc7XHJcbmV4cG9ydCBjb25zdCBtb2RhbE1hcmtGaWxlcGF0aENsYXNzID0gJ21hcmstZmlsZS1wYXRoJztcclxuZXhwb3J0IGNvbnN0IG1vZGFsTWFya0hhcnBvb25TaWduID0gJ2hhcnBvb24tc2lnbic7XHJcblxyXG5leHBvcnQgY29uc3QgSlNPTnNjaGVtYVZlcnNpb24gPSAxO1xyXG5cclxuZXhwb3J0IGNvbnN0IG1vZGVEZXNjcmlwdGlvbiA6IFJlY29yZDxNb2RlLCBzdHJpbmc+ID0ge1xyXG4gICAgJ3NldCc6ICdTZXQgbWFyaycsXHJcbiAgICAnZ290byc6ICdHbyB0byBtYXJrJyxcclxuICAgICdkZWxldGUnOiAnRGVsZXRlIG1hcmsnXHJcbn0iLCAiaW1wb3J0IHsgU2V0dGluZ3MgfSBmcm9tICcuLi90eXBlcy9pbmRleCc7XHJcbmltcG9ydCB7IE1hcmsgfSBmcm9tICcuLi90eXBlcy9pbmRleCc7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZmluZEZpcnN0VW51c2VkUmVnaXN0ZXIobWFya3M6IE1hcmtbXSwgcmVnaXN0ZXJzOiBzdHJpbmdbXSk6IHN0cmluZyB8IG51bGwge1xyXG4gICAgZm9yIChjb25zdCByZWcgb2YgcmVnaXN0ZXJzKSB7XHJcbiAgICAgICAgLy8gaWYgcmVnaXN0ZXIgbm90IHVzZWQgYWxyZWFkeSwgdGhlbiB1c2UgaXRcclxuICAgICAgICAvLyBjb25zb2xlLmxvZygnQ2hlY2tpbmcgcmVnaXN0ZXI6JywgcmVnKTtcclxuICAgICAgICBpZiAoIShtYXJrcy5tYXAobSA9PiBtLnN5bWJvbCkuaW5jbHVkZXMocmVnKSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlZztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbnVsbDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldE1hcmtCeVN5bWJvbChtYXJrczogTWFya1tdLCBzeW1ib2w6IHN0cmluZyk6IE1hcmsgfCB1bmRlZmluZWQge1xyXG4gICAgcmV0dXJuIG1hcmtzLmZpbmQobSA9PiBtLnN5bWJvbCA9PT0gc3ltYm9sKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNvcnRNYXJrc0FscGhhYmV0aWNhbGx5KG1hcmtzOiBNYXJrW10pIHtcclxuICAgIG1hcmtzLnNvcnQoKGEsIGIpID0+IGEuc3ltYm9sLmxvY2FsZUNvbXBhcmUoYi5zeW1ib2wpKVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0U29ydGVkQW5kRmlsdGVyZWRNYXJrcyhtYXJrczogTWFya1tdLCBpc0hhcnBvb25Nb2RlOiBib29sZWFuLCBzZXR0aW5nczogU2V0dGluZ3MpOiBNYXJrW10ge1xyXG4gICAgY29uc3QgYXZhaWxhYmxlUmVnaXN0ZXJzID0gbmV3IFNldCgoIWlzSGFycG9vbk1vZGUgPyBzZXR0aW5ncy5yZWdpc3Rlckxpc3QgOiBzZXR0aW5ncy5oYXJwb29uUmVnaXN0ZXJMaXN0KS5zcGxpdCgnJykpO1xyXG4gICAgY29uc3QgZmlsdGVyZWRNYXJrczogTWFya1tdID0gbWFya3MuZmlsdGVyKGVsID0+IGF2YWlsYWJsZVJlZ2lzdGVycy5oYXMoZWwuc3ltYm9sKSk7XHJcbiAgICBpZiAoIWlzSGFycG9vbk1vZGUgJiYgc2V0dGluZ3MucmVnaXN0ZXJTb3J0QnlMaXN0KSB7XHJcbiAgICAgICAgLy8gU29ydCBtYXJrcyBieSB0aGUgb3JkZXIgb2YgdGhlIGtleSBzeW1ib2xzIGluIHRoZSByZWdpc3RlciBsaXN0XHJcbiAgICAgICAgY29uc3QgcmVnaXN0ZXJMaXN0ID0gc2V0dGluZ3MucmVnaXN0ZXJMaXN0O1xyXG4gICAgICAgIHNvcnRNYXJrc0J5U2V0dGluZ3NSZWdpc3Rlck9yZGVyKGZpbHRlcmVkTWFya3MsIHJlZ2lzdGVyTGlzdCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChpc0hhcnBvb25Nb2RlICYmIHNldHRpbmdzLmhhcnBvb25SZWdpc3RlclNvcnRCeUxpc3QpIHtcclxuICAgICAgICAvLyBTb3J0IG1hcmtzIGJ5IHRoZSBvcmRlciBvZiB0aGUga2V5IHN5bWJvbHMgaW4gdGhlIGhhcnBvb24gcmVnaXN0ZXIgbGlzdFxyXG4gICAgICAgIGNvbnN0IHJlZ2lzdGVyTGlzdCA9IHNldHRpbmdzLmhhcnBvb25SZWdpc3Rlckxpc3Q7XHJcbiAgICAgICAgc29ydE1hcmtzQnlTZXR0aW5nc1JlZ2lzdGVyT3JkZXIoZmlsdGVyZWRNYXJrcywgcmVnaXN0ZXJMaXN0KTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHNvcnRNYXJrc0FscGhhYmV0aWNhbGx5KGZpbHRlcmVkTWFya3MpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZpbHRlcmVkTWFya3M7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzb3J0TWFya3NCeVNldHRpbmdzUmVnaXN0ZXJPcmRlcihtYXJrczogTWFya1tdLCByZWdpc3RlcnM6IHN0cmluZyB8IHN0cmluZ1tdKSB7XHJcbiAgICBjb25zdCByZWdpc3Rlck9yZGVyID0gbmV3IE1hcChbLi4ucmVnaXN0ZXJzXS5tYXAoKHN5bWJvbCwgaW5kZXgpID0+IFtzeW1ib2wsIGluZGV4XSkpO1xyXG4gICAgbWFya3Muc29ydCgoYSwgYikgPT4gKHJlZ2lzdGVyT3JkZXIuZ2V0KGEuc3ltYm9sKSA/PyBJbmZpbml0eSkgLSAocmVnaXN0ZXJPcmRlci5nZXQoYi5zeW1ib2wpID8/IEluZmluaXR5KSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVHYXBzRm9ySGFycG9vbk1hcmtzKG1hcmtzVG9Db3B5OiBNYXJrW10sIGhhcnBvb25SZWdpc3RlcnM6IHN0cmluZ1tdKTogTWFya1tdIHtcclxuICAgIGxldCBtYXJrcyA9IFsuLi5tYXJrc1RvQ29weV07XHJcblxyXG4gICAgbGV0IGxlZnRDdXIgPSAwO1xyXG4gICAgbGV0IHJpZ2h0Q3VyID0gMDtcclxuXHJcbiAgICB3aGlsZSAocmlnaHRDdXIgPCBoYXJwb29uUmVnaXN0ZXJzLmxlbmd0aCkge1xyXG4gICAgICAgIGNvbnN0IG1hcmtFbCA9IG1hcmtzLmZpbmQoZWwgPT4gZWwuc3ltYm9sID09PSBoYXJwb29uUmVnaXN0ZXJzW3JpZ2h0Q3VyXSk7XHJcblxyXG4gICAgICAgIGlmIChtYXJrRWwgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBjb25zdCBzeW1ib2xUb1NldFRvID0gaGFycG9vblJlZ2lzdGVyc1tsZWZ0Q3VyXTtcclxuICAgICAgICAgICAgbGV0IGZpbHRlcmVkTWFya3MgPSBtYXJrcy5maWx0ZXIoZWwgPT4gZWwuc3ltYm9sICE9PSBoYXJwb29uUmVnaXN0ZXJzW2xlZnRDdXJdKTtcclxuICAgICAgICAgICAgZmlsdGVyZWRNYXJrcy5wdXNoKHsgc3ltYm9sOiBzeW1ib2xUb1NldFRvLCBmaWxlUGF0aDogbWFya0VsLmZpbGVQYXRoIH0pXHJcbiAgICAgICAgICAgIG1hcmtzID0gZmlsdGVyZWRNYXJrcztcclxuICAgICAgICAgICAgbGVmdEN1ciArPSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICByaWdodEN1ciArPSAxO1xyXG4gICAgfVxyXG5cclxuICAgIHdoaWxlIChsZWZ0Q3VyIDwgaGFycG9vblJlZ2lzdGVycy5sZW5ndGgpIHtcclxuICAgICAgICBtYXJrcyA9IG1hcmtzLmZpbHRlcihlbCA9PiBlbC5zeW1ib2wgIT09IGhhcnBvb25SZWdpc3RlcnNbbGVmdEN1cl0pO1xyXG4gICAgICAgIGxlZnRDdXIgKz0gMTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbWFya3M7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzZXROZXdPck92ZXJ3cml0ZU1hcmsobWFya3M6IE1hcmtbXSwgc2V0TWFyayA6IE1hcmssIGZpbGVQYXRoIDogc3RyaW5nKSA6IE1hcmtbXXtcclxuICAgIGNvbnN0IG91dE1hcmtzID0gbWFya3MuZmlsdGVyKChtKSA9PiBtLnN5bWJvbCAhPT0gc2V0TWFyay5zeW1ib2wpO1xyXG4gICAgb3V0TWFya3MucHVzaCh7IHN5bWJvbDogc2V0TWFyay5zeW1ib2wsIGZpbGVQYXRoOiBmaWxlUGF0aCB9KTtcclxuICAgIHJldHVybiBvdXRNYXJrcztcclxufSIsICJpbXBvcnQgeyBtb2RhbERlZmF1bHRLZXliaW5kcywgbW9kYWxEZWZhdWx0S2V5YmluZHNNYWMgfSBmcm9tIFwiLi9kZWZhdWx0VmFsdWVzXCI7XHJcbmltcG9ydCB7IE1vZGFsS2V5YmluZHMgfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuaW1wb3J0IHsgU2V0dGluZ3MgfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuXHJcbi8vIFV0aWxpdHkgdG8gcHJlcGFyZSBrZXliaW5kcyBvYmplY3RcclxuZXhwb3J0IGZ1bmN0aW9uIHByZXBhcmVLZXliaW5kcyhpc01hY09TOiBib29sZWFuLCBzZXR0aW5nczogU2V0dGluZ3MpIHtcclxuICAgIGxldCBrZXliaW5kczogTW9kYWxLZXliaW5kcyA9ICghaXNNYWNPUykgPyB7IC4uLm1vZGFsRGVmYXVsdEtleWJpbmRzIH0gOiB7IC4uLm1vZGFsRGVmYXVsdEtleWJpbmRzTWFjIH07XHJcblxyXG4gICAgaWYgKHNldHRpbmdzLm1vZGFsTGlzdFVwKSB7XHJcbiAgICAgICAga2V5YmluZHMudXAgPSBbc2V0dGluZ3MubW9kYWxMaXN0VXBdO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChzZXR0aW5ncy5tb2RhbExpc3REb3duKSB7XHJcbiAgICAgICAga2V5YmluZHMuZG93biA9IFtzZXR0aW5ncy5tb2RhbExpc3REb3duXTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoc2V0dGluZ3MubW9kYWxMaXN0RGVsZXRlKSB7XHJcbiAgICAgICAga2V5YmluZHMuZGVsZXRlID0gW3NldHRpbmdzLm1vZGFsTGlzdERlbGV0ZV07XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHNldHRpbmdzLm1vZGFsTGlzdFNlbGVjdCl7XHJcbiAgICAgICAga2V5YmluZHMuc2VsZWN0ID0gW3NldHRpbmdzLm1vZGFsTGlzdFNlbGVjdF07XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHNldHRpbmdzLm1vZGFsTGlzdENhbmNlbCl7XHJcbiAgICAgICAga2V5YmluZHMuY2FuY2VsID0gW3NldHRpbmdzLm1vZGFsTGlzdENhbmNlbF07XHJcbiAgICB9XHJcbiBcclxuICAgIHJldHVybiBrZXliaW5kcztcclxufVxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBtYXRjaEtleWJpbmQoZXZ0OiBLZXlib2FyZEV2ZW50LCBrZXliaW5kOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgIC8vIFBhcnNlIGtleWJpbmQgc3RyaW5nIGxpa2UgJ2N0cmwrc2hpZnQrcCcsICdjbWQrbicsIGV0Yy5cclxuICAgIGNvbnN0IHBhcnRzID0ga2V5YmluZC5zcGxpdCgnKycpLm1hcChwID0+IHAudHJpbSgpKTtcclxuICAgIGxldCByZXF1aXJlZCA9IHsgY3RybDogZmFsc2UsIHNoaWZ0OiBmYWxzZSwgYWx0OiBmYWxzZSwgbWV0YTogZmFsc2UsIGtleTogJycgfTtcclxuICAgIGZvciAoY29uc3QgcGFydCBvZiBwYXJ0cykge1xyXG4gICAgICAgIGlmIChwYXJ0ID09PSAnY3RybCcpIHJlcXVpcmVkLmN0cmwgPSB0cnVlO1xyXG4gICAgICAgIGVsc2UgaWYgKHBhcnQgPT09ICdzaGlmdCcpIHJlcXVpcmVkLnNoaWZ0ID0gdHJ1ZTtcclxuICAgICAgICBlbHNlIGlmIChwYXJ0ID09PSAnYWx0JykgcmVxdWlyZWQuYWx0ID0gdHJ1ZTtcclxuICAgICAgICBlbHNlIGlmIChwYXJ0ID09PSAnbWV0YScgfHwgcGFydCA9PT0gJ2NtZCcgfHwgcGFydCA9PT0gJ3dpbicpIHJlcXVpcmVkLm1ldGEgPSB0cnVlO1xyXG4gICAgICAgIGVsc2UgcmVxdWlyZWQua2V5ID0gcGFydDtcclxuICAgIH1cclxuICAgIC8vIENoZWNrIG1vZGlmaWVyc1xyXG4gICAgaWYgKGV2dC5jdHJsS2V5ICE9PSByZXF1aXJlZC5jdHJsKSByZXR1cm4gZmFsc2U7XHJcbiAgICBpZiAoZXZ0LnNoaWZ0S2V5ICE9PSByZXF1aXJlZC5zaGlmdCkgcmV0dXJuIGZhbHNlO1xyXG4gICAgaWYgKGV2dC5hbHRLZXkgIT09IHJlcXVpcmVkLmFsdCkgcmV0dXJuIGZhbHNlO1xyXG4gICAgaWYgKGV2dC5tZXRhS2V5ICE9PSByZXF1aXJlZC5tZXRhKSByZXR1cm4gZmFsc2U7XHJcbiAgICAvLyBDaGVjayBrZXkgKGNhc2UtaW5zZW5zaXRpdmUpXHJcbiAgICByZXR1cm4gZXZ0LmtleSA9PT0gcmVxdWlyZWQua2V5O1xyXG59IiwgImltcG9ydCB7IEFwcCwgbm9ybWFsaXplUGF0aCwgTm90aWNlLCBURmlsZSwgV29ya3NwYWNlTGVhZiB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG9wZW5OZXdGaWxlKGZpbGVQYXRoOiBzdHJpbmcsIG9wZW5GaWxlSW5OZXdUYWI6IGJvb2xlYW4sIGFwcDogQXBwKSB7XHJcbiAgICBjb25zdCBmaWxlID0gYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlUGF0aCk7XHJcbiAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcbiAgICAgICAgaWYgKG9wZW5GaWxlSW5OZXdUYWIpIHtcclxuICAgICAgICAgICAgYXBwLndvcmtzcGFjZS5nZXRMZWFmKCd0YWInKS5vcGVuRmlsZShmaWxlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBhcHAud29ya3NwYWNlLmdldExlYWYoKS5vcGVuRmlsZShmaWxlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBuZXcgTm90aWNlKGBGaWxlIG5vdCBmb3VuZCBmb3IgcGF0aCAke2ZpbGVQYXRofS4gVGhlIGZpbGUgbWF5IGhhdmUgYmVlbiBkZWxldGVkLCBtb3ZlZCBvciByZW5hbWVkLmApO1xyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICogRmluZHMgYWxsIG9wZW5lZCBmaWxlcyBpbiB0aGUgbWFpbiBhcmVhIHRocm91Z2ggd29ya3NwYWNlLmdldExheW91dCgpLiBOb3QgQVBJIGNvbXBsaWFudC4gQ2FuIGJyZWFrIGFueXRpbWUuIEdldHMgYWxsIG9wZW5lZCBmaWxlcyByZWdhcmRsZXNzIG9mIHN0YXRlLiBcclxuICogKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEFsbE9wZW5lZEZpbGVzRXhwZXJpbWVudGFsKGFwcDogQXBwKTogYW55IHtcclxuICAgIC8vIEB0cy1pZ25vcmVcclxuICAgIGNvbnN0IHRhYkdyb3VwcyA9IGFwcC53b3Jrc3BhY2UuZ2V0TGF5b3V0KCkubWFpbj8uY2hpbGRyZW47XHJcbiAgICBjb25zdCBvdXQgPSBbXTtcclxuICAgIGZvciAoY29uc3QgZWwgb2YgdGFiR3JvdXBzKSB7XHJcbiAgICAgICAgb3V0LnB1c2goLi4uZWwuY2hpbGRyZW4pXHJcbiAgICB9XHJcbiAgICByZXR1cm4gb3V0O1xyXG59XHJcblxyXG4vKipcclxuICogRmluZHMgYWxsIHdvcmtzcGFjZSBsZWF2ZXMgdGhyb3VnaCB3b3Jrc3BhY2UuaXRlcmF0ZUFsbExlYXZlcy4gQVBJIGNvbXBsaWFudC4gSWdub3JlcyBhbGwgdGhlIG5vbiBpbnN0YW50aWF0ZWQgbGVhdmVzLlxyXG4gKiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0QWxsV29ya3NwYWNlTGVhdmVzKGFwcDogQXBwKTogV29ya3NwYWNlTGVhZltdIHtcclxuICAgIGNvbnN0IGxpc3Q6IFdvcmtzcGFjZUxlYWZbXSA9IFtdXHJcbiAgICBhcHAud29ya3NwYWNlLml0ZXJhdGVBbGxMZWF2ZXMobGVhZiA9PiB7XHJcbiAgICAgICAgbGlzdC5wdXNoKGxlYWYpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIGxpc3Q7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTZXRzIGFjdGl2ZSBhbiBvcGVuZWQgZmlsZSB0aGF0IG1hdGNoZXMgdGhlIGlucHV0IGZpbGUgcGF0aC4gUmVzcGVjdHMgdGFiIGdyb3VwaW5nLiBSZXR1cm5zIHN1Y2Nlc3MgYm9vbC4gIFxyXG4gKiBAcHVibGljXHJcbiAqICovXHJcbmV4cG9ydCBmdW5jdGlvbiBuYXZpZ2F0ZVRvT3BlbmVkRmlsZUJ5UGF0aChmaWxlUGF0aDogc3RyaW5nLCBleHBlcmltZW50YWxHb3RvOiBib29sZWFuLCBhcHA6IEFwcCk6IGJvb2xlYW4ge1xyXG4gICAgaWYgKGV4cGVyaW1lbnRhbEdvdG8pIHtcclxuICAgICAgICBjb25zdCBvcGVuZWRGaWxlcyA9IGdldEFsbE9wZW5lZEZpbGVzRXhwZXJpbWVudGFsKGFwcClcclxuICAgICAgICBmb3IgKGNvbnN0IG9wZW5lZEZpbGUgb2Ygb3BlbmVkRmlsZXMpIHtcclxuICAgICAgICAgICAgaWYgKG9wZW5lZEZpbGUudHlwZSA9PSAnbGVhZicgJiYgb3BlbmVkRmlsZS5zdGF0ZS5zdGF0ZS5maWxlID09PSBmaWxlUGF0aCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbGVhZiA9IGFwcC53b3Jrc3BhY2UuZ2V0TGVhZkJ5SWQob3BlbmVkRmlsZS5pZCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobGVhZiAmJiBsZWFmLnBhcmVudCA9PT0gYXBwLndvcmtzcGFjZS5nZXRMZWFmKCkucGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXBwLndvcmtzcGFjZS5zZXRBY3RpdmVMZWFmKGxlYWYsIHsgZm9jdXM6IHRydWUgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBjb25zdCBsZWF2ZXMgPSBnZXRBbGxXb3Jrc3BhY2VMZWF2ZXMoYXBwKTtcclxuICAgICAgICBmb3IgKGNvbnN0IGxlYWYgb2YgbGVhdmVzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHZpZXcgPSBsZWFmLnZpZXc7XHJcbiAgICAgICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3JcclxuICAgICAgICAgICAgaWYgKHZpZXcuZmlsZSAmJiB2aWV3LmZpbGUucGF0aCA9PT0gZmlsZVBhdGggJiYgbGVhZi5wYXJlbnQgPT09IGFwcC53b3Jrc3BhY2UuZ2V0TGVhZigpLnBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgYXBwLndvcmtzcGFjZS5zZXRBY3RpdmVMZWFmKGxlYWYsIHsgZm9jdXM6IHRydWUgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn0iLCAiaW1wb3J0IFRldGhlck1hcmtzUGx1Z2luIGZyb20gJy4vbWFpbic7XHJcbmltcG9ydCB7IE1hcmtMaXN0TW9kYWwgfSBmcm9tICcuL3VpL01hcmtMaXN0TW9kYWwnO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNldEdsb2JhbE1hcmsocGx1Z2luOiBUZXRoZXJNYXJrc1BsdWdpbikge1xyXG4gICAgbmV3IE1hcmtMaXN0TW9kYWwocGx1Z2luLmFwcCwgcGx1Z2luLCAnc2V0Jykub3BlbigpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ29Ub0dsb2JhbE1hcmsocGx1Z2luOiBUZXRoZXJNYXJrc1BsdWdpbikge1xyXG4gICAgbmV3IE1hcmtMaXN0TW9kYWwocGx1Z2luLmFwcCwgcGx1Z2luLCAnZ290bycpLm9wZW4oKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUdsb2JhbE1hcmsocGx1Z2luOiBUZXRoZXJNYXJrc1BsdWdpbikge1xyXG4gICAgbmV3IE1hcmtMaXN0TW9kYWwocGx1Z2luLmFwcCwgcGx1Z2luLCAnZGVsZXRlJykub3BlbigpO1xyXG59XHJcblxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFkZEZpbGVUb0hhcnBvb24ocGx1Z2luOiBUZXRoZXJNYXJrc1BsdWdpbikge1xyXG4gICAgbmV3IE1hcmtMaXN0TW9kYWwocGx1Z2luLmFwcCwgcGx1Z2luLCAnZ290bycpLmFkZEZpbGVUb0hhcnBvb24oKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdvVG9IYXJwb29uTWFyayhwbHVnaW46IFRldGhlck1hcmtzUGx1Z2luKSB7XHJcbiAgICBuZXcgTWFya0xpc3RNb2RhbChwbHVnaW4uYXBwLCBwbHVnaW4sICdnb3RvJywgdHJ1ZSkub3BlbigpO1xyXG59IiwgImltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZyB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBUZXRoZXJNYXJrc1BsdWdpbiBmcm9tICcuLi9tYWluJztcbmltcG9ydCB7IFNldHRpbmdzIH0gZnJvbSAnLi4vdHlwZXMvaW5kZXgnO1xuaW1wb3J0IHsgZGVmYXVsdFNldHRpbmdzIH0gZnJvbSAnLi4vdXRpbHMvZGVmYXVsdFZhbHVlcyc7XG5cbmV4cG9ydCBjbGFzcyBTZXR0aW5nc1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuICAgIHBsdWdpbjogVGV0aGVyTWFya3NQbHVnaW47XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBUZXRoZXJNYXJrc1BsdWdpbikge1xuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cblxuICAgIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XG4gICAgICAgIGNvbnN0IGRzID0gZGVmYXVsdFNldHRpbmdzO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ09wZW4gbWFyayBpbiBuZXcgdGFiJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdPcGVuIGEgZmlsZSBpbiB0aGUgbmV3IHRhYiB3aGVuIHVzaW5nIFwiZ28gdG9cIiBjb21tYW5kLiBJZiBkaXNhYmxlZCwgaXQgd2lsbCBvcGVuIHRoZSBmaWxlIGluIHRoZSBjdXJyZW50IHRhYi4nKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm9wZW5NYXJrSW5OZXdUYWIgPz8gZHMub3Blbk1hcmtJbk5ld1RhYilcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm9wZW5NYXJrSW5OZXdUYWIgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnTm8gZHVwbGljYXRpb24gb2Ygb3BlbmVkIGZpbGVzIHdoZW4gdXNpbmcgR28gdG8gY29tbWFuZHMgKGV4cGVyaW1lbnRhbCknKVxuICAgICAgICAgICAgLnNldERlc2MoJ1ByZXZlbnRzIGR1cGxpY2F0ZSB0YWJzIHdoZW4gc3dpdGNoaW5nIHRvIGFscmVhZHkgb3BlbmVkIGZpbGVzIHVzaW5nIHRoZSBtYXJrIGxpc3QgYWZ0ZXIgcmVzdGFydGluZyBPYnNpZGlhbi4gKEV4cGVyaW1lbnRhbDogbWF5IG5vdCB3b3JrIGluIGZ1dHVyZSBPYnNpZGlhbiB2ZXJzaW9ucy4pJylcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5leHBlcmltZW50YWxHb3RvID8/IGRzLmV4cGVyaW1lbnRhbEdvdG8pXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leHBlcmltZW50YWxHb3RvID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKCdHZW5lcmFsIHJlZ2lzdGVycycpLnNldEhlYWRpbmcoKTtcbiAgICAgICAgdGhpcy5jcmVhdGVSZWdpc3Rlckxpc3RTZXR0aW5nKGNvbnRhaW5lckVsLCBcIlJlZ2lzdGVyIGxpc3RcIiwgZHMucmVnaXN0ZXJMaXN0LCAnS2V5IHN5bWJvbHMgdG8gYmUgdXNlZCBhcyByZWdpc3RlcnMuIE9ubHkgaW5jbHVkZSBzeW1ib2xzIHRoYXQgeW91IGNhbiBpbnB1dCB3aXRoIGEgc2luZ2xlIGtleXN0cm9rZS4nLCAncmVnaXN0ZXJMaXN0JylcbiAgICAgICAgICAgIC5hZGRFeHRyYUJ1dHRvbigoYnRuKSA9PiB7XG4gICAgICAgICAgICAgICAgYnRuXG4gICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKCdyZWZyZXNoLWNjdycpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKCdSZXNldCB0byBkZWZhdWx0IHJlZ2lzdGVyIGxpc3QnKVxuICAgICAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZWdpc3Rlckxpc3QgPSBkcy5yZWdpc3Rlckxpc3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpOyAvLyBSZWZyZXNoIHRoZSBzZXR0aW5ncyB0YWIgdG8gc2hvdyB0aGUgdXBkYXRlZCB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9KVxuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1NvcnQgYWxsIG1hcmtzIGJ5IHJlZ2lzdGVyIGxpc3QnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1NvcnQgbWFya3MgYnkgdGhlIG9yZGVyIG9mIHRoZSBrZXkgc3ltYm9scyBpbiB0aGUgcmVnaXN0ZXIgbGlzdC4gSWYgZGlzYWJsZWQsIG1hcmtzIHdpbGwgYmUgc29ydGVkIGFscGhhYmV0aWNhbGx5IGFjY29yZGluZyB0byB0aGUgY3VycmVudCBsb2NhbGUuJylcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZWdpc3RlclNvcnRCeUxpc3QgPz8gZHMucmVnaXN0ZXJTb3J0QnlMaXN0KVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucmVnaXN0ZXJTb3J0QnlMaXN0ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuXG4gICAgICAgIC8vIFRPRE86IGltcGxlbWVudCB0aGlzIGZlYXR1cmVcbiAgICAgICAgLy8gbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgIC8vICAgICAuc2V0TmFtZSgnSGlkZSBtYXJrIGxpc3QnKVxuICAgICAgICAvLyAgICAgLnNldERlc2MoJ0hpZGUgdGhlIGdsb2JhbCBtYXJrIGxpc3QgZm9yIGJvdGggY29tbWFuZHMgKGZvciBmYXN0IGlucHV0LCBubyBmbGlja2VyKS4nKVxuICAgICAgICAvLyAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgIC8vICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmhpZGVNYXJrTGlzdER1cmluZ0lucHV0ID8/IGRzLmhpZGVNYXJrTGlzdER1cmluZ0lucHV0KVxuICAgICAgICAvLyAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgLy8gICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaGlkZU1hcmtMaXN0RHVyaW5nSW5wdXQgPSB2YWx1ZTtcbiAgICAgICAgLy8gICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIC8vICAgICAgICAgfSkpO1xuXG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpLnNldE5hbWUoJ0hhcnBvb24gcmVnaXN0ZXJzJykuc2V0SGVhZGluZygpO1xuICAgICAgICB0aGlzLmNyZWF0ZVJlZ2lzdGVyTGlzdFNldHRpbmcoY29udGFpbmVyRWwsIFwiSGFycG9vbiByZWdpc3RlciBsaXN0XCIsIGRzLmhhcnBvb25SZWdpc3Rlckxpc3QsICdLZXkgc3ltYm9scyB0byBiZSB1c2VkIGFzIEhhcnBvb24gcmVnaXN0ZXJzLiBPbmx5IGluY2x1ZGUgc3ltYm9scyB0aGF0IHlvdSBjYW4gaW5wdXQgd2l0aCBhIHNpbmdsZSBrZXlzdHJva2UuJywgJ2hhcnBvb25SZWdpc3Rlckxpc3QnKVxuICAgICAgICAgICAgLmFkZEV4dHJhQnV0dG9uKChidG4pID0+IHtcbiAgICAgICAgICAgICAgICBidG5cbiAgICAgICAgICAgICAgICAgICAgLnNldEljb24oJ3JlZnJlc2gtY2N3JylcbiAgICAgICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoJ1Jlc2V0IHRvIGRlZmF1bHQgSGFycG9vbiByZWdpc3RlciBsaXN0JylcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaGFycG9vblJlZ2lzdGVyTGlzdCA9IGRzLmhhcnBvb25SZWdpc3Rlckxpc3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpOyAvLyBSZWZyZXNoIHRoZSBzZXR0aW5ncyB0YWIgdG8gc2hvdyB0aGUgdXBkYXRlZCB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9KVxuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1NvcnQgSGFycG9vbiBtYXJrcyBieSBIYXJwb29uIHJlZ2lzdGVyIGxpc3QnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1NvcnQgSGFycG9vbiBtYXJrcyBieSB0aGUgb3JkZXIgb2YgdGhlIGtleSBzeW1ib2xzIGluIHRoZSBIYXJwb29uIHJlZ2lzdGVyIGxpc3QuIElmIGRpc2FibGVkLCBtYXJrcyB3aWxsIGJlIHNvcnRlZCBhbHBoYWJldGljYWxseSBhY2NvcmRpbmcgdG8gdGhlIGN1cnJlbnQgbG9jYWxlLicpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuaGFycG9vblJlZ2lzdGVyU29ydEJ5TGlzdCA/PyBkcy5oYXJwb29uUmVnaXN0ZXJTb3J0QnlMaXN0KVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaGFycG9vblJlZ2lzdGVyU29ydEJ5TGlzdCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdSZW1vdmUgZ2FwcyBpbmJldHdlZW4gSGFycG9vbiBtYXJrcycpXG4gICAgICAgICAgICAuc2V0RGVzYygnSGFycG9vbiBtYXJrcyB3aWxsIGJlIHNoaWZ0ZWQgdG8gdGhlIGxlZnQgZm9yIGV2ZXJ5IGdhcCAocmVnaXN0ZXIgd2l0aCBubyBtYXJrKSBiYXNlZCBvbiB0aGUgb3JkZXIgb2YgdGhlIEhhcnBvb24gcmVnaXN0ZXIgbGlzdC4nKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmhhcnBvb25SZWdpc3RlckdhcFJlbW92YWwgPz8gZHMuaGFycG9vblJlZ2lzdGVyR2FwUmVtb3ZhbClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmhhcnBvb25SZWdpc3RlckdhcFJlbW92YWwgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG5cblxuICAgICAgICAvLyBBZGQga2V5Ym9hcmQgc2hvcnRjdXQgc2V0dGluZ3NcbiAgICAgICAgLy8gVE9ETzogc2V0dGluZyB0aG9zZSB2YWx1ZXMgaGVyZSBsaWtlIGZlZWxzIHdyb25nLCBlc3BlY2lhbGx5IHBhc3Npbmcgb2JqZWN0IHByb3BlcnR5IGFzIHN0cmluZ1xuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdMaXN0IG5hdmlnYXRpb24gc2hvcnRjdXRzJyB9KTtcbiAgICAgICAgdGhpcy5jcmVhdGVTaG9ydGN1dFNldHRpbmcoY29udGFpbmVyRWwsICdVcCcsIGRzLm1vZGFsTGlzdFVwLCAnU2hvcnRjdXQgZm9yIG1vdmluZyB1cCBpbiB0aGUgbGlzdCcsICdtb2RhbExpc3RVcCcpO1xuICAgICAgICB0aGlzLmNyZWF0ZVNob3J0Y3V0U2V0dGluZyhjb250YWluZXJFbCwgJ0Rvd24nLCBkcy5tb2RhbExpc3REb3duLCAnU2hvcnRjdXQgZm9yIG1vdmluZyBkb3duIGluIHRoZSBsaXN0JywgJ21vZGFsTGlzdERvd24nKTtcbiAgICAgICAgdGhpcy5jcmVhdGVTaG9ydGN1dFNldHRpbmcoY29udGFpbmVyRWwsICdTZWxlY3QnLCBkcy5tb2RhbExpc3RTZWxlY3QsICdTaG9ydGN1dCBmb3Igc2VsZWN0aW5nIGEgbWFyaycsICdtb2RhbExpc3RTZWxlY3QnKTtcbiAgICAgICAgdGhpcy5jcmVhdGVTaG9ydGN1dFNldHRpbmcoY29udGFpbmVyRWwsICdDYW5jZWwnLCBkcy5tb2RhbExpc3RDYW5jZWwsICdTaG9ydGN1dCBmb3IgY2FuY2VsbGluZyB0aGUgbW9kYWwnLCAnbW9kYWxMaXN0Q2FuY2VsJyk7XG4gICAgICAgIHRoaXMuY3JlYXRlU2hvcnRjdXRTZXR0aW5nKGNvbnRhaW5lckVsLCAnRGVsZXRlJywgZHMubW9kYWxMaXN0RGVsZXRlLCAnU2hvcnRjdXQgZm9yIGRlbGV0aW5nIGEgbWFyaycsICdtb2RhbExpc3REZWxldGUnKTtcblxuXG4gICAgfVxuXG4gICAgLy8gdXNlIG9ubHkgZm9yIHN0cmluZyB2YWx1ZXMgZnJvbSBTZXR0aW5ncyB0eXBlXG4gICAgY3JlYXRlU2hvcnRjdXRTZXR0aW5nKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCwgbmFtZTogc3RyaW5nLCBkZWZhdWx0VmFsdWU6IHN0cmluZywgZGVzYzogc3RyaW5nLCBrZXk6IGtleW9mIFNldHRpbmdzKSB7XG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUobmFtZSlcbiAgICAgICAgICAgIC5zZXREZXNjKGRlc2MpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUoU3RyaW5nKHRoaXMucGx1Z2luLnNldHRpbmdzW2tleV0gPz8gZGVmYXVsdFZhbHVlKSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICh0aGlzLnBsdWdpbi5zZXR0aW5ncyBhcyBhbnkpW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgIH1cblxuICAgIGNyZWF0ZVJlZ2lzdGVyTGlzdFNldHRpbmcoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LCBuYW1lOiBzdHJpbmcsIGRlZmF1bHRWYWx1ZTogc3RyaW5nLCBkZXNjOiBzdHJpbmcsIGtleToga2V5b2YgU2V0dGluZ3MpOiBTZXR0aW5nIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUobmFtZSlcbiAgICAgICAgICAgIC5zZXREZXNjKGRlc2MpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUoU3RyaW5nKHRoaXMucGx1Z2luLnNldHRpbmdzW2tleV0gPz8gZGVmYXVsdFZhbHVlKSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICh0aGlzLnBsdWdpbi5zZXR0aW5ncyBhcyBhbnkpW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgIH1cbn0iLCAiaW1wb3J0IHsgTm90aWNlIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgVGV0aGVyTWFya3NQbHVnaW4gZnJvbSAnLi4vbWFpbic7XHJcbmltcG9ydCB7IFNldHRpbmdzLCBNYXJrIH0gZnJvbSAnLi4vdHlwZXMvaW5kZXgnO1xyXG5pbXBvcnQgeyBkZWZhdWx0U2V0dGluZ3MsIEpTT05zY2hlbWFWZXJzaW9uIGFzIGxhdGVzdEpTT05TY2hlbWFWZXJzaW9uIH0gZnJvbSAnLi9kZWZhdWx0VmFsdWVzJztcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkU2V0dGluZ3MocGx1Z2luOiBUZXRoZXJNYXJrc1BsdWdpbik6IFByb21pc2U8U2V0dGluZ3M+IHtcclxuICAgIHJldHVybiAoYXdhaXQgcGx1Z2luLmxvYWREYXRhKCkpPy5zZXR0aW5ncyB8fCBkZWZhdWx0U2V0dGluZ3M7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzYXZlU2V0dGluZ3MocGx1Z2luOiBUZXRoZXJNYXJrc1BsdWdpbiwgc2V0dGluZ3M6IFNldHRpbmdzKSB7XHJcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcGx1Z2luLmxvYWREYXRhKCkgfHwge307XHJcbiAgICBkYXRhLnNldHRpbmdzID0gc2V0dGluZ3M7XHJcbiAgICBhd2FpdCBwbHVnaW4uc2F2ZURhdGEoZGF0YSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkTWFya3MocGx1Z2luOiBUZXRoZXJNYXJrc1BsdWdpbik6IFByb21pc2U8TWFya1tdPiB7XHJcbiAgICByZXR1cm4gKGF3YWl0IHBsdWdpbi5sb2FkRGF0YSgpKT8ubWFya3MgfHwgW107XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzYXZlTWFya3MocGx1Z2luOiBUZXRoZXJNYXJrc1BsdWdpbiwgbWFya3M6IE1hcmtbXSkge1xyXG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHBsdWdpbi5sb2FkRGF0YSgpIHx8IHt9O1xyXG4gICAgZGF0YS5tYXJrcyA9IG1hcmtzO1xyXG4gICAgYXdhaXQgcGx1Z2luLnNhdmVEYXRhKGRhdGEpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gSlNPTnNjaGVtYUNoZWNrKHBsdWdpbjogVGV0aGVyTWFya3NQbHVnaW4pIHtcclxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBwbHVnaW4ubG9hZERhdGEoKSB8fCB7c2NoZW1hVmVyc2lvbjogbGF0ZXN0SlNPTlNjaGVtYVZlcnNpb259O1xyXG5cclxuICAgIGlmIChkYXRhLnNjaGVtYVZlcnNpb24gJiYgZGF0YS5zY2hlbWFWZXJzaW9uID09PSBsYXRlc3RKU09OU2NoZW1hVmVyc2lvbil7XHJcbiAgICAgICAgcmV0dXJuXHJcbiAgICB9XHJcblxyXG4gICAgbmV3IE5vdGljZShwbHVnaW4ubWFuaWZlc3QubmFtZSArIFwiOiBGYXVsdHkgZGF0YS4gQ2hlY2sgZGV2ZWxvcGVyIHRvb2xzIGZvciBtb3JlIGluZm8uXCIpO1xyXG4gICAgY29uc29sZS5lcnJvcihwbHVnaW4ubWFuaWZlc3QuaWQgKyBcIjogVGhlIGRhdGEgbG9hZGVkIGlzIG5vdCBpbiBjb3JyZWN0IGZvcm1hdC4gVGhlIHBsdWdpbiBtYXkgbm90IHdvcmsgcHJvcGVybHkuIFRoaXMgdXN1YWxseSBoYXBwZW5zIGFmdGVyIHBsdWdpbiB1cGRhdGUgdGhhdCBjaGFuZ2VzIHRoZSBKU09OIHNjaGVtYS4gXCIpO1xyXG4gICAgLy8gVE9ETzogbWFrZSBhdXRvbWF0aWMgY29udmVyc2lvbnMgaGVyZSBpZiBuZWNlc3NhcnkgaW4gdGhlIGZ1dHVyZS4gQmUgc3VyZSB0byBzYXZlIHRoZSBsZWdhY3kgcHJlIGNvbnZlcnNpb24gZGF0YSBhcyBiYWNrdXAgaW4gdGhlIFwibGVnYWN5U2NoZW1hRGF0YVwiIGZpZWxkLiBcclxufSJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFBQUEsbUJBQXVC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QUFJO0FBQUEsTUFDSixNQUFNO0FBQUEsTUFDTixVQUFVLE1BQU0sY0FBYyxJQUFJO0FBQUEsSUFDdEMsQ0FBQztBQUVELFNBQUssV0FBVztBQUFBLE1BQ1osSUFBSTtBQUFBLE1BQ0osTUFBTTtBQUFBLE1BQ04sVUFBVSxNQUFNLGVBQWUsSUFBSTtBQUFBLElBQ3ZDLENBQUM7QUFFRCxTQUFLLFdBQVc7QUFBQSxNQUNaLElBQUk7QUFBQSxNQUNKLE1BQU07QUFBQSxNQUNOLFVBQVUsTUFBTSxpQkFBaUIsSUFBSTtBQUFBLElBQ3pDLENBQUM7QUFFRCxTQUFLLFdBQVc7QUFBQSxNQUNaLElBQUk7QUFBQSxNQUNKLE1BQU07QUFBQSxNQUNOLFVBQVUsTUFBTSxpQkFBaUIsSUFBSTtBQUFBLElBQ3pDLENBQUM7QUFFRCxTQUFLLFdBQVc7QUFBQSxNQUNaLElBQUk7QUFBQSxNQUNKLE1BQU07QUFBQSxNQUNOLFVBQVUsTUFBTSxnQkFBZ0IsSUFBSTtBQUFBLElBQ3hDLENBQUM7QUFFRCxTQUFLLGNBQWMsSUFBSSxZQUFZLEtBQUssS0FBSyxJQUFJLENBQUM7QUFFbEQsWUFBUSxJQUFJLGFBQWEsS0FBSyxTQUFTLEVBQUU7QUFBQSxFQUM3QztBQUFBLEVBRUEsTUFBTSxlQUFlO0FBQ2pCLFVBQU0sYUFBYSxNQUFNLEtBQUssUUFBUTtBQUFBLEVBQzFDO0FBQUEsRUFFQSxNQUFNLFVBQVUsT0FBZTtBQUMzQixTQUFLLFFBQVE7QUFDYixVQUFNLFVBQVUsTUFBTSxLQUFLO0FBQUEsRUFDL0I7QUFBQSxFQUVBLFdBQVc7QUFDUCxZQUFRLElBQUksZUFBZSxLQUFLLFNBQVMsRUFBRTtBQUFBLEVBQy9DO0FBQ0o7IiwKICAibmFtZXMiOiBbImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiJdCn0K
