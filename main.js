/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => VimMarksImpl
});
module.exports = __toCommonJS(main_exports);
var import_obsidian4 = require("obsidian");

// src/ui/MarkListModal.ts
var import_obsidian2 = require("obsidian");

// src/utils/defaultValues.ts
var modalDefaultKeybinds = {
  up: ["ctrl+k", "ctrl+p"],
  down: ["ctrl+j", "ctrl+n"],
  delete: ["ctrl+d"],
  undo: ["ctrl+u"],
  enter: ["Enter"]
};
var modalDefaultKeybindsMac = {
  up: ["cmd+k", "cmd+p"],
  down: ["cmd+j", "cmd+n"],
  delete: ["cmd+d"],
  undo: ["cmd+u"],
  enter: ["Enter"]
};
var modalPlaceholderMessages = {
  set: "Select a mark to set",
  goto: "Select a mark to go to",
  delete: "Select a mark to delete"
};
var defaultSettings = {
  hideMarkListDuringInput: false,
  modalListUp: "",
  modalListDown: "",
  modalListSelect: "",
  modalChangeUndo: "",
  modalListDelete: "",
  openMarkInNewTab: false,
  // If true, open mark in new tab, else in current tab
  registerList: "abcdefghijklmnopqrstuvwxyz",
  registerSortByList: true,
  harpoonRegisterList: "qwer",
  harpoonRegisterSortByList: true,
  harpoonRegisterGapRemoval: true,
  experimentalGoto: false
};
var modalInstructionElClass = "modal-instruction-el";
var modalMarkSymbolClass = "mark-symbol";
var modalMarkFilepathClass = "mark-file-path";
var JSONschemaVersion = 1;

// src/utils/marks.ts
function findFirstUnusedRegister(marks, registers) {
  for (const reg of registers) {
    if (!marks.map((m) => m.symbol).includes(reg)) {
      return reg;
    }
  }
  return null;
}
function getMarkBySymbol(marks, symbol) {
  return marks.find((m) => m.symbol === symbol);
}
function sortMarksAlphabetically(marks) {
  marks.sort((a, b) => a.symbol.localeCompare(b.symbol));
}
function getSortedAndFilteredMarks(marks, isHarpoonMode, settings) {
  const availableRegisters = new Set((!isHarpoonMode ? settings.registerList : settings.harpoonRegisterList).split(""));
  const filteredMarks = marks.filter((el) => availableRegisters.has(el.symbol));
  if (!isHarpoonMode && settings.registerSortByList) {
    const registerList = settings.registerList;
    sortMarksBySettingsRegisterOrder(filteredMarks, registerList);
  } else if (isHarpoonMode && settings.harpoonRegisterSortByList) {
    const registerList = settings.harpoonRegisterList;
    sortMarksBySettingsRegisterOrder(filteredMarks, registerList);
  } else {
    sortMarksAlphabetically(filteredMarks);
  }
  return filteredMarks;
}
function sortMarksBySettingsRegisterOrder(marks, registers) {
  const registerOrder = new Map([...registers].map((symbol, index) => [symbol, index]));
  marks.sort((a, b) => {
    var _a, _b;
    return ((_a = registerOrder.get(a.symbol)) != null ? _a : Infinity) - ((_b = registerOrder.get(b.symbol)) != null ? _b : Infinity);
  });
}
function removeGapsForHarpoonMarks(marksToCopy, harpoonRegisters) {
  let marks = [...marksToCopy];
  let leftCur = 0;
  let rightCur = 0;
  while (rightCur < harpoonRegisters.length) {
    const markEl = marks.find((el) => el.symbol === harpoonRegisters[rightCur]);
    if (markEl !== void 0) {
      const symbolToSetTo = harpoonRegisters[leftCur];
      let filteredMarks = marks.filter((el) => el.symbol !== harpoonRegisters[leftCur]);
      filteredMarks.push({ symbol: symbolToSetTo, filePath: markEl.filePath });
      marks = filteredMarks;
      leftCur += 1;
    }
    rightCur += 1;
  }
  while (leftCur < harpoonRegisters.length) {
    marks = marks.filter((el) => el.symbol !== harpoonRegisters[leftCur]);
    leftCur += 1;
  }
  return marks;
}
function restoreLastChangedMark(marks, lastChangedMark) {
  const markToRestore = { ...lastChangedMark };
  const markToDiscard = marks.find((m) => m.symbol === markToRestore.symbol);
  const marksWithoutDiscarded = marks.filter((m) => m.symbol !== markToRestore.symbol);
  marksWithoutDiscarded.push({ symbol: markToRestore.symbol, filePath: markToRestore.filePath });
  return { marks: marksWithoutDiscarded, markToDiscard };
}
function setNewOrOverwriteMark(marks, setMark, filePath) {
  const outMarks = marks.filter((m) => m.symbol !== setMark.symbol);
  outMarks.push({ symbol: setMark.symbol, filePath });
  return outMarks;
}

// src/utils/keybinds.ts
function prepareKeybinds(isMacOS, settings) {
  let keybinds = !isMacOS ? { ...modalDefaultKeybinds } : { ...modalDefaultKeybindsMac };
  if (settings.markListUp) {
    keybinds.up = [settings.markListUp];
  }
  if (settings.markListDown) {
    keybinds.down = [settings.markListDown];
  }
  if (settings.markListDelete) {
    keybinds.delete = [settings.markListDelete];
  }
  if (settings.markChangeUndo) {
    keybinds.undo = [settings.markChangeUndo];
  }
  if (settings.markListSelect) {
    keybinds.enter = [settings.markListSelect];
  }
  return keybinds;
}
function matchKeybind(evt, keybind) {
  const parts = keybind.split("+").map((p) => p.trim());
  let required = { ctrl: false, shift: false, alt: false, meta: false, key: "" };
  for (const part of parts) {
    if (part === "ctrl")
      required.ctrl = true;
    else if (part === "shift")
      required.shift = true;
    else if (part === "alt")
      required.alt = true;
    else if (part === "meta" || part === "cmd" || part === "win")
      required.meta = true;
    else
      required.key = part;
  }
  if (evt.ctrlKey !== required.ctrl)
    return false;
  if (evt.shiftKey !== required.shift)
    return false;
  if (evt.altKey !== required.alt)
    return false;
  if (evt.metaKey !== required.meta)
    return false;
  return evt.key === required.key;
}

// src/utils/obsidianUtils.ts
var import_obsidian = require("obsidian");
function openNewFile(filePath, openFileInNewTab, app) {
  const file = app.vault.getAbstractFileByPath(filePath);
  if (file instanceof import_obsidian.TFile) {
    if (openFileInNewTab) {
      app.workspace.getLeaf("tab").openFile(file);
    } else {
      app.workspace.getLeaf().openFile(file);
    }
  } else {
    new import_obsidian.Notice(`File not found for path ${filePath}. The file may have been deleted, moved or renamed.`);
  }
}
function getAllOpenedFilesExperimental(app) {
  var _a;
  let tabGroups = (_a = app.workspace.getLayout().main) == null ? void 0 : _a.children;
  let out = [];
  for (const el of tabGroups) {
    out.push(...el.children);
  }
  return out;
}
function navigateToOpenFileByPath(filePath, experimentalGoto, app) {
  if (experimentalGoto) {
    const openedFiles = getAllOpenedFilesExperimental(app);
    for (const openedFile of openedFiles) {
      if (openedFile.type == "leaf" && openedFile.state.state.file === filePath) {
        const leaf = app.workspace.getLeafById(openedFile.id);
        if (leaf && leaf.parent === app.workspace.getLeaf().parent) {
          app.workspace.setActiveLeaf(leaf, { focus: true });
          return true;
        }
      }
    }
  } else {
    const leaves = app.workspace.getLeavesOfType("markdown");
    for (const leaf of leaves) {
      const view = leaf.view;
      if (view instanceof import_obsidian.MarkdownView && view.file && view.file.path === filePath && leaf.parent === app.workspace.getLeaf().parent) {
        app.workspace.setActiveLeaf(leaf, { focus: true });
        return true;
      }
    }
  }
  return false;
}

// src/ui/MarkListModal.ts
var MarkListModal = class extends import_obsidian2.SuggestModal {
  constructor(app, plugin, mode, isHarpoonMode = false) {
    super(app);
    this.plugin = plugin;
    this.mode = mode;
    this.setPlaceholder(modalPlaceholderMessages[this.mode]);
    this.isHarpoonMode = isHarpoonMode;
  }
  getSuggestions(query) {
    return getSortedAndFilteredMarks(this.plugin.marks, this.isHarpoonMode, this.plugin.settings);
  }
  renderSuggestion(mark, el) {
    el.createEl("span", { text: mark.symbol, cls: modalMarkSymbolClass });
    el.createEl("span", { text: mark.filePath, cls: modalMarkFilepathClass });
    el.addEventListener("click", async (evt) => {
      await this.onChooseSuggestion(mark, evt);
      this.close();
    });
  }
  // Override to hide the input box
  onOpen() {
    super.onOpen();
    if (this.inputEl) {
      this.inputEl.style.display = "none";
    }
    this.modalEl.addClass("marks-modal");
    const modalKeybinds = prepareKeybinds(import_obsidian2.Platform.isMacOS, this.plugin.settings);
    const modalInstructions = this.prepareModalInstructionElement(modalKeybinds);
    this.modalEl.appendChild(modalInstructions);
    this._keyHandler = this.getModalKeyHandler(modalKeybinds);
    window.addEventListener("keydown", this._keyHandler, true);
  }
  onClose() {
    const instructions = this.modalEl.querySelector("." + modalInstructionElClass);
    if (instructions)
      instructions.remove();
    if (this._keyHandler) {
      window.removeEventListener("keydown", this._keyHandler, true);
      this._keyHandler = void 0;
    }
    super.onClose();
  }
  prepareModalInstructionElement(keybinds) {
    const instructions = document.createElement("div");
    instructions.addClass(modalInstructionElClass);
    const formatKeys = (keys) => keys.map(
      (k) => `<kbd>${k.replace("cmd", "\u2318").replace("ctrl", "Ctrl").replace("alt", "Alt").replace("shift", "Shift")}</kbd>`
    ).join("/");
    instructions.innerHTML = `
            <span>${formatKeys(keybinds.up)} : Up</span>
            <span>${formatKeys(keybinds.down)} : Down</span>
            <span>${formatKeys(keybinds.delete)} : Delete</span>
            <span>${formatKeys(keybinds.undo)} : Undo last changed mark</span>
            <span><kbd>Symbol</kbd> : Jump/Set/Delete</span>
            <span><kbd>Enter</kbd> : Confirm</span>
            <span><kbd>Esc</kbd> : Close</span>

        `;
    return instructions;
  }
  getModalKeyHandler(keybinds) {
    return async (evt) => {
      const availableRegisters = new Set((!this.isHarpoonMode ? this.plugin.settings.registerList : this.plugin.settings.harpoonRegisterList).split(""));
      const chooser = this.chooser;
      if (keybinds.up.some((kb) => matchKeybind(evt, kb))) {
        evt.preventDefault();
        this.moveSelection(-1);
      } else if (keybinds.down.some((kb) => matchKeybind(evt, kb))) {
        evt.preventDefault();
        this.moveSelection(1);
      } else if (keybinds.delete.some((kb) => matchKeybind(evt, kb))) {
        evt.preventDefault();
        const prevIdx = chooser.selectedItem;
        const selected = chooser.values[prevIdx];
        if (selected) {
          await this.deleteMark(selected);
          chooser.values = getSortedAndFilteredMarks(this.plugin.marks, this.isHarpoonMode, this.plugin.settings);
          chooser.setSuggestions(chooser.values);
          let newIdx = prevIdx;
          if (newIdx >= chooser.values.length) {
            newIdx = chooser.values.length - 1;
          }
          chooser.setSelectedItem(Math.max(0, newIdx), false);
        }
      } else if (keybinds.enter.some((kb) => matchKeybind(evt, kb))) {
        evt.preventDefault();
        const ind = chooser.selectedItem;
        const selected = chooser.values[ind];
        if (selected) {
          this.onChooseSuggestion(selected, evt);
          this.close();
        }
      } else if (keybinds.undo.some((kb) => matchKeybind(evt, kb))) {
        evt.preventDefault();
        await this.restoreLastChangedMark();
        chooser.values = getSortedAndFilteredMarks(this.plugin.marks, this.isHarpoonMode, this.plugin.settings);
        chooser.setSuggestions(chooser.values);
      } else if (availableRegisters.has(evt.key)) {
        let mark = getMarkBySymbol(this.plugin.marks, evt.key);
        if (this.mode === "set") {
          if (mark == null) {
            const file = this.app.workspace.getActiveFile();
            if (!file) {
              new import_obsidian2.Notice("No active file to mark.");
              return;
            }
            mark = { symbol: evt.key, filePath: file.path };
          }
          evt.preventDefault();
          await this.onChooseSuggestion(mark, evt);
          this.close();
        } else if (this.mode === "goto" && mark) {
          evt.preventDefault();
          await this.onChooseSuggestion(mark, evt);
          this.close();
        } else if (this.mode === "delete" && mark) {
          evt.preventDefault();
          await this.onChooseSuggestion(mark, evt);
          this.close();
        }
      }
    };
  }
  async onChooseSuggestion(mark, evt) {
    if (this.mode === "set") {
      this.setNewOrOverwriteMark(mark);
    } else if (this.mode === "goto") {
      this.goToMark(mark);
    } else if (this.mode === "delete") {
      this.deleteMark(mark);
    }
  }
  moveSelection(delta) {
    const chooser = this.chooser;
    if (!chooser)
      return;
    let idx = chooser.selectedItem;
    if (typeof idx !== "number")
      idx = 0;
    const max = chooser.values.length;
    let next = idx + delta;
    if (next < 0)
      next = max - 1;
    if (next >= max)
      next = 0;
    chooser.setSelectedItem(next, 0);
  }
  async setNewOrOverwriteMark(mark) {
    const file = this.app.workspace.getActiveFile();
    if (!file) {
      new import_obsidian2.Notice("No active file to mark.");
      return;
    }
    const marks = setNewOrOverwriteMark(this.plugin.marks, mark, file.path);
    await this.plugin.saveMarks(marks);
    new import_obsidian2.Notice(`Set mark '${mark.symbol}' to ${file.name}`);
  }
  goToMark(mark) {
    const success = navigateToOpenFileByPath(mark.filePath, this.plugin.settings.experimentalGoto, this.app);
    if (!success) {
      openNewFile(mark.filePath, this.plugin.settings.openMarkInNewTab, this.app);
    }
  }
  async deleteMark(mark) {
    const cMark = { ...mark };
    const filteredMarks = this.plugin.marks.filter((m) => m.symbol !== cMark.symbol);
    await this.plugin.saveMarks(filteredMarks);
    if (this.plugin.settings.harpoonRegisterGapRemoval) {
      this.removeGapsForHarpoonMarks();
    }
    new import_obsidian2.Notice(`Deleted mark '${cMark.symbol}'`);
  }
  async restoreLastChangedMark() {
    if (this.plugin.lastChangedMark) {
      const out = restoreLastChangedMark(this.plugin.marks, this.plugin.lastChangedMark);
      await this.plugin.saveMarks(out.marks);
      if (out.markToDiscard) {
        new import_obsidian2.Notice(`Restored mark '${this.plugin.lastChangedMark.symbol}' to ${this.plugin.lastChangedMark.filePath}`);
        this.plugin.saveLastChangedMark(out.markToDiscard);
      }
    } else {
      new import_obsidian2.Notice("No last changed mark to restore.");
    }
  }
  addFileToHarpoon() {
    var _a;
    const harpoonRegisters = this.plugin.settings.harpoonRegisterList.split("");
    const reg = findFirstUnusedRegister(this.plugin.marks, harpoonRegisters);
    if (!reg) {
      new import_obsidian2.Notice("Harpoon registers are full, cannot add more marks.");
    } else {
      this.setNewOrOverwriteMark({ symbol: reg, filePath: ((_a = this.app.workspace.getActiveFile()) == null ? void 0 : _a.path) || "" });
    }
  }
  async removeGapsForHarpoonMarks() {
    const harpoonRegisters = this.plugin.settings.harpoonRegisterList.split("");
    const marks = removeGapsForHarpoonMarks(this.plugin.marks, harpoonRegisters);
    await this.plugin.saveMarks(marks);
  }
};

// src/commands.ts
async function setGlobalMark(plugin) {
  new MarkListModal(plugin.app, plugin, "set").open();
}
async function goToGlobalMark(plugin) {
  new MarkListModal(plugin.app, plugin, "goto").open();
}
async function deleteGlobalMark(plugin) {
  new MarkListModal(plugin.app, plugin, "delete").open();
}
async function addFileToHarpoon(plugin) {
  new MarkListModal(plugin.app, plugin, "goto").addFileToHarpoon();
}
async function goToHarpoonMark(plugin) {
  new MarkListModal(plugin.app, plugin, "goto", true).open();
}

// src/ui/SettingsTab.ts
var import_obsidian3 = require("obsidian");
var SettingsTab = class extends import_obsidian3.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    const ds = defaultSettings;
    containerEl.createEl("h4", { text: "General" });
    this.createRegisterListSetting(containerEl, "Register list", ds.registerList, "Key symbols to be used as registers. Only include symbols that you can input with a single keystroke.", "registerList").addExtraButton((btn) => {
      btn.setIcon("refresh-ccw").setTooltip("Reset to default register list").onClick(
        async () => {
          this.plugin.settings.registerList = ds.registerList;
          await this.plugin.saveSettings();
          this.display();
        }
      );
    });
    new import_obsidian3.Setting(containerEl).setName("Sort all marks by register list").setDesc("Sort marks by the order of the key symbols in the register list. If disabled, marks will be sorted alphabetically according to the current locale.").addToggle(
      (toggle) => {
        var _a;
        return toggle.setValue((_a = this.plugin.settings.registerSortByList) != null ? _a : ds.registerSortByList).onChange(async (value) => {
          this.plugin.settings.registerSortByList = value;
          await this.plugin.saveSettings();
        });
      }
    );
    new import_obsidian3.Setting(containerEl).setName("Open mark in new tab").setDesc('Open a file in the new tab when using "go to" command. If disabled, it will open the file in the current tab.').addToggle(
      (toggle) => {
        var _a;
        return toggle.setValue((_a = this.plugin.settings.openMarkInNewTab) != null ? _a : ds.openMarkInNewTab).onChange(async (value) => {
          this.plugin.settings.openMarkInNewTab = value;
          await this.plugin.saveSettings();
        });
      }
    );
    new import_obsidian3.Setting(containerEl).setName("No duplication of opened files when using goto (experimental)").setDesc("Prevents duplicate tabs when switching to already opened files using the mark list after restarting Obsidian. (Experimental: may not work in future Obsidian versions.)").addToggle(
      (toggle) => {
        var _a;
        return toggle.setValue((_a = this.plugin.settings.experimentalGoto) != null ? _a : ds.experimentalGoto).onChange(async (value) => {
          this.plugin.settings.experimentalGoto = value;
          await this.plugin.saveSettings();
        });
      }
    );
    containerEl.createEl("h4", { text: "Harpoon registers" });
    this.createRegisterListSetting(containerEl, "Harpoon register list", ds.harpoonRegisterList, "Key symbols to be used as Harpoon registers. Only include symbols that you can input with a single keystroke.", "harpoonRegisterList").addExtraButton((btn) => {
      btn.setIcon("refresh-ccw").setTooltip("Reset to default Harpoon register list").onClick(
        async () => {
          this.plugin.settings.harpoonRegisterList = ds.harpoonRegisterList;
          await this.plugin.saveSettings();
          this.display();
        }
      );
    });
    new import_obsidian3.Setting(containerEl).setName("Sort Harpoon marks by Harpoon register list").setDesc("Sort Harpoon marks by the order of the key symbols in the Harpoon register list. If disabled, marks will be sorted alphabetically according to the current locale.").addToggle(
      (toggle) => {
        var _a;
        return toggle.setValue((_a = this.plugin.settings.harpoonRegisterSortByList) != null ? _a : ds.harpoonRegisterSortByList).onChange(async (value) => {
          this.plugin.settings.harpoonRegisterSortByList = value;
          await this.plugin.saveSettings();
        });
      }
    );
    new import_obsidian3.Setting(containerEl).setName("Remove gaps inbetween Harpoon marks").setDesc("Harpoon marks will be shifted to the left for every gap (register with no mark) based on the order of the Harpoon register list.").addToggle(
      (toggle) => {
        var _a;
        return toggle.setValue((_a = this.plugin.settings.harpoonRegisterGapRemoval) != null ? _a : ds.harpoonRegisterGapRemoval).onChange(async (value) => {
          this.plugin.settings.harpoonRegisterGapRemoval = value;
          await this.plugin.saveSettings();
        });
      }
    );
    containerEl.createEl("h4", { text: "List navigation shortcuts" });
    this.createShortcutSetting(containerEl, "Up", ds.modalListUp, "Shortcut for moving up in the list", "markListUp");
    this.createShortcutSetting(containerEl, "Down", ds.modalListDown, "Shortcut for moving down in the list", "markListDown");
    this.createShortcutSetting(containerEl, "Select", ds.modalListSelect, "Shortcut for selecting a mark", "markListSelect");
    this.createShortcutSetting(containerEl, "Delete", ds.modalListDelete, "Shortcut for deleting a mark", "markListDelete");
  }
  // use only for string values from Settings type
  createShortcutSetting(containerEl, name, defaultValue, desc, key) {
    new import_obsidian3.Setting(containerEl).setName(name).setDesc(desc).addText((text) => {
      var _a;
      return text.setValue(String((_a = this.plugin.settings[key]) != null ? _a : defaultValue)).onChange(async (value) => {
        this.plugin.settings[key] = value;
        await this.plugin.saveSettings();
      });
    });
  }
  createRegisterListSetting(containerEl, name, defaultValue, desc, key) {
    return new import_obsidian3.Setting(containerEl).setName(name).setDesc(desc).addText((text) => {
      var _a;
      return text.setValue(String((_a = this.plugin.settings[key]) != null ? _a : defaultValue)).onChange(async (value) => {
        this.plugin.settings[key] = value;
        await this.plugin.saveSettings();
      });
    });
  }
};

// src/utils/storage.ts
async function loadSettings(plugin) {
  var _a;
  return ((_a = await plugin.loadData()) == null ? void 0 : _a.settings) || defaultSettings;
}
async function saveSettings(plugin, settings) {
  const data = await plugin.loadData() || {};
  data.settings = settings;
  await plugin.saveData(data);
}
async function loadMarks(plugin) {
  var _a;
  return ((_a = await plugin.loadData()) == null ? void 0 : _a.marks) || [];
}
async function saveMarks(plugin, marks) {
  const data = await plugin.loadData() || {};
  data.marks = marks;
  await plugin.saveData(data);
}
async function loadLastChangedMark(plugin) {
  var _a;
  return ((_a = await plugin.loadData()) == null ? void 0 : _a.lastChangedMark) || [];
}
async function saveLastChangedMark(plugin, lastChangedMark) {
  const data = await plugin.loadData() || {};
  data.lastChangedMark = lastChangedMark;
  await plugin.saveData(data);
}
async function JSONschemaCheck(plugin) {
  const data = await plugin.loadData() || { schemaVersion: JSONschemaVersion };
  if (data.schemaVersion && data.schemaVersion === JSONschemaVersion) {
    return;
  }
  console.log("tether-marks: The data loaded is not in correct format. The plugin may not work correctly. This will usually happen after plugin update that changes JSON schema. ");
}

// src/main.ts
var VimMarksImpl = class extends import_obsidian4.Plugin {
  constructor() {
    super(...arguments);
    this.marks = [];
    this.lastChangedMark = null;
  }
  async onload() {
    await JSONschemaCheck(this);
    this.settings = await loadSettings(this);
    this.marks = await loadMarks(this);
    this.lastChangedMark = await loadLastChangedMark(this);
    this.addCommand({
      id: "set-global-mark",
      name: "Set mark",
      callback: () => setGlobalMark(this)
    });
    this.addCommand({
      id: "go-to-global-mark",
      name: "Go to mark",
      callback: () => goToGlobalMark(this)
    });
    this.addCommand({
      id: "delete-global-mark",
      name: "Delete mark",
      callback: () => deleteGlobalMark(this)
    });
    this.addCommand({
      id: "add-file-to-harpoon",
      name: "Add file to Harpoon",
      callback: () => addFileToHarpoon(this)
    });
    this.addCommand({
      id: "go-to-harpoon-mark",
      name: "Go to Harpoon mark",
      callback: () => goToHarpoonMark(this)
    });
    this.addSettingTab(new SettingsTab(this.app, this));
    console.log("loading tether-marks");
  }
  async saveSettings() {
    await saveSettings(this, this.settings);
  }
  async saveMarks(marks) {
    this.marks = marks;
    await saveMarks(this, marks);
  }
  async saveLastChangedMark(lastChangedMark) {
    this.lastChangedMark = lastChangedMark;
    await saveLastChangedMark(this, lastChangedMark);
  }
  onunload() {
    console.log("unloading tether-marks");
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3VpL01hcmtMaXN0TW9kYWwudHMiLCAic3JjL3V0aWxzL2RlZmF1bHRWYWx1ZXMudHMiLCAic3JjL3V0aWxzL21hcmtzLnRzIiwgInNyYy91dGlscy9rZXliaW5kcy50cyIsICJzcmMvdXRpbHMvb2JzaWRpYW5VdGlscy50cyIsICJzcmMvY29tbWFuZHMudHMiLCAic3JjL3VpL1NldHRpbmdzVGFiLnRzIiwgInNyYy91dGlscy9zdG9yYWdlLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBQbHVnaW4gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBzZXRHbG9iYWxNYXJrLCBnb1RvR2xvYmFsTWFyaywgZ29Ub0hhcnBvb25NYXJrLCBhZGRGaWxlVG9IYXJwb29uLCBkZWxldGVHbG9iYWxNYXJrIH0gZnJvbSAnLi9jb21tYW5kcyc7XG5pbXBvcnQgeyBTZXR0aW5nc1RhYiB9IGZyb20gJy4vdWkvU2V0dGluZ3NUYWInO1xuaW1wb3J0IHsgbG9hZFNldHRpbmdzLCBzYXZlU2V0dGluZ3MsIGxvYWRNYXJrcywgc2F2ZU1hcmtzLCBsb2FkTGFzdENoYW5nZWRNYXJrLCBzYXZlTGFzdENoYW5nZWRNYXJrLCBKU09Oc2NoZW1hQ2hlY2sgfSBmcm9tICcuL3V0aWxzL3N0b3JhZ2UnO1xuaW1wb3J0IHsgU2V0dGluZ3MsIE1hcmsgfSBmcm9tICcuL3R5cGVzL2luZGV4JztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmltTWFya3NJbXBsIGV4dGVuZHMgUGx1Z2luIHtcbiAgICBzZXR0aW5ncyE6IFNldHRpbmdzO1xuICAgIG1hcmtzOiBNYXJrW10gPSBbXTtcbiAgICBsYXN0Q2hhbmdlZE1hcms6IE1hcmsgfCBudWxsID0gbnVsbDtcblxuICAgIGFzeW5jIG9ubG9hZCgpIHtcbiAgICAgICAgYXdhaXQgSlNPTnNjaGVtYUNoZWNrKHRoaXMpO1xuXG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBhd2FpdCBsb2FkU2V0dGluZ3ModGhpcyk7XG4gICAgICAgIHRoaXMubWFya3MgPSBhd2FpdCBsb2FkTWFya3ModGhpcyk7XG4gICAgICAgIHRoaXMubGFzdENoYW5nZWRNYXJrID0gYXdhaXQgbG9hZExhc3RDaGFuZ2VkTWFyayh0aGlzKTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdzZXQtZ2xvYmFsLW1hcmsnLFxuICAgICAgICAgICAgbmFtZTogJ1NldCBtYXJrJyxcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiBzZXRHbG9iYWxNYXJrKHRoaXMpLFxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdnby10by1nbG9iYWwtbWFyaycsXG4gICAgICAgICAgICBuYW1lOiAnR28gdG8gbWFyaycsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4gZ29Ub0dsb2JhbE1hcmsodGhpcyksXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ2RlbGV0ZS1nbG9iYWwtbWFyaycsXG4gICAgICAgICAgICBuYW1lOiAnRGVsZXRlIG1hcmsnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IGRlbGV0ZUdsb2JhbE1hcmsodGhpcyksXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ2FkZC1maWxlLXRvLWhhcnBvb24nLFxuICAgICAgICAgICAgbmFtZTogJ0FkZCBmaWxlIHRvIEhhcnBvb24nLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IGFkZEZpbGVUb0hhcnBvb24odGhpcyksXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ2dvLXRvLWhhcnBvb24tbWFyaycsXG4gICAgICAgICAgICBuYW1lOiAnR28gdG8gSGFycG9vbiBtYXJrJyxcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiBnb1RvSGFycG9vbk1hcmsodGhpcyksXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgU2V0dGluZ3NUYWIodGhpcy5hcHAsIHRoaXMpKTtcblxuICAgICAgICBjb25zb2xlLmxvZygnbG9hZGluZyB0ZXRoZXItbWFya3MnKTtcbiAgICB9XG5cbiAgICBhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG4gICAgICAgIGF3YWl0IHNhdmVTZXR0aW5ncyh0aGlzLCB0aGlzLnNldHRpbmdzKTtcbiAgICB9XG5cbiAgICBhc3luYyBzYXZlTWFya3MobWFya3M6IE1hcmtbXSkge1xuICAgICAgICB0aGlzLm1hcmtzID0gbWFya3M7XG4gICAgICAgIGF3YWl0IHNhdmVNYXJrcyh0aGlzLCBtYXJrcyk7XG4gICAgfVxuXG4gICAgYXN5bmMgc2F2ZUxhc3RDaGFuZ2VkTWFyayhsYXN0Q2hhbmdlZE1hcms6IE1hcmspIHtcbiAgICAgICAgdGhpcy5sYXN0Q2hhbmdlZE1hcmsgPSBsYXN0Q2hhbmdlZE1hcms7XG4gICAgICAgIGF3YWl0IHNhdmVMYXN0Q2hhbmdlZE1hcmsodGhpcywgbGFzdENoYW5nZWRNYXJrKTtcbiAgICB9XG5cbiAgICBvbnVubG9hZCgpIHtcbiAgICAgICAgLy8gUG90ZW50aWFsIGNsZWFudXBcbiAgICAgICAgY29uc29sZS5sb2coJ3VubG9hZGluZyB0ZXRoZXItbWFya3MnKTtcbiAgICB9XG59IiwgImltcG9ydCB7IEFwcCwgTm90aWNlLCBTdWdnZXN0TW9kYWwsIFBsYXRmb3JtIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IFZpbU1hcmtzSW1wbCBmcm9tICcuLi9tYWluJztcbmltcG9ydCB7IE1vZGFsS2V5YmluZHMsIE1hcmsgfSBmcm9tICcuLi90eXBlcy9pbmRleCc7XG5pbXBvcnQgeyBtb2RhbEluc3RydWN0aW9uRWxDbGFzcywgbW9kYWxNYXJrRmlsZXBhdGhDbGFzcywgbW9kYWxNYXJrU3ltYm9sQ2xhc3MsIE1vZGUsIG1vZGFsUGxhY2Vob2xkZXJNZXNzYWdlcyB9IGZyb20gJy4uL3V0aWxzL2RlZmF1bHRWYWx1ZXMnO1xuaW1wb3J0IHsgZmluZEZpcnN0VW51c2VkUmVnaXN0ZXIsIGdldE1hcmtCeVN5bWJvbCwgZ2V0U29ydGVkQW5kRmlsdGVyZWRNYXJrcywgcmVtb3ZlR2Fwc0ZvckhhcnBvb25NYXJrcywgcmVzdG9yZUxhc3RDaGFuZ2VkTWFyaywgc2V0TmV3T3JPdmVyd3JpdGVNYXJrIH0gZnJvbSAnLi4vdXRpbHMvbWFya3MnO1xuaW1wb3J0IHsgbWF0Y2hLZXliaW5kLCBwcmVwYXJlS2V5YmluZHMgfSBmcm9tICcuLi91dGlscy9rZXliaW5kcyc7XG5pbXBvcnQgeyBuYXZpZ2F0ZVRvT3BlbkZpbGVCeVBhdGgsIG9wZW5OZXdGaWxlIGFzIG9wZW5OZXdGaWxlQnlQYXRoIH0gZnJvbSAnLi4vdXRpbHMvb2JzaWRpYW5VdGlscyc7XG5cblxuZXhwb3J0IGNsYXNzIE1hcmtMaXN0TW9kYWwgZXh0ZW5kcyBTdWdnZXN0TW9kYWw8TWFyaz4ge1xuICAgIHBsdWdpbjogVmltTWFya3NJbXBsO1xuICAgIG1vZGU6IE1vZGU7XG4gICAgcHJpdmF0ZSBfa2V5SGFuZGxlcj86IChldnQ6IEtleWJvYXJkRXZlbnQpID0+IHZvaWQ7XG4gICAgaXNIYXJwb29uTW9kZTogYm9vbGVhbjtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFZpbU1hcmtzSW1wbCwgbW9kZTogTW9kZSwgaXNIYXJwb29uTW9kZTogYm9vbGVhbiA9IGZhbHNlKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgICAgICB0aGlzLm1vZGUgPSBtb2RlO1xuICAgICAgICAvLyB0aGlzLm1hcmtzID0gcGx1Z2luLm1hcmtzO1xuICAgICAgICB0aGlzLnNldFBsYWNlaG9sZGVyKG1vZGFsUGxhY2Vob2xkZXJNZXNzYWdlc1t0aGlzLm1vZGVdKTtcbiAgICAgICAgLy8gdGhpcy5zZXRJbnN0cnVjdGlvbnMoW3tjb21tYW5kOiAndmltLW1hcmtzOm1hcmstbGlzdCcsIHB1cnBvc2U6IFwiYXNkZlwifV0pO1xuICAgICAgICB0aGlzLmlzSGFycG9vbk1vZGUgPSBpc0hhcnBvb25Nb2RlOyAvLyBEZWZhdWx0IHRvIGZhbHNlLCBjYW4gYmUgc2V0IGV4dGVybmFsbHlcbiAgICB9XG5cbiAgICBnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogTWFya1tdIHtcbiAgICAgICAgLy8gTm8gc2VhcmNoIGlucHV0LCBhbHdheXMgc2hvdyBhbGwgbWFya3NcbiAgICAgICAgcmV0dXJuIGdldFNvcnRlZEFuZEZpbHRlcmVkTWFya3ModGhpcy5wbHVnaW4ubWFya3MsIHRoaXMuaXNIYXJwb29uTW9kZSwgdGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuICAgIH1cblxuICAgIHJlbmRlclN1Z2dlc3Rpb24obWFyazogTWFyaywgZWw6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIGVsLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiBtYXJrLnN5bWJvbCwgY2xzOiBtb2RhbE1hcmtTeW1ib2xDbGFzcyB9KTtcbiAgICAgICAgZWwuY3JlYXRlRWwoJ3NwYW4nLCB7IHRleHQ6IG1hcmsuZmlsZVBhdGgsIGNsczogbW9kYWxNYXJrRmlsZXBhdGhDbGFzcyB9KTtcbiAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoZXZ0KSA9PiB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLm9uQ2hvb3NlU3VnZ2VzdGlvbihtYXJrLCBldnQpO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBPdmVycmlkZSB0byBoaWRlIHRoZSBpbnB1dCBib3hcbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIHN1cGVyLm9uT3BlbigpO1xuICAgICAgICBpZiAodGhpcy5pbnB1dEVsKSB7XG4gICAgICAgICAgICB0aGlzLmlucHV0RWwuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1vZGFsRWwuYWRkQ2xhc3MoJ21hcmtzLW1vZGFsJyk7XG5cbiAgICAgICAgY29uc3QgbW9kYWxLZXliaW5kcyA9IHByZXBhcmVLZXliaW5kcyhQbGF0Zm9ybS5pc01hY09TLCB0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XG5cbiAgICAgICAgLy8gUHJvbXB0IGluc3RydWN0aW9ucyBwYW5lbFxuICAgICAgICBjb25zdCBtb2RhbEluc3RydWN0aW9ucyA9IHRoaXMucHJlcGFyZU1vZGFsSW5zdHJ1Y3Rpb25FbGVtZW50KG1vZGFsS2V5YmluZHMpO1xuXG4gICAgICAgIC8vIEluc2VydCBpbnN0cnVjdGlvbnMgcGFuZWwgYXQgdGhlIGJvdHRvbSBvZiB0aGUgbW9kYWxcbiAgICAgICAgdGhpcy5tb2RhbEVsLmFwcGVuZENoaWxkKG1vZGFsSW5zdHJ1Y3Rpb25zKTtcblxuICAgICAgICB0aGlzLl9rZXlIYW5kbGVyID0gdGhpcy5nZXRNb2RhbEtleUhhbmRsZXIobW9kYWxLZXliaW5kcyk7XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5fa2V5SGFuZGxlciwgdHJ1ZSk7XG4gICAgfVxuXG4gICAgb25DbG9zZSgpIHtcbiAgICAgICAgLy8gUmVtb3ZlIGluc3RydWN0aW9ucyBwYW5lbCBpZiBwcmVzZW50XG4gICAgICAgIGNvbnN0IGluc3RydWN0aW9ucyA9IHRoaXMubW9kYWxFbC5xdWVyeVNlbGVjdG9yKFwiLlwiICsgbW9kYWxJbnN0cnVjdGlvbkVsQ2xhc3MpO1xuICAgICAgICBpZiAoaW5zdHJ1Y3Rpb25zKSBpbnN0cnVjdGlvbnMucmVtb3ZlKCk7XG5cbiAgICAgICAgaWYgKHRoaXMuX2tleUhhbmRsZXIpIHtcbiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5fa2V5SGFuZGxlciwgdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLl9rZXlIYW5kbGVyID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHN1cGVyLm9uQ2xvc2UoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHByZXBhcmVNb2RhbEluc3RydWN0aW9uRWxlbWVudChrZXliaW5kczogTW9kYWxLZXliaW5kcykge1xuICAgICAgICBjb25zdCBpbnN0cnVjdGlvbnMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgaW5zdHJ1Y3Rpb25zLmFkZENsYXNzKG1vZGFsSW5zdHJ1Y3Rpb25FbENsYXNzKTtcbiAgICAgICAgLy8gSGVscGVyIHRvIGZvcm1hdCBrZXliaW5kcyBmb3IgZGlzcGxheVxuICAgICAgICBjb25zdCBmb3JtYXRLZXlzID0gKGtleXM6IHN0cmluZ1tdKSA9PiBrZXlzLm1hcChcbiAgICAgICAgICAgIGsgPT4gYDxrYmQ+JHtrLnJlcGxhY2UoJ2NtZCcsICdcdTIzMTgnKS5yZXBsYWNlKCdjdHJsJywgJ0N0cmwnKS5yZXBsYWNlKCdhbHQnLCAnQWx0JykucmVwbGFjZSgnc2hpZnQnLCAnU2hpZnQnKX08L2tiZD5gXG4gICAgICAgICkuam9pbignLycpO1xuXG4gICAgICAgIGluc3RydWN0aW9ucy5pbm5lckhUTUwgPSBgXG4gICAgICAgICAgICA8c3Bhbj4ke2Zvcm1hdEtleXMoa2V5YmluZHMudXApfSA6IFVwPC9zcGFuPlxuICAgICAgICAgICAgPHNwYW4+JHtmb3JtYXRLZXlzKGtleWJpbmRzLmRvd24pfSA6IERvd248L3NwYW4+XG4gICAgICAgICAgICA8c3Bhbj4ke2Zvcm1hdEtleXMoa2V5YmluZHMuZGVsZXRlKX0gOiBEZWxldGU8L3NwYW4+XG4gICAgICAgICAgICA8c3Bhbj4ke2Zvcm1hdEtleXMoa2V5YmluZHMudW5kbyl9IDogVW5kbyBsYXN0IGNoYW5nZWQgbWFyazwvc3Bhbj5cbiAgICAgICAgICAgIDxzcGFuPjxrYmQ+U3ltYm9sPC9rYmQ+IDogSnVtcC9TZXQvRGVsZXRlPC9zcGFuPlxuICAgICAgICAgICAgPHNwYW4+PGtiZD5FbnRlcjwva2JkPiA6IENvbmZpcm08L3NwYW4+XG4gICAgICAgICAgICA8c3Bhbj48a2JkPkVzYzwva2JkPiA6IENsb3NlPC9zcGFuPlxuXG4gICAgICAgIGA7XG4gICAgICAgIHJldHVybiBpbnN0cnVjdGlvbnM7XG4gICAgfVxuXG4gICAgZ2V0TW9kYWxLZXlIYW5kbGVyKGtleWJpbmRzOiBNb2RhbEtleWJpbmRzKSB7XG4gICAgICAgIHJldHVybiBhc3luYyAoZXZ0OiBLZXlib2FyZEV2ZW50KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBhdmFpbGFibGVSZWdpc3RlcnMgPSBuZXcgU2V0KCghdGhpcy5pc0hhcnBvb25Nb2RlID8gdGhpcy5wbHVnaW4uc2V0dGluZ3MucmVnaXN0ZXJMaXN0IDogdGhpcy5wbHVnaW4uc2V0dGluZ3MuaGFycG9vblJlZ2lzdGVyTGlzdCkuc3BsaXQoJycpKTtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIGNvbnN0IGNob29zZXIgPSB0aGlzLmNob29zZXI7XG4gICAgICAgICAgICBpZiAoa2V5YmluZHMudXAuc29tZShrYiA9PiBtYXRjaEtleWJpbmQoZXZ0LCBrYikpKSB7XG4gICAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5tb3ZlU2VsZWN0aW9uKC0xKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoa2V5YmluZHMuZG93bi5zb21lKGtiID0+IG1hdGNoS2V5YmluZChldnQsIGtiKSkpIHtcbiAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1vdmVTZWxlY3Rpb24oMSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGtleWJpbmRzLmRlbGV0ZS5zb21lKGtiID0+IG1hdGNoS2V5YmluZChldnQsIGtiKSkpIHtcbiAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAvLyBEZWxldGUgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCBtYXJrXG4gICAgICAgICAgICAgICAgY29uc3QgcHJldklkeCA9IGNob29zZXIuc2VsZWN0ZWRJdGVtO1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkOiBNYXJrID0gY2hvb3Nlci52YWx1ZXNbcHJldklkeF07XG4gICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZGVsZXRlTWFyayhzZWxlY3RlZCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIFJlZnJlc2ggdGhlIG1vZGFsIGxpc3RcbiAgICAgICAgICAgICAgICAgICAgY2hvb3Nlci52YWx1ZXMgPSBnZXRTb3J0ZWRBbmRGaWx0ZXJlZE1hcmtzKHRoaXMucGx1Z2luLm1hcmtzLCB0aGlzLmlzSGFycG9vbk1vZGUsIHRoaXMucGx1Z2luLnNldHRpbmdzKTtcbiAgICAgICAgICAgICAgICAgICAgY2hvb3Nlci5zZXRTdWdnZXN0aW9ucyhjaG9vc2VyLnZhbHVlcyk7XG4gICAgICAgICAgICAgICAgICAgIC8vIFByZXNlcnZlIHNlbGVjdGlvbiBpbmRleFxuICAgICAgICAgICAgICAgICAgICBsZXQgbmV3SWR4ID0gcHJldklkeDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld0lkeCA+PSBjaG9vc2VyLnZhbHVlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0lkeCA9IGNob29zZXIudmFsdWVzLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2hvb3Nlci5zZXRTZWxlY3RlZEl0ZW0oTWF0aC5tYXgoMCwgbmV3SWR4KSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBlbHNlIGlmIChrZXliaW5kcy51bmRvLnNvbWUoa2IgPT4gdGhpcy5tYXRjaEtleWJpbmQoZXZ0LCBrYikpKSB7XG4gICAgICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChrZXliaW5kcy5lbnRlci5zb21lKGtiID0+IG1hdGNoS2V5YmluZChldnQsIGtiKSkpIHtcbiAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAvLyBEZWxldGUgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCBtYXJrXG4gICAgICAgICAgICAgICAgY29uc3QgaW5kID0gY2hvb3Nlci5zZWxlY3RlZEl0ZW07XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWQ6IE1hcmsgPSBjaG9vc2VyLnZhbHVlc1tpbmRdO1xuICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uQ2hvb3NlU3VnZ2VzdGlvbihzZWxlY3RlZCwgZXZ0KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGtleWJpbmRzLnVuZG8uc29tZShrYiA9PiBtYXRjaEtleWJpbmQoZXZ0LCBrYikpKSB7XG4gICAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgLy8gUmVzdG9yZSB0aGUgbGFzdCBjaGFuZ2VkIG1hcmtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnJlc3RvcmVMYXN0Q2hhbmdlZE1hcmsoKTtcbiAgICAgICAgICAgICAgICAvLyBSZWZyZXNoIHRoZSBtb2RhbCBsaXN0XG4gICAgICAgICAgICAgICAgY2hvb3Nlci52YWx1ZXMgPSBnZXRTb3J0ZWRBbmRGaWx0ZXJlZE1hcmtzKHRoaXMucGx1Z2luLm1hcmtzLCB0aGlzLmlzSGFycG9vbk1vZGUsIHRoaXMucGx1Z2luLnNldHRpbmdzKTtcbiAgICAgICAgICAgICAgICBjaG9vc2VyLnNldFN1Z2dlc3Rpb25zKGNob29zZXIudmFsdWVzKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYXZhaWxhYmxlUmVnaXN0ZXJzLmhhcyhldnQua2V5KSkge1xuICAgICAgICAgICAgICAgIGxldCBtYXJrID0gZ2V0TWFya0J5U3ltYm9sKHRoaXMucGx1Z2luLm1hcmtzLCBldnQua2V5KTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5tb2RlID09PSAnc2V0Jykge1xuICAgICAgICAgICAgICAgICAgICBpZiAobWFyayA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgYSBuZXcgbWFyayBmb3IgdGhpcyBrZXkgc3ltYm9sXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZmlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ05vIGFjdGl2ZSBmaWxlIHRvIG1hcmsuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgbWFyayA9IHsgc3ltYm9sOiBldnQua2V5LCBmaWxlUGF0aDogZmlsZS5wYXRoIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMub25DaG9vc2VTdWdnZXN0aW9uKG1hcmssIGV2dCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMubW9kZSA9PT0gJ2dvdG8nICYmIG1hcmspIHtcbiAgICAgICAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMub25DaG9vc2VTdWdnZXN0aW9uKG1hcmssIGV2dCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5tb2RlID09PSAnZGVsZXRlJyAmJiBtYXJrKSB7XG4gICAgICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLm9uQ2hvb3NlU3VnZ2VzdGlvbihtYXJrLCBldnQpO1xuICAgICAgICAgICAgICAgICAgICAvLyBSZWZyZXNoIHRoZSBtb2RhbCBsaXN0XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgYXN5bmMgb25DaG9vc2VTdWdnZXN0aW9uKG1hcms6IE1hcmssIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgaWYgKHRoaXMubW9kZSA9PT0gJ3NldCcpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0TmV3T3JPdmVyd3JpdGVNYXJrKG1hcmspO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMubW9kZSA9PT0gJ2dvdG8nKSB7XG4gICAgICAgICAgICB0aGlzLmdvVG9NYXJrKG1hcmspO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMubW9kZSA9PT0gJ2RlbGV0ZScpIHtcbiAgICAgICAgICAgIHRoaXMuZGVsZXRlTWFyayhtYXJrKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG1vdmVTZWxlY3Rpb24oZGVsdGE6IG51bWJlcikge1xuICAgICAgICAvLyBNb3ZlIHRoZSBzZWxlY3Rpb24gdXAgb3IgZG93biBieSBkZWx0YVxuICAgICAgICAvLyB0aGlzLmNob29zZXIgaXMgU3VnZ2VzdE1vZGFsJ3MgaW50ZXJuYWwgY2hvb3NlclxuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGNvbnN0IGNob29zZXIgPSB0aGlzLmNob29zZXI7XG4gICAgICAgIGlmICghY2hvb3NlcikgcmV0dXJuO1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGxldCBpZHggPSBjaG9vc2VyLnNlbGVjdGVkSXRlbTtcbiAgICAgICAgaWYgKHR5cGVvZiBpZHggIT09ICdudW1iZXInKSBpZHggPSAwO1xuICAgICAgICBjb25zdCBtYXggPSBjaG9vc2VyLnZhbHVlcy5sZW5ndGg7XG4gICAgICAgIGxldCBuZXh0ID0gaWR4ICsgZGVsdGE7XG4gICAgICAgIGlmIChuZXh0IDwgMCkgbmV4dCA9IG1heCAtIDE7XG4gICAgICAgIGlmIChuZXh0ID49IG1heCkgbmV4dCA9IDA7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgY2hvb3Nlci5zZXRTZWxlY3RlZEl0ZW0obmV4dCwgMCBhcyBLZXlib2FyZEV2ZW50KTtcbiAgICB9XG5cbiAgICBhc3luYyBzZXROZXdPck92ZXJ3cml0ZU1hcmsobWFyazogTWFyaykge1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKCFmaWxlKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdObyBhY3RpdmUgZmlsZSB0byBtYXJrLicpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG1hcmtzID0gc2V0TmV3T3JPdmVyd3JpdGVNYXJrKHRoaXMucGx1Z2luLm1hcmtzLCBtYXJrLCBmaWxlLnBhdGgpO1xuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlTWFya3MobWFya3MpO1xuICAgICAgICBuZXcgTm90aWNlKGBTZXQgbWFyayAnJHttYXJrLnN5bWJvbH0nIHRvICR7ZmlsZS5uYW1lfWApO1xuICAgIH1cblxuICAgIGdvVG9NYXJrKG1hcms6IE1hcmspIHtcbiAgICAgICAgY29uc3Qgc3VjY2VzcyA9IG5hdmlnYXRlVG9PcGVuRmlsZUJ5UGF0aChtYXJrLmZpbGVQYXRoLCB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leHBlcmltZW50YWxHb3RvLCB0aGlzLmFwcCk7XG4gICAgICAgIC8vIElmIGZpbGUgbm90IG9wZW4sIHRoZW4gb3BlbiBpdCBpbiB0aGUgcHJlZmVycmVkIHRhYlxuICAgICAgICBpZiAoIXN1Y2Nlc3MpIHtcbiAgICAgICAgICAgIG9wZW5OZXdGaWxlQnlQYXRoKG1hcmsuZmlsZVBhdGgsIHRoaXMucGx1Z2luLnNldHRpbmdzLm9wZW5NYXJrSW5OZXdUYWIsIHRoaXMuYXBwKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgZGVsZXRlTWFyayhtYXJrOiBNYXJrKSB7XG4gICAgICAgIGNvbnN0IGNNYXJrID0geyAuLi5tYXJrIH07XG4gICAgICAgIGNvbnN0IGZpbHRlcmVkTWFya3MgPSB0aGlzLnBsdWdpbi5tYXJrcy5maWx0ZXIobSA9PiBtLnN5bWJvbCAhPT0gY01hcmsuc3ltYm9sKTtcbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZU1hcmtzKGZpbHRlcmVkTWFya3MpO1xuXG4gICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5oYXJwb29uUmVnaXN0ZXJHYXBSZW1vdmFsKSB7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUdhcHNGb3JIYXJwb29uTWFya3MoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIG5ldyBOb3RpY2UoYERlbGV0ZWQgbWFyayAnJHtjTWFyay5zeW1ib2x9J2ApO1xuICAgIH07XG5cbiAgICBhc3luYyByZXN0b3JlTGFzdENoYW5nZWRNYXJrKCkge1xuICAgICAgICAvLyBVbmRvIHRoZSBsYXN0IGNoYW5nZWQgbWFya1xuICAgICAgICAvLyBidWdneVxuICAgICAgICBpZiAodGhpcy5wbHVnaW4ubGFzdENoYW5nZWRNYXJrKSB7XG4gICAgICAgICAgICBjb25zdCBvdXQgPSByZXN0b3JlTGFzdENoYW5nZWRNYXJrKHRoaXMucGx1Z2luLm1hcmtzLCB0aGlzLnBsdWdpbi5sYXN0Q2hhbmdlZE1hcmspXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlTWFya3Mob3V0Lm1hcmtzKTtcbiAgICAgICAgICAgIGlmIChvdXQubWFya1RvRGlzY2FyZCkge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYFJlc3RvcmVkIG1hcmsgJyR7dGhpcy5wbHVnaW4ubGFzdENoYW5nZWRNYXJrLnN5bWJvbH0nIHRvICR7dGhpcy5wbHVnaW4ubGFzdENoYW5nZWRNYXJrLmZpbGVQYXRofWApO1xuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVMYXN0Q2hhbmdlZE1hcmsob3V0Lm1hcmtUb0Rpc2NhcmQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnTm8gbGFzdCBjaGFuZ2VkIG1hcmsgdG8gcmVzdG9yZS4nKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFkZEZpbGVUb0hhcnBvb24oKSB7XG4gICAgICAgIC8vIEFkZCB0aGUgc2VsZWN0ZWQgbWFyayB0byB0aGUgSGFycG9vbiBsaXN0XG4gICAgICAgIGNvbnN0IGhhcnBvb25SZWdpc3RlcnMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5oYXJwb29uUmVnaXN0ZXJMaXN0LnNwbGl0KCcnKTtcbiAgICAgICAgY29uc3QgcmVnID0gZmluZEZpcnN0VW51c2VkUmVnaXN0ZXIodGhpcy5wbHVnaW4ubWFya3MsIGhhcnBvb25SZWdpc3RlcnMpO1xuXG4gICAgICAgIGlmICghcmVnKSB7XG4gICAgICAgICAgICAvLyBJZiBhbGwgcmVnaXN0ZXJzIGFyZSB1c2VkLCBzaG93IGEgbm90aWNlXG4gICAgICAgICAgICBuZXcgTm90aWNlKCdIYXJwb29uIHJlZ2lzdGVycyBhcmUgZnVsbCwgY2Fubm90IGFkZCBtb3JlIG1hcmtzLicpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zZXROZXdPck92ZXJ3cml0ZU1hcmsoeyBzeW1ib2w6IHJlZywgZmlsZVBhdGg6IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk/LnBhdGggfHwgJycgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyByZW1vdmVHYXBzRm9ySGFycG9vbk1hcmtzKCkge1xuICAgICAgICBjb25zdCBoYXJwb29uUmVnaXN0ZXJzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuaGFycG9vblJlZ2lzdGVyTGlzdC5zcGxpdCgnJyk7XG4gICAgICAgIGNvbnN0IG1hcmtzID0gcmVtb3ZlR2Fwc0ZvckhhcnBvb25NYXJrcyh0aGlzLnBsdWdpbi5tYXJrcywgaGFycG9vblJlZ2lzdGVycyk7XG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVNYXJrcyhtYXJrcyk7XG4gICAgfVxuXG59IiwgImltcG9ydCB7IE1vZGFsS2V5YmluZHMgfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuXHJcbmV4cG9ydCBjb25zdCBtb2RhbERlZmF1bHRLZXliaW5kczogTW9kYWxLZXliaW5kcyA9IHtcclxuICAgIHVwOiBbJ2N0cmwraycsICdjdHJsK3AnXSBhcyBzdHJpbmdbXSxcclxuICAgIGRvd246IFsnY3RybCtqJywgJ2N0cmwrbiddIGFzIHN0cmluZ1tdLFxyXG4gICAgZGVsZXRlOiBbJ2N0cmwrZCddIGFzIHN0cmluZ1tdLFxyXG4gICAgdW5kbzogWydjdHJsK3UnXSBhcyBzdHJpbmdbXSxcclxuICAgIGVudGVyOiBbJ0VudGVyJ10gYXMgc3RyaW5nW11cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IG1vZGFsRGVmYXVsdEtleWJpbmRzTWFjOiBNb2RhbEtleWJpbmRzID0ge1xyXG4gICAgdXA6IFsnY21kK2snLCAnY21kK3AnXSBhcyBzdHJpbmdbXSxcclxuICAgIGRvd246IFsnY21kK2onLCAnY21kK24nXSBhcyBzdHJpbmdbXSxcclxuICAgIGRlbGV0ZTogWydjbWQrZCddIGFzIHN0cmluZ1tdLFxyXG4gICAgdW5kbzogWydjbWQrdSddIGFzIHN0cmluZ1tdLFxyXG4gICAgZW50ZXI6IFsnRW50ZXInXSBhcyBzdHJpbmdbXVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgbW9kYWxQbGFjZWhvbGRlck1lc3NhZ2VzID0ge1xyXG4gICAgc2V0OiAnU2VsZWN0IGEgbWFyayB0byBzZXQnLFxyXG4gICAgZ290bzogJ1NlbGVjdCBhIG1hcmsgdG8gZ28gdG8nLFxyXG4gICAgZGVsZXRlOiAnU2VsZWN0IGEgbWFyayB0byBkZWxldGUnLFxyXG59O1xyXG5cclxuZXhwb3J0IHR5cGUgTW9kZSA9ICdzZXQnIHwgJ2dvdG8nIHwgJ2RlbGV0ZSc7XHJcblxyXG5leHBvcnQgY29uc3QgZGVmYXVsdFNldHRpbmdzID0ge1xyXG4gICAgaGlkZU1hcmtMaXN0RHVyaW5nSW5wdXQ6IGZhbHNlLFxyXG4gICAgbW9kYWxMaXN0VXA6ICcnLFxyXG4gICAgbW9kYWxMaXN0RG93bjogJycsXHJcbiAgICBtb2RhbExpc3RTZWxlY3Q6ICcnLFxyXG4gICAgbW9kYWxDaGFuZ2VVbmRvOiAnJyxcclxuICAgIG1vZGFsTGlzdERlbGV0ZTogJycsXHJcbiAgICBvcGVuTWFya0luTmV3VGFiOiBmYWxzZSwgLy8gSWYgdHJ1ZSwgb3BlbiBtYXJrIGluIG5ldyB0YWIsIGVsc2UgaW4gY3VycmVudCB0YWJcclxuICAgIHJlZ2lzdGVyTGlzdDogJ2FiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6JyxcclxuICAgIHJlZ2lzdGVyU29ydEJ5TGlzdDogdHJ1ZSxcclxuICAgIGhhcnBvb25SZWdpc3Rlckxpc3Q6ICdxd2VyJyxcclxuICAgIGhhcnBvb25SZWdpc3RlclNvcnRCeUxpc3Q6IHRydWUsXHJcbiAgICBoYXJwb29uUmVnaXN0ZXJHYXBSZW1vdmFsOiB0cnVlLFxyXG4gICAgZXhwZXJpbWVudGFsR290bzogZmFsc2UsXHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgbW9kYWxJbnN0cnVjdGlvbkVsQ2xhc3MgPSAnbW9kYWwtaW5zdHJ1Y3Rpb24tZWwnO1xyXG5leHBvcnQgY29uc3QgbW9kYWxNYXJrU3ltYm9sQ2xhc3MgPSAnbWFyay1zeW1ib2wnO1xyXG5leHBvcnQgY29uc3QgbW9kYWxNYXJrRmlsZXBhdGhDbGFzcyA9ICdtYXJrLWZpbGUtcGF0aCc7XHJcblxyXG5leHBvcnQgY29uc3QgSlNPTnNjaGVtYVZlcnNpb24gPSAxOyIsICJpbXBvcnQgeyBTZXR0aW5ncyB9IGZyb20gJy4uL3R5cGVzL2luZGV4JztcclxuaW1wb3J0IHsgTWFyayB9IGZyb20gJy4uL3R5cGVzL2luZGV4JztcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBmaW5kRmlyc3RVbnVzZWRSZWdpc3RlcihtYXJrczogTWFya1tdLCByZWdpc3RlcnM6IHN0cmluZ1tdKTogc3RyaW5nIHwgbnVsbCB7XHJcbiAgICBmb3IgKGNvbnN0IHJlZyBvZiByZWdpc3RlcnMpIHtcclxuICAgICAgICAvLyBpZiByZWdpc3RlciBub3QgdXNlZCBhbHJlYWR5LCB0aGVuIHVzZSBpdFxyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdDaGVja2luZyByZWdpc3RlcjonLCByZWcpO1xyXG4gICAgICAgIGlmICghKG1hcmtzLm1hcChtID0+IG0uc3ltYm9sKS5pbmNsdWRlcyhyZWcpKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0TWFya0J5U3ltYm9sKG1hcmtzOiBNYXJrW10sIHN5bWJvbDogc3RyaW5nKTogTWFyayB8IHVuZGVmaW5lZCB7XHJcbiAgICByZXR1cm4gbWFya3MuZmluZChtID0+IG0uc3ltYm9sID09PSBzeW1ib2wpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc29ydE1hcmtzQWxwaGFiZXRpY2FsbHkobWFya3M6IE1hcmtbXSkge1xyXG4gICAgbWFya3Muc29ydCgoYSwgYikgPT4gYS5zeW1ib2wubG9jYWxlQ29tcGFyZShiLnN5bWJvbCkpXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRTb3J0ZWRBbmRGaWx0ZXJlZE1hcmtzKG1hcmtzOiBNYXJrW10sIGlzSGFycG9vbk1vZGU6IGJvb2xlYW4sIHNldHRpbmdzOiBTZXR0aW5ncyk6IE1hcmtbXSB7XHJcbiAgICBjb25zdCBhdmFpbGFibGVSZWdpc3RlcnMgPSBuZXcgU2V0KCghaXNIYXJwb29uTW9kZSA/IHNldHRpbmdzLnJlZ2lzdGVyTGlzdCA6IHNldHRpbmdzLmhhcnBvb25SZWdpc3Rlckxpc3QpLnNwbGl0KCcnKSk7XHJcbiAgICBjb25zdCBmaWx0ZXJlZE1hcmtzOiBNYXJrW10gPSBtYXJrcy5maWx0ZXIoZWwgPT4gYXZhaWxhYmxlUmVnaXN0ZXJzLmhhcyhlbC5zeW1ib2wpKTtcclxuICAgIGlmICghaXNIYXJwb29uTW9kZSAmJiBzZXR0aW5ncy5yZWdpc3RlclNvcnRCeUxpc3QpIHtcclxuICAgICAgICAvLyBTb3J0IG1hcmtzIGJ5IHRoZSBvcmRlciBvZiB0aGUga2V5IHN5bWJvbHMgaW4gdGhlIHJlZ2lzdGVyIGxpc3RcclxuICAgICAgICBjb25zdCByZWdpc3Rlckxpc3QgPSBzZXR0aW5ncy5yZWdpc3Rlckxpc3Q7XHJcbiAgICAgICAgc29ydE1hcmtzQnlTZXR0aW5nc1JlZ2lzdGVyT3JkZXIoZmlsdGVyZWRNYXJrcywgcmVnaXN0ZXJMaXN0KTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlzSGFycG9vbk1vZGUgJiYgc2V0dGluZ3MuaGFycG9vblJlZ2lzdGVyU29ydEJ5TGlzdCkge1xyXG4gICAgICAgIC8vIFNvcnQgbWFya3MgYnkgdGhlIG9yZGVyIG9mIHRoZSBrZXkgc3ltYm9scyBpbiB0aGUgaGFycG9vbiByZWdpc3RlciBsaXN0XHJcbiAgICAgICAgY29uc3QgcmVnaXN0ZXJMaXN0ID0gc2V0dGluZ3MuaGFycG9vblJlZ2lzdGVyTGlzdDtcclxuICAgICAgICBzb3J0TWFya3NCeVNldHRpbmdzUmVnaXN0ZXJPcmRlcihmaWx0ZXJlZE1hcmtzLCByZWdpc3Rlckxpc3QpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgc29ydE1hcmtzQWxwaGFiZXRpY2FsbHkoZmlsdGVyZWRNYXJrcyk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmlsdGVyZWRNYXJrcztcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNvcnRNYXJrc0J5U2V0dGluZ3NSZWdpc3Rlck9yZGVyKG1hcmtzOiBNYXJrW10sIHJlZ2lzdGVyczogc3RyaW5nIHwgc3RyaW5nW10pIHtcclxuICAgIGNvbnN0IHJlZ2lzdGVyT3JkZXIgPSBuZXcgTWFwKFsuLi5yZWdpc3RlcnNdLm1hcCgoc3ltYm9sLCBpbmRleCkgPT4gW3N5bWJvbCwgaW5kZXhdKSk7XHJcbiAgICBtYXJrcy5zb3J0KChhLCBiKSA9PiAocmVnaXN0ZXJPcmRlci5nZXQoYS5zeW1ib2wpID8/IEluZmluaXR5KSAtIChyZWdpc3Rlck9yZGVyLmdldChiLnN5bWJvbCkgPz8gSW5maW5pdHkpKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUdhcHNGb3JIYXJwb29uTWFya3MobWFya3NUb0NvcHk6IE1hcmtbXSwgaGFycG9vblJlZ2lzdGVyczogc3RyaW5nW10pOiBNYXJrW10ge1xyXG4gICAgbGV0IG1hcmtzID0gWy4uLm1hcmtzVG9Db3B5XTtcclxuXHJcbiAgICBsZXQgbGVmdEN1ciA9IDA7XHJcbiAgICBsZXQgcmlnaHRDdXIgPSAwO1xyXG5cclxuICAgIHdoaWxlIChyaWdodEN1ciA8IGhhcnBvb25SZWdpc3RlcnMubGVuZ3RoKSB7XHJcbiAgICAgICAgY29uc3QgbWFya0VsID0gbWFya3MuZmluZChlbCA9PiBlbC5zeW1ib2wgPT09IGhhcnBvb25SZWdpc3RlcnNbcmlnaHRDdXJdKTtcclxuXHJcbiAgICAgICAgaWYgKG1hcmtFbCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHN5bWJvbFRvU2V0VG8gPSBoYXJwb29uUmVnaXN0ZXJzW2xlZnRDdXJdO1xyXG4gICAgICAgICAgICBsZXQgZmlsdGVyZWRNYXJrcyA9IG1hcmtzLmZpbHRlcihlbCA9PiBlbC5zeW1ib2wgIT09IGhhcnBvb25SZWdpc3RlcnNbbGVmdEN1cl0pO1xyXG4gICAgICAgICAgICBmaWx0ZXJlZE1hcmtzLnB1c2goeyBzeW1ib2w6IHN5bWJvbFRvU2V0VG8sIGZpbGVQYXRoOiBtYXJrRWwuZmlsZVBhdGggfSlcclxuICAgICAgICAgICAgbWFya3MgPSBmaWx0ZXJlZE1hcmtzO1xyXG4gICAgICAgICAgICBsZWZ0Q3VyICs9IDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJpZ2h0Q3VyICs9IDE7XHJcbiAgICB9XHJcblxyXG4gICAgd2hpbGUgKGxlZnRDdXIgPCBoYXJwb29uUmVnaXN0ZXJzLmxlbmd0aCkge1xyXG4gICAgICAgIG1hcmtzID0gbWFya3MuZmlsdGVyKGVsID0+IGVsLnN5bWJvbCAhPT0gaGFycG9vblJlZ2lzdGVyc1tsZWZ0Q3VyXSk7XHJcbiAgICAgICAgbGVmdEN1ciArPSAxO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBtYXJrcztcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJlc3RvcmVMYXN0Q2hhbmdlZE1hcmsobWFya3M6IE1hcmtbXSwgbGFzdENoYW5nZWRNYXJrIDogTWFyaykgOiB7bWFya3M6IE1hcmtbXSwgbWFya1RvRGlzY2FyZDogTWFyayB8IHVuZGVmaW5lZH0ge1xyXG4gICAgY29uc3QgbWFya1RvUmVzdG9yZSA9IHsgLi4ubGFzdENoYW5nZWRNYXJrIH07XHJcbiAgICBjb25zdCBtYXJrVG9EaXNjYXJkID0gbWFya3MuZmluZChtID0+IG0uc3ltYm9sID09PSBtYXJrVG9SZXN0b3JlLnN5bWJvbCk7XHJcbiAgICBjb25zdCBtYXJrc1dpdGhvdXREaXNjYXJkZWQgPSBtYXJrcy5maWx0ZXIobSA9PiBtLnN5bWJvbCAhPT0gbWFya1RvUmVzdG9yZS5zeW1ib2wpO1xyXG5cclxuICAgIG1hcmtzV2l0aG91dERpc2NhcmRlZC5wdXNoKHsgc3ltYm9sOiBtYXJrVG9SZXN0b3JlLnN5bWJvbCwgZmlsZVBhdGg6IG1hcmtUb1Jlc3RvcmUuZmlsZVBhdGggfSk7XHJcbiAgICByZXR1cm4ge21hcmtzOiBtYXJrc1dpdGhvdXREaXNjYXJkZWQsIG1hcmtUb0Rpc2NhcmQ6IG1hcmtUb0Rpc2NhcmR9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzZXROZXdPck92ZXJ3cml0ZU1hcmsobWFya3M6IE1hcmtbXSwgc2V0TWFyayA6IE1hcmssIGZpbGVQYXRoIDogc3RyaW5nKSA6IE1hcmtbXXtcclxuICAgIGNvbnN0IG91dE1hcmtzID0gbWFya3MuZmlsdGVyKChtKSA9PiBtLnN5bWJvbCAhPT0gc2V0TWFyay5zeW1ib2wpO1xyXG4gICAgb3V0TWFya3MucHVzaCh7IHN5bWJvbDogc2V0TWFyay5zeW1ib2wsIGZpbGVQYXRoOiBmaWxlUGF0aCB9KTtcclxuICAgIHJldHVybiBvdXRNYXJrcztcclxufSIsICJpbXBvcnQgeyBtb2RhbERlZmF1bHRLZXliaW5kcywgbW9kYWxEZWZhdWx0S2V5YmluZHNNYWMgfSBmcm9tIFwiLi9kZWZhdWx0VmFsdWVzXCI7XHJcbmltcG9ydCB7IE1vZGFsS2V5YmluZHMgfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuaW1wb3J0IHsgU2V0dGluZ3MgfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuXHJcbi8vIFV0aWxpdHkgdG8gcHJlcGFyZSBrZXliaW5kcyBvYmplY3RcclxuZXhwb3J0IGZ1bmN0aW9uIHByZXBhcmVLZXliaW5kcyhpc01hY09TOiBib29sZWFuLCBzZXR0aW5nczogU2V0dGluZ3MpIHtcclxuICAgIGxldCBrZXliaW5kczogTW9kYWxLZXliaW5kcyA9ICghaXNNYWNPUykgPyB7IC4uLm1vZGFsRGVmYXVsdEtleWJpbmRzIH0gOiB7IC4uLm1vZGFsRGVmYXVsdEtleWJpbmRzTWFjIH07XHJcblxyXG4gICAgaWYgKHNldHRpbmdzLm1hcmtMaXN0VXApIHtcclxuICAgICAgICBrZXliaW5kcy51cCA9IFtzZXR0aW5ncy5tYXJrTGlzdFVwXTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoc2V0dGluZ3MubWFya0xpc3REb3duKSB7XHJcbiAgICAgICAga2V5YmluZHMuZG93biA9IFtzZXR0aW5ncy5tYXJrTGlzdERvd25dO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChzZXR0aW5ncy5tYXJrTGlzdERlbGV0ZSkge1xyXG4gICAgICAgIGtleWJpbmRzLmRlbGV0ZSA9IFtzZXR0aW5ncy5tYXJrTGlzdERlbGV0ZV07XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHNldHRpbmdzLm1hcmtDaGFuZ2VVbmRvKSB7XHJcbiAgICAgICAga2V5YmluZHMudW5kbyA9IFtzZXR0aW5ncy5tYXJrQ2hhbmdlVW5kb107XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHNldHRpbmdzLm1hcmtMaXN0U2VsZWN0KXtcclxuICAgICAgICBrZXliaW5kcy5lbnRlciA9IFtzZXR0aW5ncy5tYXJrTGlzdFNlbGVjdF07XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGtleWJpbmRzO1xyXG59XHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG1hdGNoS2V5YmluZChldnQ6IEtleWJvYXJkRXZlbnQsIGtleWJpbmQ6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gICAgLy8gUGFyc2Uga2V5YmluZCBzdHJpbmcgbGlrZSAnY3RybCtzaGlmdCtwJywgJ2NtZCtuJywgZXRjLlxyXG4gICAgY29uc3QgcGFydHMgPSBrZXliaW5kLnNwbGl0KCcrJykubWFwKHAgPT4gcC50cmltKCkpO1xyXG4gICAgbGV0IHJlcXVpcmVkID0geyBjdHJsOiBmYWxzZSwgc2hpZnQ6IGZhbHNlLCBhbHQ6IGZhbHNlLCBtZXRhOiBmYWxzZSwga2V5OiAnJyB9O1xyXG4gICAgZm9yIChjb25zdCBwYXJ0IG9mIHBhcnRzKSB7XHJcbiAgICAgICAgaWYgKHBhcnQgPT09ICdjdHJsJykgcmVxdWlyZWQuY3RybCA9IHRydWU7XHJcbiAgICAgICAgZWxzZSBpZiAocGFydCA9PT0gJ3NoaWZ0JykgcmVxdWlyZWQuc2hpZnQgPSB0cnVlO1xyXG4gICAgICAgIGVsc2UgaWYgKHBhcnQgPT09ICdhbHQnKSByZXF1aXJlZC5hbHQgPSB0cnVlO1xyXG4gICAgICAgIGVsc2UgaWYgKHBhcnQgPT09ICdtZXRhJyB8fCBwYXJ0ID09PSAnY21kJyB8fCBwYXJ0ID09PSAnd2luJykgcmVxdWlyZWQubWV0YSA9IHRydWU7XHJcbiAgICAgICAgZWxzZSByZXF1aXJlZC5rZXkgPSBwYXJ0O1xyXG4gICAgfVxyXG4gICAgLy8gQ2hlY2sgbW9kaWZpZXJzXHJcbiAgICBpZiAoZXZ0LmN0cmxLZXkgIT09IHJlcXVpcmVkLmN0cmwpIHJldHVybiBmYWxzZTtcclxuICAgIGlmIChldnQuc2hpZnRLZXkgIT09IHJlcXVpcmVkLnNoaWZ0KSByZXR1cm4gZmFsc2U7XHJcbiAgICBpZiAoZXZ0LmFsdEtleSAhPT0gcmVxdWlyZWQuYWx0KSByZXR1cm4gZmFsc2U7XHJcbiAgICBpZiAoZXZ0Lm1ldGFLZXkgIT09IHJlcXVpcmVkLm1ldGEpIHJldHVybiBmYWxzZTtcclxuICAgIC8vIENoZWNrIGtleSAoY2FzZS1pbnNlbnNpdGl2ZSlcclxuICAgIHJldHVybiBldnQua2V5ID09PSByZXF1aXJlZC5rZXk7XHJcbn0iLCAiaW1wb3J0IHsgQXBwLCBNYXJrZG93blZpZXcsIE5vdGljZSwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBvcGVuTmV3RmlsZShmaWxlUGF0aDogc3RyaW5nLCBvcGVuRmlsZUluTmV3VGFiOiBib29sZWFuLCBhcHA6IEFwcCkge1xyXG4gICAgY29uc3QgZmlsZSA9IGFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpO1xyXG4gICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG4gICAgICAgIGlmIChvcGVuRmlsZUluTmV3VGFiKSB7XHJcbiAgICAgICAgICAgIGFwcC53b3Jrc3BhY2UuZ2V0TGVhZigndGFiJykub3BlbkZpbGUoZmlsZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgYXBwLndvcmtzcGFjZS5nZXRMZWFmKCkub3BlbkZpbGUoZmlsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgbmV3IE5vdGljZShgRmlsZSBub3QgZm91bmQgZm9yIHBhdGggJHtmaWxlUGF0aH0uIFRoZSBmaWxlIG1heSBoYXZlIGJlZW4gZGVsZXRlZCwgbW92ZWQgb3IgcmVuYW1lZC5gKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEFsbE9wZW5lZEZpbGVzRXhwZXJpbWVudGFsKGFwcDogQXBwKTogYW55IHtcclxuICAgIC8vIENoZWNrIGlmIHRoZSBmaWxlIGlzIGFscmVhZHkgb3BlbiBpbiBhIGxlYWYsIHdvbmt5IGJ1dCBmaW5kcyBhbGxcclxuICAgIC8vIFRPRE86IEkgY291bGQgbWFrZSBhIGZ1bmN0aW9uIHRoYXQgZG9lcyB0aGlzLCBidXQgb25seSBmb3Igc3BlY2lmaWVkIHBhbmUgaWYgdGhlcmUgaXMgYSBuZWVkIGZvciBvcHRpbWl6YXRpb24uXHJcbiAgICAvLyBlZy46IHVzaW5nIGFwcC53b3Jrc3BhY2UuZ2V0TGVhZigpLnBhcmVudC5jaGlsZHJlbiB3aWxsIGdldCBhbGwgdGhlIHRhYnMgaW4gdGhlIGN1cnJlbnQgcGFuZVxyXG4gICAgLy8geERcclxuICAgIC8vIEB0cy1pZ25vcmVcclxuICAgIGxldCB0YWJHcm91cHMgPSBhcHAud29ya3NwYWNlLmdldExheW91dCgpLm1haW4/LmNoaWxkcmVuO1xyXG4gICAgbGV0IG91dCA9IFtdO1xyXG4gICAgZm9yIChjb25zdCBlbCBvZiB0YWJHcm91cHMpe1xyXG4gICAgICAgIG91dC5wdXNoKC4uLmVsLmNoaWxkcmVuKVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG91dDtcclxuXHJcbiAgICAvLyBjb25zdCBhcHAgPSB0aGlzLmFwcDtcclxuICAgIC8vIGNvbnN0IGZpbGVzID0gbmV3IFNldDxURmlsZT4oKTtcclxuICAgIC8vIGNvbnN0IGxheW91dCA9IGFwcC53b3Jrc3BhY2UuZ2V0TGF5b3V0KCk7XHJcblxyXG4gICAgLy8gZnVuY3Rpb24gY29sbGVjdEZpbGVzKG5vZGU6IGFueSkge1xyXG4gICAgLy8gICAgIGlmICghbm9kZSkgcmV0dXJuO1xyXG4gICAgLy8gICAgIGlmIChub2RlLnR5cGUgPT09ICdsZWFmJyAmJiBub2RlLnN0YXRlPy5maWxlKSB7XHJcbiAgICAvLyAgICAgICAgIGNvbnN0IGZpbGUgPSBhcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5vZGUuc3RhdGUuZmlsZSk7XHJcbiAgICAvLyAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIGZpbGVzLmFkZChmaWxlKTtcclxuICAgIC8vICAgICB9XHJcbiAgICAvLyAgICAgaWYgKG5vZGUuY2hpbGRyZW4gJiYgQXJyYXkuaXNBcnJheShub2RlLmNoaWxkcmVuKSkge1xyXG4gICAgLy8gICAgICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIG5vZGUuY2hpbGRyZW4pIGNvbGxlY3RGaWxlcyhjaGlsZCk7XHJcbiAgICAvLyAgICAgfVxyXG4gICAgLy8gfVxyXG5cclxuICAgIC8vIC8vIFRyYXZlcnNlIGFsbCBwb3NzaWJsZSByb290c1xyXG4gICAgLy8gZm9yIChjb25zdCBrZXkgb2YgWydtYWluJywgJ2xlZnQnLCAncmlnaHQnLCAnY2VudGVyJywgJ3BvcG91dCddKSB7XHJcbiAgICAvLyAgICAgaWYgKGxheW91dFtrZXldKSBjb2xsZWN0RmlsZXMobGF5b3V0W2tleV0pO1xyXG4gICAgLy8gfVxyXG5cclxuICAgIC8vIHJldHVybiBBcnJheS5mcm9tKGZpbGVzKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG5hdmlnYXRlVG9PcGVuRmlsZUJ5UGF0aChmaWxlUGF0aDogc3RyaW5nLCBleHBlcmltZW50YWxHb3RvOiBib29sZWFuLCBhcHA6IEFwcCk6IGJvb2xlYW4ge1xyXG4gICAgaWYgKGV4cGVyaW1lbnRhbEdvdG8pIHtcclxuICAgICAgICBjb25zdCBvcGVuZWRGaWxlcyA9IGdldEFsbE9wZW5lZEZpbGVzRXhwZXJpbWVudGFsKGFwcClcclxuICAgICAgICBmb3IgKGNvbnN0IG9wZW5lZEZpbGUgb2Ygb3BlbmVkRmlsZXMpIHtcclxuICAgICAgICAgICAgaWYgKG9wZW5lZEZpbGUudHlwZSA9PSAnbGVhZicgJiYgb3BlbmVkRmlsZS5zdGF0ZS5zdGF0ZS5maWxlID09PSBmaWxlUGF0aCkge1xyXG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIGZpbGUgaXMgYWxyZWFkeSBvcGVuLCBzd2l0Y2ggdG8gaXRcclxuICAgICAgICAgICAgICAgIGNvbnN0IGxlYWYgPSBhcHAud29ya3NwYWNlLmdldExlYWZCeUlkKG9wZW5lZEZpbGUuaWQpO1xyXG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ0ZvdW5kIGxlYWYgZm9yIGZpbGU6Jywgb3BlbmVkRmlsZS5zdGF0ZS5zdGF0ZS5maWxlLCBvcGVuZWRGaWxlLmlkLCBsZWFmKTtcclxuICAgICAgICAgICAgICAgIGlmIChsZWFmICYmIGxlYWYucGFyZW50ID09PSBhcHAud29ya3NwYWNlLmdldExlYWYoKS5wYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBhcHAud29ya3NwYWNlLnNldEFjdGl2ZUxlYWYobGVhZiwgeyBmb2N1czogdHJ1ZSB9KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIENoZWNrIGlmIHRoZSBmaWxlIGlzIGFscmVhZHkgb3BlbiBpbiBhIGxlYWYsIG1pc3NlcyBhbHJlYWR5IG9wZW5lZCBmaWxlcyB0aGF0IHdlcmUgb3BlbmVkIGluIHByZXZpb3VzIG9ic2lkaWFuIHNlc3Npb25zXHJcbiAgICAgICAgY29uc3QgbGVhdmVzID0gYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ21hcmtkb3duJyk7XHJcbiAgICAgICAgZm9yIChjb25zdCBsZWFmIG9mIGxlYXZlcykge1xyXG4gICAgICAgICAgICBjb25zdCB2aWV3ID0gbGVhZi52aWV3O1xyXG4gICAgICAgICAgICBpZiAodmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldyAmJiB2aWV3LmZpbGUgJiYgdmlldy5maWxlLnBhdGggPT09IGZpbGVQYXRoICYmIGxlYWYucGFyZW50ID09PSBhcHAud29ya3NwYWNlLmdldExlYWYoKS5wYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgIGFwcC53b3Jrc3BhY2Uuc2V0QWN0aXZlTGVhZihsZWFmLCB7IGZvY3VzOiB0cnVlIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn0iLCAiaW1wb3J0IFZpbU1hcmtzSW1wbCBmcm9tICcuL21haW4nO1xyXG5pbXBvcnQgeyBNYXJrTGlzdE1vZGFsIH0gZnJvbSAnLi91aS9NYXJrTGlzdE1vZGFsJztcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZXRHbG9iYWxNYXJrKHBsdWdpbjogVmltTWFya3NJbXBsKSB7XHJcbiAgICBuZXcgTWFya0xpc3RNb2RhbChwbHVnaW4uYXBwLCBwbHVnaW4sICdzZXQnKS5vcGVuKCk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnb1RvR2xvYmFsTWFyayhwbHVnaW46IFZpbU1hcmtzSW1wbCkge1xyXG4gICAgbmV3IE1hcmtMaXN0TW9kYWwocGx1Z2luLmFwcCwgcGx1Z2luLCAnZ290bycpLm9wZW4oKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUdsb2JhbE1hcmsocGx1Z2luOiBWaW1NYXJrc0ltcGwpIHtcclxuICAgIG5ldyBNYXJrTGlzdE1vZGFsKHBsdWdpbi5hcHAsIHBsdWdpbiwgJ2RlbGV0ZScpLm9wZW4oKTtcclxufVxyXG5cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhZGRGaWxlVG9IYXJwb29uKHBsdWdpbjogVmltTWFya3NJbXBsKSB7XHJcbiAgICBuZXcgTWFya0xpc3RNb2RhbChwbHVnaW4uYXBwLCBwbHVnaW4sICdnb3RvJykuYWRkRmlsZVRvSGFycG9vbigpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ29Ub0hhcnBvb25NYXJrKHBsdWdpbjogVmltTWFya3NJbXBsKSB7XHJcbiAgICBuZXcgTWFya0xpc3RNb2RhbChwbHVnaW4uYXBwLCBwbHVnaW4sICdnb3RvJywgdHJ1ZSkub3BlbigpO1xyXG59IiwgImltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZyB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBWaW1NYXJrc0ltcGwgZnJvbSAnLi4vbWFpbic7XG5pbXBvcnQgeyBTZXR0aW5ncyB9IGZyb20gJy4uL3R5cGVzL2luZGV4JztcbmltcG9ydCB7IGRlZmF1bHRTZXR0aW5ncyB9IGZyb20gJy4uL3V0aWxzL2RlZmF1bHRWYWx1ZXMnO1xuXG5leHBvcnQgY2xhc3MgU2V0dGluZ3NUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcbiAgICBwbHVnaW46IFZpbU1hcmtzSW1wbDtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFZpbU1hcmtzSW1wbCkge1xuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cblxuICAgIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XG4gICAgICAgIGNvbnN0IGRzID0gZGVmYXVsdFNldHRpbmdzO1xuXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0dlbmVyYWwnIH0pO1xuICAgICAgICB0aGlzLmNyZWF0ZVJlZ2lzdGVyTGlzdFNldHRpbmcoY29udGFpbmVyRWwsIFwiUmVnaXN0ZXIgbGlzdFwiLCBkcy5yZWdpc3Rlckxpc3QsICdLZXkgc3ltYm9scyB0byBiZSB1c2VkIGFzIHJlZ2lzdGVycy4gT25seSBpbmNsdWRlIHN5bWJvbHMgdGhhdCB5b3UgY2FuIGlucHV0IHdpdGggYSBzaW5nbGUga2V5c3Ryb2tlLicsICdyZWdpc3Rlckxpc3QnKVxuICAgICAgICAgICAgLmFkZEV4dHJhQnV0dG9uKChidG4pID0+IHtcbiAgICAgICAgICAgICAgICBidG5cbiAgICAgICAgICAgICAgICAgICAgLnNldEljb24oJ3JlZnJlc2gtY2N3JylcbiAgICAgICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoJ1Jlc2V0IHRvIGRlZmF1bHQgcmVnaXN0ZXIgbGlzdCcpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnJlZ2lzdGVyTGlzdCA9IGRzLnJlZ2lzdGVyTGlzdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7IC8vIFJlZnJlc2ggdGhlIHNldHRpbmdzIHRhYiB0byBzaG93IHRoZSB1cGRhdGVkIHZhbHVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnU29ydCBhbGwgbWFya3MgYnkgcmVnaXN0ZXIgbGlzdCcpXG4gICAgICAgICAgICAuc2V0RGVzYygnU29ydCBtYXJrcyBieSB0aGUgb3JkZXIgb2YgdGhlIGtleSBzeW1ib2xzIGluIHRoZSByZWdpc3RlciBsaXN0LiBJZiBkaXNhYmxlZCwgbWFya3Mgd2lsbCBiZSBzb3J0ZWQgYWxwaGFiZXRpY2FsbHkgYWNjb3JkaW5nIHRvIHRoZSBjdXJyZW50IGxvY2FsZS4nKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnJlZ2lzdGVyU29ydEJ5TGlzdCA/PyBkcy5yZWdpc3RlclNvcnRCeUxpc3QpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZWdpc3RlclNvcnRCeUxpc3QgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgLy8gVE9ETzogaW1wbGVtZW50IHRoaXMgZmVhdHVyZVxuICAgICAgICAvLyBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgLy8gICAgIC5zZXROYW1lKCdIaWRlIG1hcmsgbGlzdCcpXG4gICAgICAgIC8vICAgICAuc2V0RGVzYygnSGlkZSB0aGUgZ2xvYmFsIG1hcmsgbGlzdCBmb3IgYm90aCBjb21tYW5kcyAoZm9yIGZhc3QgaW5wdXQsIG5vIGZsaWNrZXIpLicpXG4gICAgICAgIC8vICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgLy8gICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuaGlkZU1hcmtMaXN0RHVyaW5nSW5wdXQgPz8gZHMuaGlkZU1hcmtMaXN0RHVyaW5nSW5wdXQpXG4gICAgICAgIC8vICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAvLyAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5oaWRlTWFya0xpc3REdXJpbmdJbnB1dCA9IHZhbHVlO1xuICAgICAgICAvLyAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgLy8gICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnT3BlbiBtYXJrIGluIG5ldyB0YWInKVxuICAgICAgICAgICAgLnNldERlc2MoJ09wZW4gYSBmaWxlIGluIHRoZSBuZXcgdGFiIHdoZW4gdXNpbmcgXCJnbyB0b1wiIGNvbW1hbmQuIElmIGRpc2FibGVkLCBpdCB3aWxsIG9wZW4gdGhlIGZpbGUgaW4gdGhlIGN1cnJlbnQgdGFiLicpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Mub3Blbk1hcmtJbk5ld1RhYiA/PyBkcy5vcGVuTWFya0luTmV3VGFiKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mub3Blbk1hcmtJbk5ld1RhYiA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdObyBkdXBsaWNhdGlvbiBvZiBvcGVuZWQgZmlsZXMgd2hlbiB1c2luZyBnb3RvIChleHBlcmltZW50YWwpJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdQcmV2ZW50cyBkdXBsaWNhdGUgdGFicyB3aGVuIHN3aXRjaGluZyB0byBhbHJlYWR5IG9wZW5lZCBmaWxlcyB1c2luZyB0aGUgbWFyayBsaXN0IGFmdGVyIHJlc3RhcnRpbmcgT2JzaWRpYW4uIChFeHBlcmltZW50YWw6IG1heSBub3Qgd29yayBpbiBmdXR1cmUgT2JzaWRpYW4gdmVyc2lvbnMuKScpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhwZXJpbWVudGFsR290byA/PyBkcy5leHBlcmltZW50YWxHb3RvKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhwZXJpbWVudGFsR290byA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcblxuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdIYXJwb29uIHJlZ2lzdGVycycgfSk7XG4gICAgICAgIHRoaXMuY3JlYXRlUmVnaXN0ZXJMaXN0U2V0dGluZyhjb250YWluZXJFbCwgXCJIYXJwb29uIHJlZ2lzdGVyIGxpc3RcIiwgZHMuaGFycG9vblJlZ2lzdGVyTGlzdCwgJ0tleSBzeW1ib2xzIHRvIGJlIHVzZWQgYXMgSGFycG9vbiByZWdpc3RlcnMuIE9ubHkgaW5jbHVkZSBzeW1ib2xzIHRoYXQgeW91IGNhbiBpbnB1dCB3aXRoIGEgc2luZ2xlIGtleXN0cm9rZS4nLCAnaGFycG9vblJlZ2lzdGVyTGlzdCcpXG4gICAgICAgICAgICAuYWRkRXh0cmFCdXR0b24oKGJ0bikgPT4ge1xuICAgICAgICAgICAgICAgIGJ0blxuICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbigncmVmcmVzaC1jY3cnKVxuICAgICAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcCgnUmVzZXQgdG8gZGVmYXVsdCBIYXJwb29uIHJlZ2lzdGVyIGxpc3QnKVxuICAgICAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5oYXJwb29uUmVnaXN0ZXJMaXN0ID0gZHMuaGFycG9vblJlZ2lzdGVyTGlzdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7IC8vIFJlZnJlc2ggdGhlIHNldHRpbmdzIHRhYiB0byBzaG93IHRoZSB1cGRhdGVkIHZhbHVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnU29ydCBIYXJwb29uIG1hcmtzIGJ5IEhhcnBvb24gcmVnaXN0ZXIgbGlzdCcpXG4gICAgICAgICAgICAuc2V0RGVzYygnU29ydCBIYXJwb29uIG1hcmtzIGJ5IHRoZSBvcmRlciBvZiB0aGUga2V5IHN5bWJvbHMgaW4gdGhlIEhhcnBvb24gcmVnaXN0ZXIgbGlzdC4gSWYgZGlzYWJsZWQsIG1hcmtzIHdpbGwgYmUgc29ydGVkIGFscGhhYmV0aWNhbGx5IGFjY29yZGluZyB0byB0aGUgY3VycmVudCBsb2NhbGUuJylcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5oYXJwb29uUmVnaXN0ZXJTb3J0QnlMaXN0ID8/IGRzLmhhcnBvb25SZWdpc3RlclNvcnRCeUxpc3QpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5oYXJwb29uUmVnaXN0ZXJTb3J0QnlMaXN0ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1JlbW92ZSBnYXBzIGluYmV0d2VlbiBIYXJwb29uIG1hcmtzJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdIYXJwb29uIG1hcmtzIHdpbGwgYmUgc2hpZnRlZCB0byB0aGUgbGVmdCBmb3IgZXZlcnkgZ2FwIChyZWdpc3RlciB3aXRoIG5vIG1hcmspIGJhc2VkIG9uIHRoZSBvcmRlciBvZiB0aGUgSGFycG9vbiByZWdpc3RlciBsaXN0LicpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuaGFycG9vblJlZ2lzdGVyR2FwUmVtb3ZhbCA/PyBkcy5oYXJwb29uUmVnaXN0ZXJHYXBSZW1vdmFsKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaGFycG9vblJlZ2lzdGVyR2FwUmVtb3ZhbCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcblxuXG4gICAgICAgIC8vIEFkZCBrZXlib2FyZCBzaG9ydGN1dCBzZXR0aW5nc1xuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdMaXN0IG5hdmlnYXRpb24gc2hvcnRjdXRzJyB9KTtcbiAgICAgICAgdGhpcy5jcmVhdGVTaG9ydGN1dFNldHRpbmcoY29udGFpbmVyRWwsICdVcCcsIGRzLm1vZGFsTGlzdFVwLCAnU2hvcnRjdXQgZm9yIG1vdmluZyB1cCBpbiB0aGUgbGlzdCcsICdtYXJrTGlzdFVwJyk7XG4gICAgICAgIHRoaXMuY3JlYXRlU2hvcnRjdXRTZXR0aW5nKGNvbnRhaW5lckVsLCAnRG93bicsIGRzLm1vZGFsTGlzdERvd24sICdTaG9ydGN1dCBmb3IgbW92aW5nIGRvd24gaW4gdGhlIGxpc3QnLCAnbWFya0xpc3REb3duJyk7XG4gICAgICAgIHRoaXMuY3JlYXRlU2hvcnRjdXRTZXR0aW5nKGNvbnRhaW5lckVsLCAnU2VsZWN0JywgZHMubW9kYWxMaXN0U2VsZWN0LCAnU2hvcnRjdXQgZm9yIHNlbGVjdGluZyBhIG1hcmsnLCAnbWFya0xpc3RTZWxlY3QnKTtcbiAgICAgICAgdGhpcy5jcmVhdGVTaG9ydGN1dFNldHRpbmcoY29udGFpbmVyRWwsICdEZWxldGUnLCBkcy5tb2RhbExpc3REZWxldGUsICdTaG9ydGN1dCBmb3IgZGVsZXRpbmcgYSBtYXJrJywgJ21hcmtMaXN0RGVsZXRlJyk7XG4gICAgICAgIC8vIHRoaXMuY3JlYXRlU2hvcnRjdXRTZXR0aW5nKGNvbnRhaW5lckVsLCAnUmVzdG9yZSBsYXN0IGNoYW5nZWQgbWFyaycsIGRzLm1vZGFsQ2hhbmdlVW5kbywgJ1Nob3J0Y3V0IGZvciB1bmRvaW5nIGxhc3QgYWN0aW9uIG9mIGNoYW5naW5nIGEgbWFyaycsICdtYXJrQ2hhbmdlVW5kbycpO1xuXG5cbiAgICB9XG5cbiAgICAvLyB1c2Ugb25seSBmb3Igc3RyaW5nIHZhbHVlcyBmcm9tIFNldHRpbmdzIHR5cGVcbiAgICBjcmVhdGVTaG9ydGN1dFNldHRpbmcoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LCBuYW1lOiBzdHJpbmcsIGRlZmF1bHRWYWx1ZTogc3RyaW5nLCBkZXNjOiBzdHJpbmcsIGtleToga2V5b2YgU2V0dGluZ3MpIHtcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShuYW1lKVxuICAgICAgICAgICAgLnNldERlc2MoZGVzYylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShTdHJpbmcodGhpcy5wbHVnaW4uc2V0dGluZ3Nba2V5XSA/PyBkZWZhdWx0VmFsdWUpKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgKHRoaXMucGx1Z2luLnNldHRpbmdzIGFzIGFueSlba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgfVxuXG4gICAgY3JlYXRlUmVnaXN0ZXJMaXN0U2V0dGluZyhjb250YWluZXJFbDogSFRNTEVsZW1lbnQsIG5hbWU6IHN0cmluZywgZGVmYXVsdFZhbHVlOiBzdHJpbmcsIGRlc2M6IHN0cmluZywga2V5OiBrZXlvZiBTZXR0aW5ncyk6IFNldHRpbmcge1xuICAgICAgICByZXR1cm4gbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShuYW1lKVxuICAgICAgICAgICAgLnNldERlc2MoZGVzYylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShTdHJpbmcodGhpcy5wbHVnaW4uc2V0dGluZ3Nba2V5XSA/PyBkZWZhdWx0VmFsdWUpKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgKHRoaXMucGx1Z2luLnNldHRpbmdzIGFzIGFueSlba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgfVxufSIsICJpbXBvcnQgVmltTWFya3NJbXBsIGZyb20gJy4uL21haW4nO1xyXG5pbXBvcnQgeyBTZXR0aW5ncywgTWFyayB9IGZyb20gJy4uL3R5cGVzL2luZGV4JztcclxuaW1wb3J0IHsgZGVmYXVsdFNldHRpbmdzLCBKU09Oc2NoZW1hVmVyc2lvbiBhcyBsYXRlc3RKU09OU2NoZW1hVmVyc2lvbiB9IGZyb20gJy4vZGVmYXVsdFZhbHVlcyc7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9hZFNldHRpbmdzKHBsdWdpbjogVmltTWFya3NJbXBsKTogUHJvbWlzZTxTZXR0aW5ncz4ge1xyXG4gICAgcmV0dXJuIChhd2FpdCBwbHVnaW4ubG9hZERhdGEoKSk/LnNldHRpbmdzIHx8IGRlZmF1bHRTZXR0aW5ncztcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNhdmVTZXR0aW5ncyhwbHVnaW46IFZpbU1hcmtzSW1wbCwgc2V0dGluZ3M6IFNldHRpbmdzKSB7XHJcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcGx1Z2luLmxvYWREYXRhKCkgfHwge307XHJcbiAgICBkYXRhLnNldHRpbmdzID0gc2V0dGluZ3M7XHJcbiAgICBhd2FpdCBwbHVnaW4uc2F2ZURhdGEoZGF0YSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkTWFya3MocGx1Z2luOiBWaW1NYXJrc0ltcGwpOiBQcm9taXNlPE1hcmtbXT4ge1xyXG4gICAgcmV0dXJuIChhd2FpdCBwbHVnaW4ubG9hZERhdGEoKSk/Lm1hcmtzIHx8IFtdO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2F2ZU1hcmtzKHBsdWdpbjogVmltTWFya3NJbXBsLCBtYXJrczogTWFya1tdKSB7XHJcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcGx1Z2luLmxvYWREYXRhKCkgfHwge307XHJcbiAgICBkYXRhLm1hcmtzID0gbWFya3M7XHJcbiAgICBhd2FpdCBwbHVnaW4uc2F2ZURhdGEoZGF0YSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkTGFzdENoYW5nZWRNYXJrKHBsdWdpbjogVmltTWFya3NJbXBsKTogUHJvbWlzZTxNYXJrPiB7XHJcbiAgICByZXR1cm4gKGF3YWl0IHBsdWdpbi5sb2FkRGF0YSgpKT8ubGFzdENoYW5nZWRNYXJrIHx8IFtdO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2F2ZUxhc3RDaGFuZ2VkTWFyayhwbHVnaW46IFZpbU1hcmtzSW1wbCwgbGFzdENoYW5nZWRNYXJrOiBNYXJrKSB7XHJcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcGx1Z2luLmxvYWREYXRhKCkgfHwge307XHJcbiAgICBkYXRhLmxhc3RDaGFuZ2VkTWFyayA9IGxhc3RDaGFuZ2VkTWFyaztcclxuICAgIGF3YWl0IHBsdWdpbi5zYXZlRGF0YShkYXRhKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEpTT05zY2hlbWFDaGVjayhwbHVnaW46IFZpbU1hcmtzSW1wbCkge1xyXG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHBsdWdpbi5sb2FkRGF0YSgpIHx8IHtzY2hlbWFWZXJzaW9uOiBsYXRlc3RKU09OU2NoZW1hVmVyc2lvbn07XHJcblxyXG4gICAgaWYgKGRhdGEuc2NoZW1hVmVyc2lvbiAmJiBkYXRhLnNjaGVtYVZlcnNpb24gPT09IGxhdGVzdEpTT05TY2hlbWFWZXJzaW9uKXtcclxuICAgICAgICByZXR1cm5cclxuICAgIH1cclxuXHJcbiAgICBjb25zb2xlLmxvZyhcInRldGhlci1tYXJrczogVGhlIGRhdGEgbG9hZGVkIGlzIG5vdCBpbiBjb3JyZWN0IGZvcm1hdC4gVGhlIHBsdWdpbiBtYXkgbm90IHdvcmsgY29ycmVjdGx5LiBUaGlzIHdpbGwgdXN1YWxseSBoYXBwZW4gYWZ0ZXIgcGx1Z2luIHVwZGF0ZSB0aGF0IGNoYW5nZXMgSlNPTiBzY2hlbWEuIFwiKTtcclxuICAgIC8vIFRPRE86IG1ha2UgYXV0b21hdGljIGNvbnZlcnNpb25zIGhlcmUgaWYgbmVjZXNzYXJ5IGluIHRoZSBmdXR1cmUuIEJlIHN1cmUgdG8gc2F2ZSB0aGUgbGVnYWN5IHByZSBjb252ZXJzaW9uIGRhdGEgYXMgYmFja3VwIGluIHRoZSBcImxlZ2FjeVNjaGVtYURhdGFcIiBmaWVsZC4gXHJcbn0iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFBLG1CQUF1Qjs7O0FDQXZCLElBQUFDLG1CQUFvRDs7O0FDRTdDLElBQU0sdUJBQXNDO0FBQUEsRUFDL0MsSUFBSSxDQUFDLFVBQVUsUUFBUTtBQUFBLEVBQ3ZCLE1BQU0sQ0FBQyxVQUFVLFFBQVE7QUFBQSxFQUN6QixRQUFRLENBQUMsUUFBUTtBQUFBLEVBQ2pCLE1BQU0sQ0FBQyxRQUFRO0FBQUEsRUFDZixPQUFPLENBQUMsT0FBTztBQUNuQjtBQUVPLElBQU0sMEJBQXlDO0FBQUEsRUFDbEQsSUFBSSxDQUFDLFNBQVMsT0FBTztBQUFBLEVBQ3JCLE1BQU0sQ0FBQyxTQUFTLE9BQU87QUFBQSxFQUN2QixRQUFRLENBQUMsT0FBTztBQUFBLEVBQ2hCLE1BQU0sQ0FBQyxPQUFPO0FBQUEsRUFDZCxPQUFPLENBQUMsT0FBTztBQUNuQjtBQUVPLElBQU0sMkJBQTJCO0FBQUEsRUFDcEMsS0FBSztBQUFBLEVBQ0wsTUFBTTtBQUFBLEVBQ04sUUFBUTtBQUNaO0FBSU8sSUFBTSxrQkFBa0I7QUFBQSxFQUMzQix5QkFBeUI7QUFBQSxFQUN6QixhQUFhO0FBQUEsRUFDYixlQUFlO0FBQUEsRUFDZixpQkFBaUI7QUFBQSxFQUNqQixpQkFBaUI7QUFBQSxFQUNqQixpQkFBaUI7QUFBQSxFQUNqQixrQkFBa0I7QUFBQTtBQUFBLEVBQ2xCLGNBQWM7QUFBQSxFQUNkLG9CQUFvQjtBQUFBLEVBQ3BCLHFCQUFxQjtBQUFBLEVBQ3JCLDJCQUEyQjtBQUFBLEVBQzNCLDJCQUEyQjtBQUFBLEVBQzNCLGtCQUFrQjtBQUN0QjtBQUVPLElB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TUFBTSxjQUFjLElBQUk7QUFBQSxJQUN0QyxDQUFDO0FBRUQsU0FBSyxXQUFXO0FBQUEsTUFDWixJQUFJO0FBQUEsTUFDSixNQUFNO0FBQUEsTUFDTixVQUFVLE1BQU0sZUFBZSxJQUFJO0FBQUEsSUFDdkMsQ0FBQztBQUVELFNBQUssV0FBVztBQUFBLE1BQ1osSUFBSTtBQUFBLE1BQ0osTUFBTTtBQUFBLE1BQ04sVUFBVSxNQUFNLGlCQUFpQixJQUFJO0FBQUEsSUFDekMsQ0FBQztBQUVELFNBQUssV0FBVztBQUFBLE1BQ1osSUFBSTtBQUFBLE1BQ0osTUFBTTtBQUFBLE1BQ04sVUFBVSxNQUFNLGlCQUFpQixJQUFJO0FBQUEsSUFDekMsQ0FBQztBQUVELFNBQUssV0FBVztBQUFBLE1BQ1osSUFBSTtBQUFBLE1BQ0osTUFBTTtBQUFBLE1BQ04sVUFBVSxNQUFNLGdCQUFnQixJQUFJO0FBQUEsSUFDeEMsQ0FBQztBQUVELFNBQUssY0FBYyxJQUFJLFlBQVksS0FBSyxLQUFLLElBQUksQ0FBQztBQUVsRCxZQUFRLElBQUksc0JBQXNCO0FBQUEsRUFDdEM7QUFBQSxFQUVBLE1BQU0sZUFBZTtBQUNqQixVQUFNLGFBQWEsTUFBTSxLQUFLLFFBQVE7QUFBQSxFQUMxQztBQUFBLEVBRUEsTUFBTSxVQUFVLE9BQWU7QUFDM0IsU0FBSyxRQUFRO0FBQ2IsVUFBTSxVQUFVLE1BQU0sS0FBSztBQUFBLEVBQy9CO0FBQUEsRUFFQSxNQUFNLG9CQUFvQixpQkFBdUI7QUFDN0MsU0FBSyxrQkFBa0I7QUFDdkIsVUFBTSxvQkFBb0IsTUFBTSxlQUFlO0FBQUEsRUFDbkQ7QUFBQSxFQUVBLFdBQVc7QUFFUCxZQUFRLElBQUksd0JBQXdCO0FBQUEsRUFDeEM7QUFDSjsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iXQp9Cg==
