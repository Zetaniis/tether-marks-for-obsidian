/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => TetherMarksPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian5 = require("obsidian");

// src/ui/MarkListModal.ts
var import_obsidian2 = require("obsidian");

// src/utils/defaultValues.ts
var modalDefaultKeybinds = {
  up: ["ctrl+k", "ctrl+p"],
  down: ["ctrl+j", "ctrl+n"],
  delete: ["ctrl+d"],
  select: ["Enter"],
  cancel: ["Escape"],
  undo: ["ctrl+u"]
};
var modalDefaultKeybindsMac = {
  up: ["cmd+k", "cmd+p"],
  down: ["cmd+j", "cmd+n"],
  delete: ["cmd+d"],
  select: ["Enter"],
  cancel: ["Escape"],
  undo: ["cmd+u"]
};
var defaultSettings = {
  // hideMarkListDuringInput: false,
  modalListUp: "",
  modalListDown: "",
  modalListSelect: "",
  modalListUndo: "",
  modalListDelete: "",
  modalListCancel: "",
  openMarkInNewTab: false,
  // If true, open mark in new tab, else in current tab
  registerList: "abcdefghijklmnopqrstuvwxyz",
  registerSortByList: true,
  harpoonRegisterList: "qwer",
  harpoonRegisterSortByList: true,
  harpoonRegisterGapRemoval: true,
  experimentalGoto: false
};
var modalInstructionElClass = "modal-instruction-el";
var modalMarkSymbolClass = "mark-symbol";
var modalMarkFilepathClass = "mark-file-path";
var modalMarkHarpoonSign = "harpoon-sign";
var JSONschemaVersion = 1;
var modeDescription = {
  "set": "Set mark",
  "goto": "Go to mark",
  "delete": "Delete mark"
};

// src/utils/marks.ts
function findFirstUnusedRegister(marks, registers) {
  for (const reg of registers) {
    if (!marks.map((m) => m.symbol).includes(reg)) {
      return reg;
    }
  }
  return null;
}
function getMarkBySymbol(marks, symbol) {
  return marks.find((m) => m.symbol === symbol);
}
function sortMarksAlphabetically(marks) {
  marks.sort((a, b) => a.symbol.localeCompare(b.symbol));
}
function getSortedAndFilteredMarks(marks, isHarpoonMode, settings) {
  const availableRegisters = new Set((!isHarpoonMode ? settings.registerList : settings.harpoonRegisterList).split(""));
  const filteredMarks = marks.filter((el) => availableRegisters.has(el.symbol));
  if (!isHarpoonMode && settings.registerSortByList) {
    const registerList = settings.registerList;
    sortMarksBySettingsRegisterOrder(filteredMarks, registerList);
  } else if (isHarpoonMode && settings.harpoonRegisterSortByList) {
    const registerList = settings.harpoonRegisterList;
    sortMarksBySettingsRegisterOrder(filteredMarks, registerList);
  } else {
    sortMarksAlphabetically(filteredMarks);
  }
  return filteredMarks;
}
function sortMarksBySettingsRegisterOrder(marks, registers) {
  const registerOrder = new Map([...registers].map((symbol, index) => [symbol, index]));
  marks.sort((a, b) => {
    var _a, _b;
    return ((_a = registerOrder.get(a.symbol)) != null ? _a : Infinity) - ((_b = registerOrder.get(b.symbol)) != null ? _b : Infinity);
  });
}
function removeGapsForHarpoonMarks(marksToCopy, harpoonRegisters) {
  let marks = [...marksToCopy];
  let leftCur = 0;
  let rightCur = 0;
  while (rightCur < harpoonRegisters.length) {
    const markEl = marks.find((el) => el.symbol === harpoonRegisters[rightCur]);
    if (markEl !== void 0) {
      const symbolToSetTo = harpoonRegisters[leftCur];
      let filteredMarks = marks.filter((el) => el.symbol !== harpoonRegisters[leftCur]);
      filteredMarks.push({ symbol: symbolToSetTo, filePath: markEl.filePath });
      marks = filteredMarks;
      leftCur += 1;
    }
    rightCur += 1;
  }
  while (leftCur < harpoonRegisters.length) {
    marks = marks.filter((el) => el.symbol !== harpoonRegisters[leftCur]);
    leftCur += 1;
  }
  return marks;
}
function restoreLastChangedMark(marks, lastChangedMark) {
  const markToRestore = { ...lastChangedMark };
  const markToDiscard = marks.find((m) => m.symbol === markToRestore.symbol);
  const marksWithoutDiscarded = marks.filter((m) => m.symbol !== markToRestore.symbol);
  marksWithoutDiscarded.push({ symbol: markToRestore.symbol, filePath: markToRestore.filePath });
  return { marks: marksWithoutDiscarded, markToDiscard };
}
function setNewOrOverwriteMark(marks, setMark, filePath) {
  const { marks: filteredMarks, deletedMark: overwrittenMark } = deleteMark(marks, setMark);
  filteredMarks.push({ symbol: setMark.symbol, filePath });
  return { marks: filteredMarks, overwrittenMark };
}
function deleteMark(marks, markToDelete) {
  const cMark = { ...markToDelete };
  const deletedMark = marks.find((m) => m.symbol === cMark.symbol);
  const filteredMarks = marks.filter((m) => m.symbol !== cMark.symbol);
  return { marks: filteredMarks, deletedMark };
}

// src/utils/keybinds.ts
function prepareKeybinds(isMacOS, settings) {
  let keybinds = !isMacOS ? { ...modalDefaultKeybinds } : { ...modalDefaultKeybindsMac };
  if (settings.modalListUp) {
    keybinds.up = [settings.modalListUp];
  }
  if (settings.modalListDown) {
    keybinds.down = [settings.modalListDown];
  }
  if (settings.modalListDelete) {
    keybinds.delete = [settings.modalListDelete];
  }
  if (settings.modalListSelect) {
    keybinds.select = [settings.modalListSelect];
  }
  if (settings.modalListUndo) {
    keybinds.undo = [settings.modalListUndo];
  }
  if (settings.modalListCancel) {
    keybinds.cancel = [settings.modalListCancel];
  }
  return keybinds;
}
function matchKeybind(evt, keybind) {
  const parts = keybind.split("+").map((p) => p.trim());
  let required = { ctrl: false, shift: false, alt: false, meta: false, key: "" };
  for (const part of parts) {
    if (part === "ctrl")
      required.ctrl = true;
    else if (part === "shift")
      required.shift = true;
    else if (part === "alt")
      required.alt = true;
    else if (part === "meta" || part === "cmd" || part === "win")
      required.meta = true;
    else
      required.key = part;
  }
  if (evt.ctrlKey !== required.ctrl)
    return false;
  if (evt.shiftKey !== required.shift)
    return false;
  if (evt.altKey !== required.alt)
    return false;
  if (evt.metaKey !== required.meta)
    return false;
  return evt.key === required.key;
}

// src/utils/obsidianUtils.ts
var import_obsidian = require("obsidian");
function openNewFile(filePath, openFileInNewTab, app) {
  const file = app.vault.getAbstractFileByPath(filePath);
  if (file instanceof import_obsidian.TFile) {
    if (openFileInNewTab) {
      app.workspace.getLeaf("tab").openFile(file);
    } else {
      app.workspace.getLeaf().openFile(file);
    }
  } else {
    new import_obsidian.Notice(`File not found for path ${filePath}. The file may have been deleted, moved or renamed.`);
  }
}
function getAllOpenedFilesExperimental(app) {
  var _a;
  const tabGroups = (_a = app.workspace.getLayout().main) == null ? void 0 : _a.children;
  const out = [];
  for (const el of tabGroups) {
    out.push(...el.children);
  }
  return out;
}
function getAllWorkspaceLeaves(app) {
  const list = [];
  app.workspace.iterateAllLeaves((leaf) => {
    list.push(leaf);
  });
  return list;
}
function navigateToOpenedFileByPath(filePath, experimentalGoto, app) {
  if (experimentalGoto) {
    const openedFiles = getAllOpenedFilesExperimental(app);
    for (const openedFile of openedFiles) {
      if (openedFile.type == "leaf" && openedFile.state.state.file === filePath) {
        const leaf = app.workspace.getLeafById(openedFile.id);
        if (leaf && leaf.parent === app.workspace.getLeaf().parent) {
          app.workspace.setActiveLeaf(leaf, { focus: true });
          return true;
        }
      }
    }
  } else {
    const leaves = getAllWorkspaceLeaves(app);
    for (const leaf of leaves) {
      const view = leaf.view;
      if (view.file && view.file.path === filePath && leaf.parent === app.workspace.getLeaf().parent) {
        app.workspace.setActiveLeaf(leaf, { focus: true });
        return true;
      }
    }
  }
  return false;
}

// src/ui/MarkListModal.ts
var MarkListModal = class extends import_obsidian2.SuggestModal {
  constructor(app, plugin, mode, isHarpoonMode = false) {
    super(app);
    this.plugin = plugin;
    this.mode = mode;
    this.isHarpoonMode = isHarpoonMode;
  }
  getInstructions(modalKeybinds) {
    return [
      { command: modalKeybinds.up.join("/"), purpose: "Up" },
      { command: modalKeybinds.down.join("/"), purpose: "Down" },
      { command: "[Symbol]", purpose: modeDescription[this.mode] },
      { command: modalKeybinds.select.join("/"), purpose: modeDescription[this.mode] },
      { command: modalKeybinds.delete.join("/"), purpose: "Delete" },
      { command: modalKeybinds.cancel.join("/"), purpose: "Cancel" },
      { command: modalKeybinds.undo.join("/"), purpose: "Undo" }
    ];
  }
  getSuggestions(query) {
    return getSortedAndFilteredMarks(this.plugin.marks, this.isHarpoonMode, this.plugin.settings);
  }
  renderSuggestion(mark, el) {
    el.createEl("span", { text: mark.symbol, cls: modalMarkSymbolClass });
    el.createEl("span", { text: mark.filePath, cls: modalMarkFilepathClass });
    if (this.plugin.settings.harpoonRegisterList.contains(mark.symbol)) {
      el.createEl("span", { text: "H", cls: modalMarkHarpoonSign });
    }
    el.addEventListener("click", async (evt) => {
      await this.onChooseSuggestion(mark, evt);
      this.close();
    });
  }
  onOpen() {
    super.onOpen();
    if (this.inputEl) {
      this.inputEl.style.display = "none";
    }
    this.modalEl.addClass("marks-modal");
    const modalKeybinds = prepareKeybinds(import_obsidian2.Platform.isMacOS, this.plugin.settings);
    this.setInstructions(this.getInstructions(modalKeybinds));
    this._keyHandler = this.getModalKeyHandler(modalKeybinds);
    window.addEventListener("keydown", this._keyHandler, true);
  }
  onClose() {
    const instructions = this.modalEl.querySelector("." + modalInstructionElClass);
    if (instructions)
      instructions.remove();
    if (this._keyHandler) {
      window.removeEventListener("keydown", this._keyHandler, true);
      this._keyHandler = void 0;
    }
    super.onClose();
  }
  getModalKeyHandler(keybinds) {
    return async (evt) => {
      const availableRegisters = new Set((!this.isHarpoonMode ? this.plugin.settings.registerList : this.plugin.settings.harpoonRegisterList).split(""));
      const chooser = this.chooser;
      if (keybinds.up.some((kb) => matchKeybind(evt, kb))) {
        evt.preventDefault();
        this.moveSelection(-1);
      } else if (keybinds.down.some((kb) => matchKeybind(evt, kb))) {
        evt.preventDefault();
        this.moveSelection(1);
      } else if (keybinds.delete.some((kb) => matchKeybind(evt, kb))) {
        evt.preventDefault();
        const prevIdx = chooser.selectedItem;
        const selected = chooser.values[prevIdx];
        if (selected) {
          await this.deleteMark(selected);
          chooser.values = getSortedAndFilteredMarks(this.plugin.marks, this.isHarpoonMode, this.plugin.settings);
          chooser.setSuggestions(chooser.values);
          chooser.setSelectedItem(Math.max(0, Math.min(prevIdx, chooser.values.length)), false);
        }
      } else if (keybinds.undo.some((kb) => matchKeybind(evt, kb))) {
        evt.preventDefault();
        await this.restoreLastChangedMark();
        chooser.values = getSortedAndFilteredMarks(this.plugin.marks, this.isHarpoonMode, this.plugin.settings);
        const prevIdx = chooser.selectedItem;
        chooser.setSuggestions(chooser.values);
        chooser.setSelectedItem(Math.max(0, prevIdx), false);
      } else if (keybinds.select.some((kb) => matchKeybind(evt, kb))) {
        evt.preventDefault();
        const ind = chooser.selectedItem;
        const selected = chooser.values[ind];
        if (selected) {
          this.onChooseSuggestion(selected, evt);
          this.close();
        }
      } else if (keybinds.cancel.some((kb) => matchKeybind(evt, kb))) {
        evt.preventDefault();
        this.close();
      } else if (availableRegisters.has(evt.key)) {
        let mark = getMarkBySymbol(this.plugin.marks, evt.key);
        if (this.mode === "set") {
          if (mark == null) {
            mark = { symbol: evt.key, filePath: "" };
          }
          evt.preventDefault();
          await this.onChooseSuggestion(mark, evt);
          this.close();
        } else if (this.mode === "goto" && mark) {
          evt.preventDefault();
          await this.onChooseSuggestion(mark, evt);
          this.close();
        } else if (this.mode === "delete" && mark) {
          evt.preventDefault();
          await this.onChooseSuggestion(mark, evt);
          this.close();
        }
      }
    };
  }
  async onChooseSuggestion(mark, evt) {
    if (this.mode === "set") {
      this.setNewOrOverwriteMark(mark);
    } else if (this.mode === "goto") {
      this.goToMark(mark);
    } else if (this.mode === "delete") {
      this.deleteMark(mark);
    }
  }
  moveSelection(delta) {
    const chooser = this.chooser;
    if (!chooser)
      return;
    let idx = chooser.selectedItem;
    if (typeof idx !== "number")
      idx = 0;
    const max = chooser.values.length;
    let next = idx + delta;
    if (next < 0)
      next = max - 1;
    if (next >= max)
      next = 0;
    chooser.setSelectedItem(next, 0);
  }
  async setNewOrOverwriteMark(mark) {
    const file = this.app.workspace.getActiveFile();
    if (!file) {
      new import_obsidian2.Notice("No active file to mark.");
      return;
    }
    const { marks, overwrittenMark } = setNewOrOverwriteMark(this.plugin.marks, mark, file.path);
    await this.plugin.saveMarks(marks);
    if (overwrittenMark) {
      await this.plugin.saveLastChangedMark(overwrittenMark);
    }
    new import_obsidian2.Notice(`Set mark '${mark.symbol}' to ${file.name}`);
  }
  goToMark(mark) {
    const success = navigateToOpenedFileByPath(mark.filePath, this.plugin.settings.experimentalGoto, this.app);
    if (!success) {
      openNewFile(mark.filePath, this.plugin.settings.openMarkInNewTab, this.app);
    }
  }
  async deleteMark(mark) {
    const { marks, deletedMark } = deleteMark(this.plugin.marks, mark);
    await this.plugin.saveMarks(marks);
    if (deletedMark) {
      await this.plugin.saveLastChangedMark(deletedMark);
    }
    if (this.plugin.settings.harpoonRegisterGapRemoval) {
      this.removeGapsForHarpoonMarks();
    }
    new import_obsidian2.Notice(`Deleted mark '${deletedMark == null ? void 0 : deletedMark.symbol}'`);
  }
  async restoreLastChangedMark() {
    if (this.plugin.lastChangedMark) {
      const out = restoreLastChangedMark(this.plugin.marks, this.plugin.lastChangedMark);
      await this.plugin.saveMarks(out.marks);
      new import_obsidian2.Notice(`Restored mark '${this.plugin.lastChangedMark.symbol}' to ${this.plugin.lastChangedMark.filePath}`);
      if (out.markToDiscard) {
        this.plugin.saveLastChangedMark(out.markToDiscard);
      }
    } else {
      new import_obsidian2.Notice("No last changed mark to restore.");
    }
  }
  addFileToHarpoon() {
    const harpoonRegisters = this.plugin.settings.harpoonRegisterList.split("");
    const reg = findFirstUnusedRegister(this.plugin.marks, harpoonRegisters);
    if (reg) {
      const file = this.app.workspace.getActiveFile();
      if (!file) {
        new import_obsidian2.Notice("No active file to mark.");
        return;
      }
      this.setNewOrOverwriteMark({ symbol: reg, filePath: file.path });
    } else {
      new import_obsidian2.Notice("Harpoon registers are full, cannot add more marks.");
    }
  }
  async removeGapsForHarpoonMarks() {
    const harpoonRegisters = this.plugin.settings.harpoonRegisterList.split("");
    const marks = removeGapsForHarpoonMarks(this.plugin.marks, harpoonRegisters);
    await this.plugin.saveMarks(marks);
  }
};

// src/commands.ts
async function setGlobalMark(plugin) {
  new MarkListModal(plugin.app, plugin, "set").open();
}
async function goToGlobalMark(plugin) {
  new MarkListModal(plugin.app, plugin, "goto").open();
}
async function deleteGlobalMark(plugin) {
  new MarkListModal(plugin.app, plugin, "delete").open();
}
async function addFileToHarpoon(plugin) {
  new MarkListModal(plugin.app, plugin, "goto").addFileToHarpoon();
}
async function goToHarpoonMark(plugin) {
  new MarkListModal(plugin.app, plugin, "goto", true).open();
}

// src/ui/SettingsTab.ts
var import_obsidian3 = require("obsidian");
var SettingsTab = class extends import_obsidian3.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    const ds = defaultSettings;
    new import_obsidian3.Setting(containerEl).setName("Open mark in new tab").setDesc('Open a file in the new tab when using "go to" command. If disabled, it will open the file in the current tab.').addToggle(
      (toggle) => {
        var _a;
        return toggle.setValue((_a = this.plugin.settings.openMarkInNewTab) != null ? _a : ds.openMarkInNewTab).onChange(async (value) => {
          this.plugin.settings.openMarkInNewTab = value;
          await this.plugin.saveSettings();
        });
      }
    );
    new import_obsidian3.Setting(containerEl).setName("No duplication of opened files when using Go to commands (experimental)").setDesc("Prevents duplicate tabs when switching to already opened files using the mark list after restarting Obsidian. (Experimental: may not work in future Obsidian versions.)").addToggle(
      (toggle) => {
        var _a;
        return toggle.setValue((_a = this.plugin.settings.experimentalGoto) != null ? _a : ds.experimentalGoto).onChange(async (value) => {
          this.plugin.settings.experimentalGoto = value;
          await this.plugin.saveSettings();
        });
      }
    );
    new import_obsidian3.Setting(containerEl).setName("General registers").setHeading();
    this.createRegisterListSetting(containerEl, "Register list", ds.registerList, "Key symbols to be used as registers. Only include symbols that you can input with a single keystroke.", "registerList").addExtraButton((btn) => {
      btn.setIcon("refresh-ccw").setTooltip("Reset to default register list").onClick(
        async () => {
          this.plugin.settings.registerList = ds.registerList;
          await this.plugin.saveSettings();
          this.display();
        }
      );
    });
    new import_obsidian3.Setting(containerEl).setName("Sort all marks by register list").setDesc("Sort marks by the order of the key symbols in the register list. If disabled, marks will be sorted alphabetically according to the current locale.").addToggle(
      (toggle) => {
        var _a;
        return toggle.setValue((_a = this.plugin.settings.registerSortByList) != null ? _a : ds.registerSortByList).onChange(async (value) => {
          this.plugin.settings.registerSortByList = value;
          await this.plugin.saveSettings();
        });
      }
    );
    new import_obsidian3.Setting(containerEl).setName("Harpoon registers").setHeading();
    this.createRegisterListSetting(containerEl, "Harpoon register list", ds.harpoonRegisterList, "Key symbols to be used as Harpoon registers. Only include symbols that you can input with a single keystroke.", "harpoonRegisterList").addExtraButton((btn) => {
      btn.setIcon("refresh-ccw").setTooltip("Reset to default Harpoon register list").onClick(
        async () => {
          this.plugin.settings.harpoonRegisterList = ds.harpoonRegisterList;
          await this.plugin.saveSettings();
          this.display();
        }
      );
    });
    new import_obsidian3.Setting(containerEl).setName("Sort Harpoon marks by Harpoon register list").setDesc("Sort Harpoon marks by the order of the key symbols in the Harpoon register list. If disabled, marks will be sorted alphabetically according to the current locale.").addToggle(
      (toggle) => {
        var _a;
        return toggle.setValue((_a = this.plugin.settings.harpoonRegisterSortByList) != null ? _a : ds.harpoonRegisterSortByList).onChange(async (value) => {
          this.plugin.settings.harpoonRegisterSortByList = value;
          await this.plugin.saveSettings();
        });
      }
    );
    new import_obsidian3.Setting(containerEl).setName("Remove gaps inbetween Harpoon marks").setDesc("Harpoon marks will be shifted to the left for every gap (register with no mark) based on the order of the Harpoon register list.").addToggle(
      (toggle) => {
        var _a;
        return toggle.setValue((_a = this.plugin.settings.harpoonRegisterGapRemoval) != null ? _a : ds.harpoonRegisterGapRemoval).onChange(async (value) => {
          this.plugin.settings.harpoonRegisterGapRemoval = value;
          await this.plugin.saveSettings();
        });
      }
    );
    containerEl.createEl("h4", { text: "List navigation shortcuts" });
    this.createShortcutSetting(containerEl, "Up", ds.modalListUp, "Shortcut for moving up in the list", "modalListUp");
    this.createShortcutSetting(containerEl, "Down", ds.modalListDown, "Shortcut for moving down in the list", "modalListDown");
    this.createShortcutSetting(containerEl, "Select", ds.modalListSelect, "Shortcut for selecting a mark", "modalListSelect");
    this.createShortcutSetting(containerEl, "Cancel", ds.modalListCancel, "Shortcut for cancelling the modal", "modalListCancel");
    this.createShortcutSetting(containerEl, "Delete", ds.modalListDelete, "Shortcut for deleting a mark", "modalListDelete");
    this.createShortcutSetting(containerEl, "Restore last changed mark", ds.modalListUndo, "Shortcut for undoing last action of changing a mark", "modalListUndo");
  }
  // use only for string values from Settings type
  createShortcutSetting(containerEl, name, defaultValue, desc, key) {
    new import_obsidian3.Setting(containerEl).setName(name).setDesc(desc).addText((text) => {
      var _a;
      return text.setValue(String((_a = this.plugin.settings[key]) != null ? _a : defaultValue)).onChange(async (value) => {
        this.plugin.settings[key] = value;
        await this.plugin.saveSettings();
      });
    });
  }
  createRegisterListSetting(containerEl, name, defaultValue, desc, key) {
    return new import_obsidian3.Setting(containerEl).setName(name).setDesc(desc).addText((text) => {
      var _a;
      return text.setValue(String((_a = this.plugin.settings[key]) != null ? _a : defaultValue)).onChange(async (value) => {
        this.plugin.settings[key] = value;
        await this.plugin.saveSettings();
      });
    });
  }
};

// src/utils/storage.ts
var import_obsidian4 = require("obsidian");
async function loadSettings(plugin) {
  var _a;
  return ((_a = await plugin.loadData()) == null ? void 0 : _a.settings) || defaultSettings;
}
async function saveSettings(plugin, settings) {
  const data = await plugin.loadData() || {};
  data.settings = settings;
  await plugin.saveData(data);
}
async function loadMarks(plugin) {
  var _a;
  return ((_a = await plugin.loadData()) == null ? void 0 : _a.marks) || [];
}
async function saveMarks(plugin, marks) {
  const data = await plugin.loadData() || {};
  data.marks = marks;
  await plugin.saveData(data);
}
async function loadLastChangedMark(plugin) {
  var _a;
  return ((_a = await plugin.loadData()) == null ? void 0 : _a.lastChangedMark) || {};
}
async function saveLastChangedMark(plugin, lastChangedMark) {
  const data = await plugin.loadData() || {};
  data.lastChangedMark = lastChangedMark;
  await plugin.saveData(data);
}
async function JSONschemaCheck(plugin) {
  const data = await plugin.loadData() || { schemaVersion: JSONschemaVersion };
  if (data.schemaVersion && data.schemaVersion === JSONschemaVersion) {
    return;
  }
  new import_obsidian4.Notice(plugin.manifest.name + ": Faulty data. Check developer tools for more info.");
  console.error(plugin.manifest.id + ": The data loaded is not in correct format. The plugin may not work properly. This usually happens after plugin update that changes the JSON schema. ");
}

// src/main.ts
var TetherMarksPlugin = class extends import_obsidian5.Plugin {
  constructor() {
    super(...arguments);
    this.marks = [];
    this.lastChangedMark = null;
  }
  async onload() {
    await JSONschemaCheck(this);
    this.settings = await loadSettings(this);
    this.marks = await loadMarks(this);
    this.lastChangedMark = await loadLastChangedMark(this);
    this.addCommand({
      id: "set-mark",
      name: "Set mark",
      callback: () => setGlobalMark(this)
    });
    this.addCommand({
      id: "go-to-mark",
      name: "Go to mark",
      callback: () => goToGlobalMark(this)
    });
    this.addCommand({
      id: "delete-mark",
      name: "Delete mark",
      callback: () => deleteGlobalMark(this)
    });
    this.addCommand({
      id: "add-file-to-harpoon",
      name: "Add file to Harpoon",
      callback: () => addFileToHarpoon(this)
    });
    this.addCommand({
      id: "go-to-harpoon-mark",
      name: "Go to Harpoon mark",
      callback: () => goToHarpoonMark(this)
    });
    this.addSettingTab(new SettingsTab(this.app, this));
    console.log("loading " + this.manifest.id);
  }
  async saveSettings() {
    await saveSettings(this, this.settings);
  }
  async saveMarks(marks) {
    this.marks = marks;
    await saveMarks(this, marks);
  }
  async saveLastChangedMark(lastChangedMark) {
    this.lastChangedMark = lastChangedMark;
    await saveLastChangedMark(this, lastChangedMark);
  }
  onunload() {
    console.log("unloading " + this.manifest.id);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3VpL01hcmtMaXN0TW9kYWwudHMiLCAic3JjL3V0aWxzL2RlZmF1bHRWYWx1ZXMudHMiLCAic3JjL3V0aWxzL21hcmtzLnRzIiwgInNyYy91dGlscy9rZXliaW5kcy50cyIsICJzcmMvdXRpbHMvb2JzaWRpYW5VdGlscy50cyIsICJzcmMvY29tbWFuZHMudHMiLCAic3JjL3VpL1NldHRpbmdzVGFiLnRzIiwgInNyYy91dGlscy9zdG9yYWdlLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBQbHVnaW4gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBzZXRHbG9iYWxNYXJrLCBnb1RvR2xvYmFsTWFyaywgZ29Ub0hhcnBvb25NYXJrLCBhZGRGaWxlVG9IYXJwb29uLCBkZWxldGVHbG9iYWxNYXJrIH0gZnJvbSAnLi9jb21tYW5kcyc7XG5pbXBvcnQgeyBTZXR0aW5nc1RhYiB9IGZyb20gJy4vdWkvU2V0dGluZ3NUYWInO1xuaW1wb3J0IHsgbG9hZFNldHRpbmdzLCBzYXZlU2V0dGluZ3MsIGxvYWRNYXJrcywgc2F2ZU1hcmtzLCBsb2FkTGFzdENoYW5nZWRNYXJrLCBzYXZlTGFzdENoYW5nZWRNYXJrLCBKU09Oc2NoZW1hQ2hlY2sgfSBmcm9tICcuL3V0aWxzL3N0b3JhZ2UnO1xuaW1wb3J0IHsgU2V0dGluZ3MsIE1hcmsgfSBmcm9tICcuL3R5cGVzL2luZGV4JztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGV0aGVyTWFya3NQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuICAgIHNldHRpbmdzITogU2V0dGluZ3M7XG4gICAgbWFya3M6IE1hcmtbXSA9IFtdO1xuICAgIGxhc3RDaGFuZ2VkTWFyazogTWFyayB8IG51bGwgPSBudWxsO1xuXG4gICAgYXN5bmMgb25sb2FkKCkge1xuICAgICAgICBhd2FpdCBKU09Oc2NoZW1hQ2hlY2sodGhpcyk7XG5cbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IGF3YWl0IGxvYWRTZXR0aW5ncyh0aGlzKTtcbiAgICAgICAgdGhpcy5tYXJrcyA9IGF3YWl0IGxvYWRNYXJrcyh0aGlzKTtcbiAgICAgICAgdGhpcy5sYXN0Q2hhbmdlZE1hcmsgPSBhd2FpdCBsb2FkTGFzdENoYW5nZWRNYXJrKHRoaXMpO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ3NldC1tYXJrJyxcbiAgICAgICAgICAgIG5hbWU6ICdTZXQgbWFyaycsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4gc2V0R2xvYmFsTWFyayh0aGlzKSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnZ28tdG8tbWFyaycsXG4gICAgICAgICAgICBuYW1lOiAnR28gdG8gbWFyaycsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4gZ29Ub0dsb2JhbE1hcmsodGhpcyksXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ2RlbGV0ZS1tYXJrJyxcbiAgICAgICAgICAgIG5hbWU6ICdEZWxldGUgbWFyaycsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4gZGVsZXRlR2xvYmFsTWFyayh0aGlzKSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnYWRkLWZpbGUtdG8taGFycG9vbicsXG4gICAgICAgICAgICBuYW1lOiAnQWRkIGZpbGUgdG8gSGFycG9vbicsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4gYWRkRmlsZVRvSGFycG9vbih0aGlzKSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnZ28tdG8taGFycG9vbi1tYXJrJyxcbiAgICAgICAgICAgIG5hbWU6ICdHbyB0byBIYXJwb29uIG1hcmsnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IGdvVG9IYXJwb29uTWFyayh0aGlzKSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBTZXR0aW5nc1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKCdsb2FkaW5nICcgKyB0aGlzLm1hbmlmZXN0LmlkKTtcbiAgICB9XG5cbiAgICBhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG4gICAgICAgIGF3YWl0IHNhdmVTZXR0aW5ncyh0aGlzLCB0aGlzLnNldHRpbmdzKTtcbiAgICB9XG5cbiAgICBhc3luYyBzYXZlTWFya3MobWFya3M6IE1hcmtbXSkge1xuICAgICAgICB0aGlzLm1hcmtzID0gbWFya3M7XG4gICAgICAgIGF3YWl0IHNhdmVNYXJrcyh0aGlzLCBtYXJrcyk7XG4gICAgfVxuXG4gICAgYXN5bmMgc2F2ZUxhc3RDaGFuZ2VkTWFyayhsYXN0Q2hhbmdlZE1hcms6IE1hcmspIHtcbiAgICAgICAgdGhpcy5sYXN0Q2hhbmdlZE1hcmsgPSBsYXN0Q2hhbmdlZE1hcms7XG4gICAgICAgIGF3YWl0IHNhdmVMYXN0Q2hhbmdlZE1hcmsodGhpcywgbGFzdENoYW5nZWRNYXJrKTtcbiAgICB9XG5cbiAgICBvbnVubG9hZCgpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ3VubG9hZGluZyAnICsgdGhpcy5tYW5pZmVzdC5pZCk7XG4gICAgfVxufSIsICJpbXBvcnQgeyBBcHAsIE5vdGljZSwgU3VnZ2VzdE1vZGFsLCBQbGF0Zm9ybSwgSW5zdHJ1Y3Rpb24gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgVGV0aGVyTWFya3NQbHVnaW4gZnJvbSAnLi4vbWFpbic7XG5pbXBvcnQgeyBNb2RhbEtleWJpbmRzLCBNYXJrIH0gZnJvbSAnLi4vdHlwZXMvaW5kZXgnO1xuaW1wb3J0IHsgTW9kZSB9IGZyb20gXCIuLi90eXBlc1wiO1xuaW1wb3J0IHsgbW9kYWxJbnN0cnVjdGlvbkVsQ2xhc3MsIG1vZGFsTWFya0ZpbGVwYXRoQ2xhc3MsIG1vZGFsTWFya1N5bWJvbENsYXNzLCBtb2RhbFBsYWNlaG9sZGVyTWVzc2FnZXMsIG1vZGFsTWFya0hhcnBvb25TaWduLCBtb2RlRGVzY3JpcHRpb24gfSBmcm9tICcuLi91dGlscy9kZWZhdWx0VmFsdWVzJztcbmltcG9ydCB7IGRlbGV0ZU1hcmssIGZpbmRGaXJzdFVudXNlZFJlZ2lzdGVyLCBnZXRNYXJrQnlTeW1ib2wsIGdldFNvcnRlZEFuZEZpbHRlcmVkTWFya3MsIHJlbW92ZUdhcHNGb3JIYXJwb29uTWFya3MsIHJlc3RvcmVMYXN0Q2hhbmdlZE1hcmssIHNldE5ld09yT3ZlcndyaXRlTWFyayB9IGZyb20gJy4uL3V0aWxzL21hcmtzJztcbmltcG9ydCB7IG1hdGNoS2V5YmluZCwgcHJlcGFyZUtleWJpbmRzIH0gZnJvbSAnLi4vdXRpbHMva2V5YmluZHMnO1xuaW1wb3J0IHsgbmF2aWdhdGVUb09wZW5lZEZpbGVCeVBhdGgsIG9wZW5OZXdGaWxlIGFzIG9wZW5OZXdGaWxlQnlQYXRoIH0gZnJvbSAnLi4vdXRpbHMvb2JzaWRpYW5VdGlscyc7XG5cblxuZXhwb3J0IGNsYXNzIE1hcmtMaXN0TW9kYWwgZXh0ZW5kcyBTdWdnZXN0TW9kYWw8TWFyaz4ge1xuICAgIHBsdWdpbjogVGV0aGVyTWFya3NQbHVnaW47XG4gICAgbW9kZTogTW9kZTtcbiAgICBwcml2YXRlIF9rZXlIYW5kbGVyPzogKGV2dDogS2V5Ym9hcmRFdmVudCkgPT4gdm9pZDtcbiAgICBpc0hhcnBvb25Nb2RlOiBib29sZWFuO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogVGV0aGVyTWFya3NQbHVnaW4sIG1vZGU6IE1vZGUsIGlzSGFycG9vbk1vZGU6IGJvb2xlYW4gPSBmYWxzZSkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICAgICAgdGhpcy5tb2RlID0gbW9kZTtcbiAgICAgICAgLy8gbm90IHVzZWQsIG5vIGlucHV0IGZpZWxkXG4gICAgICAgIC8vIHRoaXMuc2V0UGxhY2Vob2xkZXIobW9kYWxQbGFjZWhvbGRlck1lc3NhZ2VzW3RoaXMubW9kZV0pO1xuICAgICAgICB0aGlzLmlzSGFycG9vbk1vZGUgPSBpc0hhcnBvb25Nb2RlO1xuICAgIH1cblxuICAgIGdldEluc3RydWN0aW9ucyhtb2RhbEtleWJpbmRzOiBNb2RhbEtleWJpbmRzKTogSW5zdHJ1Y3Rpb25bXSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICB7IGNvbW1hbmQ6IG1vZGFsS2V5YmluZHMudXAuam9pbihcIi9cIiksIHB1cnBvc2U6ICdVcCcgfSxcbiAgICAgICAgICAgIHsgY29tbWFuZDogbW9kYWxLZXliaW5kcy5kb3duLmpvaW4oXCIvXCIpLCBwdXJwb3NlOiAnRG93bicgfSxcbiAgICAgICAgICAgIHsgY29tbWFuZDogJ1tTeW1ib2xdJywgcHVycG9zZTogbW9kZURlc2NyaXB0aW9uW3RoaXMubW9kZV0gfSxcbiAgICAgICAgICAgIHsgY29tbWFuZDogbW9kYWxLZXliaW5kcy5zZWxlY3Quam9pbihcIi9cIiksIHB1cnBvc2U6IG1vZGVEZXNjcmlwdGlvblt0aGlzLm1vZGVdIH0sXG4gICAgICAgICAgICB7IGNvbW1hbmQ6IG1vZGFsS2V5YmluZHMuZGVsZXRlLmpvaW4oXCIvXCIpLCBwdXJwb3NlOiAnRGVsZXRlJyB9LFxuICAgICAgICAgICAgeyBjb21tYW5kOiBtb2RhbEtleWJpbmRzLmNhbmNlbC5qb2luKFwiL1wiKSwgcHVycG9zZTogJ0NhbmNlbCcgfSxcbiAgICAgICAgICAgIHsgY29tbWFuZDogbW9kYWxLZXliaW5kcy51bmRvLmpvaW4oXCIvXCIpLCBwdXJwb3NlOiAnVW5kbycgfSxcblxuICAgICAgICBdO1xuICAgIH1cblxuICAgIGdldFN1Z2dlc3Rpb25zKHF1ZXJ5OiBzdHJpbmcpOiBNYXJrW10ge1xuICAgICAgICAvLyBObyBzZWFyY2ggaW5wdXRcbiAgICAgICAgcmV0dXJuIGdldFNvcnRlZEFuZEZpbHRlcmVkTWFya3ModGhpcy5wbHVnaW4ubWFya3MsIHRoaXMuaXNIYXJwb29uTW9kZSwgdGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuICAgIH1cblxuICAgIHJlbmRlclN1Z2dlc3Rpb24obWFyazogTWFyaywgZWw6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIGVsLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiBtYXJrLnN5bWJvbCwgY2xzOiBtb2RhbE1hcmtTeW1ib2xDbGFzcyB9KTtcbiAgICAgICAgZWwuY3JlYXRlRWwoJ3NwYW4nLCB7IHRleHQ6IG1hcmsuZmlsZVBhdGgsIGNsczogbW9kYWxNYXJrRmlsZXBhdGhDbGFzcyB9KTtcbiAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmhhcnBvb25SZWdpc3Rlckxpc3QuY29udGFpbnMobWFyay5zeW1ib2wpKSB7XG4gICAgICAgICAgICBlbC5jcmVhdGVFbCgnc3BhbicsIHsgdGV4dDogXCJIXCIsIGNsczogbW9kYWxNYXJrSGFycG9vblNpZ24gfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoZXZ0KSA9PiB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLm9uQ2hvb3NlU3VnZ2VzdGlvbihtYXJrLCBldnQpO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIHN1cGVyLm9uT3BlbigpO1xuICAgICAgICAvLyBIaWRlIHRoZSBpbnB1dCBib3gsIGFzIGl0J3Mgbm90IG5lZWRlZFxuICAgICAgICBpZiAodGhpcy5pbnB1dEVsKSB7XG4gICAgICAgICAgICB0aGlzLmlucHV0RWwuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1vZGFsRWwuYWRkQ2xhc3MoJ21hcmtzLW1vZGFsJyk7XG5cbiAgICAgICAgY29uc3QgbW9kYWxLZXliaW5kcyA9IHByZXBhcmVLZXliaW5kcyhQbGF0Zm9ybS5pc01hY09TLCB0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XG4gICAgICAgIHRoaXMuc2V0SW5zdHJ1Y3Rpb25zKHRoaXMuZ2V0SW5zdHJ1Y3Rpb25zKG1vZGFsS2V5YmluZHMpKTtcblxuICAgICAgICB0aGlzLl9rZXlIYW5kbGVyID0gdGhpcy5nZXRNb2RhbEtleUhhbmRsZXIobW9kYWxLZXliaW5kcyk7XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5fa2V5SGFuZGxlciwgdHJ1ZSk7XG4gICAgfVxuXG4gICAgb25DbG9zZSgpIHtcbiAgICAgICAgLy8gUmVtb3ZlIGluc3RydWN0aW9ucyBwYW5lbCBpZiBwcmVzZW50XG4gICAgICAgIGNvbnN0IGluc3RydWN0aW9ucyA9IHRoaXMubW9kYWxFbC5xdWVyeVNlbGVjdG9yKFwiLlwiICsgbW9kYWxJbnN0cnVjdGlvbkVsQ2xhc3MpO1xuICAgICAgICBpZiAoaW5zdHJ1Y3Rpb25zKSBpbnN0cnVjdGlvbnMucmVtb3ZlKCk7XG5cbiAgICAgICAgaWYgKHRoaXMuX2tleUhhbmRsZXIpIHtcbiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5fa2V5SGFuZGxlciwgdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLl9rZXlIYW5kbGVyID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHN1cGVyLm9uQ2xvc2UoKTtcbiAgICB9XG5cbiAgICBnZXRNb2RhbEtleUhhbmRsZXIoa2V5YmluZHM6IE1vZGFsS2V5YmluZHMpIHtcbiAgICAgICAgcmV0dXJuIGFzeW5jIChldnQ6IEtleWJvYXJkRXZlbnQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGF2YWlsYWJsZVJlZ2lzdGVycyA9IG5ldyBTZXQoKCF0aGlzLmlzSGFycG9vbk1vZGUgPyB0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZWdpc3Rlckxpc3QgOiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5oYXJwb29uUmVnaXN0ZXJMaXN0KS5zcGxpdCgnJykpO1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgY29uc3QgY2hvb3NlciA9IHRoaXMuY2hvb3NlcjtcbiAgICAgICAgICAgIGlmIChrZXliaW5kcy51cC5zb21lKGtiID0+IG1hdGNoS2V5YmluZChldnQsIGtiKSkpIHtcbiAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1vdmVTZWxlY3Rpb24oLTEpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChrZXliaW5kcy5kb3duLnNvbWUoa2IgPT4gbWF0Y2hLZXliaW5kKGV2dCwga2IpKSkge1xuICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHRoaXMubW92ZVNlbGVjdGlvbigxKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoa2V5YmluZHMuZGVsZXRlLnNvbWUoa2IgPT4gbWF0Y2hLZXliaW5kKGV2dCwga2IpKSkge1xuICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIC8vIERlbGV0ZSB0aGUgY3VycmVudGx5IHNlbGVjdGVkIG1hcmtcbiAgICAgICAgICAgICAgICBjb25zdCBwcmV2SWR4ID0gY2hvb3Nlci5zZWxlY3RlZEl0ZW07XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWQ6IE1hcmsgPSBjaG9vc2VyLnZhbHVlc1twcmV2SWR4XTtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kZWxldGVNYXJrKHNlbGVjdGVkKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVmcmVzaCB0aGUgbW9kYWwgbGlzdFxuICAgICAgICAgICAgICAgICAgICBjaG9vc2VyLnZhbHVlcyA9IGdldFNvcnRlZEFuZEZpbHRlcmVkTWFya3ModGhpcy5wbHVnaW4ubWFya3MsIHRoaXMuaXNIYXJwb29uTW9kZSwgdGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuICAgICAgICAgICAgICAgICAgICBjaG9vc2VyLnNldFN1Z2dlc3Rpb25zKGNob29zZXIudmFsdWVzKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gUHJlc2VydmUgc2VsZWN0aW9uIGluZGV4XG4gICAgICAgICAgICAgICAgICAgIGNob29zZXIuc2V0U2VsZWN0ZWRJdGVtKE1hdGgubWF4KDAsIE1hdGgubWluKHByZXZJZHgsIGNob29zZXIudmFsdWVzLmxlbmd0aCkpLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoa2V5YmluZHMudW5kby5zb21lKGtiID0+IG1hdGNoS2V5YmluZChldnQsIGtiKSkpIHtcbiAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAvLyBSZXN0b3JlIHRoZSBsYXN0IGNoYW5nZWQgbWFya1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucmVzdG9yZUxhc3RDaGFuZ2VkTWFyaygpO1xuICAgICAgICAgICAgICAgIC8vIFJlZnJlc2ggdGhlIG1vZGFsIGxpc3RcbiAgICAgICAgICAgICAgICBjaG9vc2VyLnZhbHVlcyA9IGdldFNvcnRlZEFuZEZpbHRlcmVkTWFya3ModGhpcy5wbHVnaW4ubWFya3MsIHRoaXMuaXNIYXJwb29uTW9kZSwgdGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHByZXZJZHggPSBjaG9vc2VyLnNlbGVjdGVkSXRlbTtcbiAgICAgICAgICAgICAgICBjaG9vc2VyLnNldFN1Z2dlc3Rpb25zKGNob29zZXIudmFsdWVzKTtcbiAgICAgICAgICAgICAgICBjaG9vc2VyLnNldFNlbGVjdGVkSXRlbShNYXRoLm1heCgwLCBwcmV2SWR4KSwgZmFsc2UpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChrZXliaW5kcy5zZWxlY3Quc29tZShrYiA9PiBtYXRjaEtleWJpbmQoZXZ0LCBrYikpKSB7XG4gICAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgbWFya1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZCA9IGNob29zZXIuc2VsZWN0ZWRJdGVtO1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkOiBNYXJrID0gY2hvb3Nlci52YWx1ZXNbaW5kXTtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkNob29zZVN1Z2dlc3Rpb24oc2VsZWN0ZWQsIGV2dCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGtleWJpbmRzLmNhbmNlbC5zb21lKGtiID0+IG1hdGNoS2V5YmluZChldnQsIGtiKSkpIHtcbiAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGF2YWlsYWJsZVJlZ2lzdGVycy5oYXMoZXZ0LmtleSkpIHtcbiAgICAgICAgICAgICAgICBsZXQgbWFyayA9IGdldE1hcmtCeVN5bWJvbCh0aGlzLnBsdWdpbi5tYXJrcywgZXZ0LmtleSk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubW9kZSA9PT0gJ3NldCcpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmsgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFyayA9IHsgc3ltYm9sOiBldnQua2V5LCBmaWxlUGF0aDogXCJcIiB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLm9uQ2hvb3NlU3VnZ2VzdGlvbihtYXJrLCBldnQpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLm1vZGUgPT09ICdnb3RvJyAmJiBtYXJrKSB7XG4gICAgICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLm9uQ2hvb3NlU3VnZ2VzdGlvbihtYXJrLCBldnQpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMubW9kZSA9PT0gJ2RlbGV0ZScgJiYgbWFyaykge1xuICAgICAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5vbkNob29zZVN1Z2dlc3Rpb24obWFyaywgZXZ0KTtcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVmcmVzaCB0aGUgbW9kYWwgbGlzdFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIGFzeW5jIG9uQ2hvb3NlU3VnZ2VzdGlvbihtYXJrOiBNYXJrLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KSB7XG4gICAgICAgIGlmICh0aGlzLm1vZGUgPT09ICdzZXQnKSB7XG4gICAgICAgICAgICB0aGlzLnNldE5ld09yT3ZlcndyaXRlTWFyayhtYXJrKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLm1vZGUgPT09ICdnb3RvJykge1xuICAgICAgICAgICAgdGhpcy5nb1RvTWFyayhtYXJrKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLm1vZGUgPT09ICdkZWxldGUnKSB7XG4gICAgICAgICAgICB0aGlzLmRlbGV0ZU1hcmsobWFyayk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBtb3ZlU2VsZWN0aW9uKGRlbHRhOiBudW1iZXIpIHtcbiAgICAgICAgLy8gTW92ZSB0aGUgc2VsZWN0aW9uIHVwIG9yIGRvd24gYnkgZGVsdGFcbiAgICAgICAgLy8gdGhpcy5jaG9vc2VyIGlzIFN1Z2dlc3RNb2RhbCdzIGludGVybmFsIGNob29zZXJcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBjb25zdCBjaG9vc2VyID0gdGhpcy5jaG9vc2VyO1xuICAgICAgICBpZiAoIWNob29zZXIpIHJldHVybjtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBsZXQgaWR4ID0gY2hvb3Nlci5zZWxlY3RlZEl0ZW07XG4gICAgICAgIGlmICh0eXBlb2YgaWR4ICE9PSAnbnVtYmVyJykgaWR4ID0gMDtcbiAgICAgICAgY29uc3QgbWF4ID0gY2hvb3Nlci52YWx1ZXMubGVuZ3RoO1xuICAgICAgICBsZXQgbmV4dCA9IGlkeCArIGRlbHRhO1xuICAgICAgICBpZiAobmV4dCA8IDApIG5leHQgPSBtYXggLSAxO1xuICAgICAgICBpZiAobmV4dCA+PSBtYXgpIG5leHQgPSAwO1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGNob29zZXIuc2V0U2VsZWN0ZWRJdGVtKG5leHQsIDAgYXMgS2V5Ym9hcmRFdmVudCk7XG4gICAgfVxuXG4gICAgYXN5bmMgc2V0TmV3T3JPdmVyd3JpdGVNYXJrKG1hcms6IE1hcmspIHtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmICghZmlsZSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnTm8gYWN0aXZlIGZpbGUgdG8gbWFyay4nKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB7IG1hcmtzLCBvdmVyd3JpdHRlbk1hcmsgfSA9IHNldE5ld09yT3ZlcndyaXRlTWFyayh0aGlzLnBsdWdpbi5tYXJrcywgbWFyaywgZmlsZS5wYXRoKTtcbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZU1hcmtzKG1hcmtzKTtcbiAgICAgICAgaWYgKG92ZXJ3cml0dGVuTWFyayl7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlTGFzdENoYW5nZWRNYXJrKG92ZXJ3cml0dGVuTWFyayk7XG4gICAgICAgIH1cbiAgICAgICAgbmV3IE5vdGljZShgU2V0IG1hcmsgJyR7bWFyay5zeW1ib2x9JyB0byAke2ZpbGUubmFtZX1gKTtcbiAgICB9XG5cbiAgICBnb1RvTWFyayhtYXJrOiBNYXJrKSB7XG4gICAgICAgIGNvbnN0IHN1Y2Nlc3MgPSBuYXZpZ2F0ZVRvT3BlbmVkRmlsZUJ5UGF0aChtYXJrLmZpbGVQYXRoLCB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leHBlcmltZW50YWxHb3RvLCB0aGlzLmFwcCk7XG4gICAgICAgIC8vIElmIGZpbGUgbm90IG9wZW4sIHRoZW4gb3BlbiBpdCBpbiB0aGUgcHJlZmVycmVkIHRhYlxuICAgICAgICBpZiAoIXN1Y2Nlc3MpIHtcbiAgICAgICAgICAgIG9wZW5OZXdGaWxlQnlQYXRoKG1hcmsuZmlsZVBhdGgsIHRoaXMucGx1Z2luLnNldHRpbmdzLm9wZW5NYXJrSW5OZXdUYWIsIHRoaXMuYXBwKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgZGVsZXRlTWFyayhtYXJrOiBNYXJrKSB7XG4gICAgICAgIGNvbnN0IHsgbWFya3MsIGRlbGV0ZWRNYXJrIH0gPSBkZWxldGVNYXJrKHRoaXMucGx1Z2luLm1hcmtzLCBtYXJrKTtcbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZU1hcmtzKG1hcmtzKTtcblxuICAgICAgICBpZiAoZGVsZXRlZE1hcmspe1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZUxhc3RDaGFuZ2VkTWFyayhkZWxldGVkTWFyayk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuaGFycG9vblJlZ2lzdGVyR2FwUmVtb3ZhbCkge1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVHYXBzRm9ySGFycG9vbk1hcmtzKCk7XG4gICAgICAgIH1cblxuICAgICAgICBuZXcgTm90aWNlKGBEZWxldGVkIG1hcmsgJyR7ZGVsZXRlZE1hcms/LnN5bWJvbH0nYCk7XG4gICAgfTtcblxuICAgIGFzeW5jIHJlc3RvcmVMYXN0Q2hhbmdlZE1hcmsoKSB7XG4gICAgICAgIC8vIFVuZG8gdGhlIGxhc3QgY2hhbmdlZCBtYXJrXG4gICAgICAgIGlmICh0aGlzLnBsdWdpbi5sYXN0Q2hhbmdlZE1hcmspIHtcbiAgICAgICAgICAgIGNvbnN0IG91dCA9IHJlc3RvcmVMYXN0Q2hhbmdlZE1hcmsodGhpcy5wbHVnaW4ubWFya3MsIHRoaXMucGx1Z2luLmxhc3RDaGFuZ2VkTWFyaylcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVNYXJrcyhvdXQubWFya3MpO1xuICAgICAgICAgICAgbmV3IE5vdGljZShgUmVzdG9yZWQgbWFyayAnJHt0aGlzLnBsdWdpbi5sYXN0Q2hhbmdlZE1hcmsuc3ltYm9sfScgdG8gJHt0aGlzLnBsdWdpbi5sYXN0Q2hhbmdlZE1hcmsuZmlsZVBhdGh9YCk7XG4gICAgICAgICAgICBpZiAob3V0Lm1hcmtUb0Rpc2NhcmQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlTGFzdENoYW5nZWRNYXJrKG91dC5tYXJrVG9EaXNjYXJkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ05vIGxhc3QgY2hhbmdlZCBtYXJrIHRvIHJlc3RvcmUuJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhZGRGaWxlVG9IYXJwb29uKCkge1xuICAgICAgICAvLyBBZGQgdGhlIHNlbGVjdGVkIG1hcmsgdG8gdGhlIEhhcnBvb24gbGlzdFxuICAgICAgICBjb25zdCBoYXJwb29uUmVnaXN0ZXJzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuaGFycG9vblJlZ2lzdGVyTGlzdC5zcGxpdCgnJyk7XG4gICAgICAgIGNvbnN0IHJlZyA9IGZpbmRGaXJzdFVudXNlZFJlZ2lzdGVyKHRoaXMucGx1Z2luLm1hcmtzLCBoYXJwb29uUmVnaXN0ZXJzKTtcblxuICAgICAgICBpZiAocmVnKSB7XG4gICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgICAgIGlmICghZmlsZSkge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ05vIGFjdGl2ZSBmaWxlIHRvIG1hcmsuJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zZXROZXdPck92ZXJ3cml0ZU1hcmsoeyBzeW1ib2w6IHJlZywgZmlsZVBhdGg6IGZpbGUucGF0aCB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIElmIGFsbCByZWdpc3RlcnMgYXJlIHVzZWQsIHNob3cgYSBub3RpY2VcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ0hhcnBvb24gcmVnaXN0ZXJzIGFyZSBmdWxsLCBjYW5ub3QgYWRkIG1vcmUgbWFya3MuJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyByZW1vdmVHYXBzRm9ySGFycG9vbk1hcmtzKCkge1xuICAgICAgICBjb25zdCBoYXJwb29uUmVnaXN0ZXJzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuaGFycG9vblJlZ2lzdGVyTGlzdC5zcGxpdCgnJyk7XG4gICAgICAgIGNvbnN0IG1hcmtzID0gcmVtb3ZlR2Fwc0ZvckhhcnBvb25NYXJrcyh0aGlzLnBsdWdpbi5tYXJrcywgaGFycG9vblJlZ2lzdGVycyk7XG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVNYXJrcyhtYXJrcyk7XG4gICAgfVxuXG59IiwgImltcG9ydCB7IE1vZGFsS2V5YmluZHMsIFNldHRpbmdzLCBNb2RlIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcblxyXG5leHBvcnQgY29uc3QgbW9kYWxEZWZhdWx0S2V5YmluZHM6IE1vZGFsS2V5YmluZHMgPSB7XHJcbiAgICB1cDogWydjdHJsK2snLCAnY3RybCtwJ10gYXMgc3RyaW5nW10sXHJcbiAgICBkb3duOiBbJ2N0cmwraicsICdjdHJsK24nXSBhcyBzdHJpbmdbXSxcclxuICAgIGRlbGV0ZTogWydjdHJsK2QnXSBhcyBzdHJpbmdbXSxcclxuICAgIHNlbGVjdDogWydFbnRlciddIGFzIHN0cmluZ1tdLFxyXG4gICAgY2FuY2VsOiBbJ0VzY2FwZSddIGFzIHN0cmluZ1tdLFxyXG4gICAgdW5kbzogWydjdHJsK3UnXSBhcyBzdHJpbmdbXSxcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IG1vZGFsRGVmYXVsdEtleWJpbmRzTWFjOiBNb2RhbEtleWJpbmRzID0ge1xyXG4gICAgdXA6IFsnY21kK2snLCAnY21kK3AnXSBhcyBzdHJpbmdbXSxcclxuICAgIGRvd246IFsnY21kK2onLCAnY21kK24nXSBhcyBzdHJpbmdbXSxcclxuICAgIGRlbGV0ZTogWydjbWQrZCddIGFzIHN0cmluZ1tdLFxyXG4gICAgc2VsZWN0OiBbJ0VudGVyJ10gYXMgc3RyaW5nW10sXHJcbiAgICBjYW5jZWw6IFsnRXNjYXBlJ10gYXMgc3RyaW5nW10sXHJcbiAgICB1bmRvOiBbJ2NtZCt1J10gYXMgc3RyaW5nW10sXHJcbn1cclxuXHJcbi8vIFRoaXMgaXMgbm90IHVzZWQgZm9yIG5vd1xyXG5leHBvcnQgY29uc3QgbW9kYWxQbGFjZWhvbGRlck1lc3NhZ2VzIDogUmVjb3JkPE1vZGUsIHN0cmluZz4gPSB7XHJcbiAgICBzZXQ6ICdTZWxlY3QgYSBtYXJrIHRvIHNldCcsXHJcbiAgICBnb3RvOiAnU2VsZWN0IGEgbWFyayB0byBnbyB0bycsXHJcbiAgICBkZWxldGU6ICdTZWxlY3QgYSBtYXJrIHRvIGRlbGV0ZScsXHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZGVmYXVsdFNldHRpbmdzOiBTZXR0aW5ncyA9IHtcclxuICAgIC8vIGhpZGVNYXJrTGlzdER1cmluZ0lucHV0OiBmYWxzZSxcclxuICAgIG1vZGFsTGlzdFVwOiAnJyxcclxuICAgIG1vZGFsTGlzdERvd246ICcnLFxyXG4gICAgbW9kYWxMaXN0U2VsZWN0OiAnJyxcclxuICAgIG1vZGFsTGlzdFVuZG86ICcnLFxyXG4gICAgbW9kYWxMaXN0RGVsZXRlOiAnJyxcclxuICAgIG1vZGFsTGlzdENhbmNlbDogJycsXHJcbiAgICBvcGVuTWFya0luTmV3VGFiOiBmYWxzZSwgLy8gSWYgdHJ1ZSwgb3BlbiBtYXJrIGluIG5ldyB0YWIsIGVsc2UgaW4gY3VycmVudCB0YWJcclxuICAgIHJlZ2lzdGVyTGlzdDogJ2FiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6JyxcclxuICAgIHJlZ2lzdGVyU29ydEJ5TGlzdDogdHJ1ZSxcclxuICAgIGhhcnBvb25SZWdpc3Rlckxpc3Q6ICdxd2VyJyxcclxuICAgIGhhcnBvb25SZWdpc3RlclNvcnRCeUxpc3Q6IHRydWUsXHJcbiAgICBoYXJwb29uUmVnaXN0ZXJHYXBSZW1vdmFsOiB0cnVlLFxyXG4gICAgZXhwZXJpbWVudGFsR290bzogZmFsc2UsXHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgbW9kYWxJbnN0cnVjdGlvbkVsQ2xhc3MgPSAnbW9kYWwtaW5zdHJ1Y3Rpb24tZWwnO1xyXG5leHBvcnQgY29uc3QgbW9kYWxNYXJrU3ltYm9sQ2xhc3MgPSAnbWFyay1zeW1ib2wnO1xyXG5leHBvcnQgY29uc3QgbW9kYWxNYXJrRmlsZXBhdGhDbGFzcyA9ICdtYXJrLWZpbGUtcGF0aCc7XHJcbmV4cG9ydCBjb25zdCBtb2RhbE1hcmtIYXJwb29uU2lnbiA9ICdoYXJwb29uLXNpZ24nO1xyXG5cclxuZXhwb3J0IGNvbnN0IEpTT05zY2hlbWFWZXJzaW9uID0gMTtcclxuXHJcbmV4cG9ydCBjb25zdCBtb2RlRGVzY3JpcHRpb24gOiBSZWNvcmQ8TW9kZSwgc3RyaW5nPiA9IHtcclxuICAgICdzZXQnOiAnU2V0IG1hcmsnLFxyXG4gICAgJ2dvdG8nOiAnR28gdG8gbWFyaycsXHJcbiAgICAnZGVsZXRlJzogJ0RlbGV0ZSBtYXJrJ1xyXG59IiwgImltcG9ydCB7IFNldHRpbmdzIH0gZnJvbSAnLi4vdHlwZXMvaW5kZXgnO1xyXG5pbXBvcnQgeyBNYXJrIH0gZnJvbSAnLi4vdHlwZXMvaW5kZXgnO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGZpbmRGaXJzdFVudXNlZFJlZ2lzdGVyKG1hcmtzOiBNYXJrW10sIHJlZ2lzdGVyczogc3RyaW5nW10pOiBzdHJpbmcgfCBudWxsIHtcclxuICAgIGZvciAoY29uc3QgcmVnIG9mIHJlZ2lzdGVycykge1xyXG4gICAgICAgIC8vIGlmIHJlZ2lzdGVyIG5vdCB1c2VkIGFscmVhZHksIHRoZW4gdXNlIGl0XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ0NoZWNraW5nIHJlZ2lzdGVyOicsIHJlZyk7XHJcbiAgICAgICAgaWYgKCEobWFya3MubWFwKG0gPT4gbS5zeW1ib2wpLmluY2x1ZGVzKHJlZykpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZWc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRNYXJrQnlTeW1ib2wobWFya3M6IE1hcmtbXSwgc3ltYm9sOiBzdHJpbmcpOiBNYXJrIHwgdW5kZWZpbmVkIHtcclxuICAgIHJldHVybiBtYXJrcy5maW5kKG0gPT4gbS5zeW1ib2wgPT09IHN5bWJvbCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzb3J0TWFya3NBbHBoYWJldGljYWxseShtYXJrczogTWFya1tdKSB7XHJcbiAgICBtYXJrcy5zb3J0KChhLCBiKSA9PiBhLnN5bWJvbC5sb2NhbGVDb21wYXJlKGIuc3ltYm9sKSlcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFNvcnRlZEFuZEZpbHRlcmVkTWFya3MobWFya3M6IE1hcmtbXSwgaXNIYXJwb29uTW9kZTogYm9vbGVhbiwgc2V0dGluZ3M6IFNldHRpbmdzKTogTWFya1tdIHtcclxuICAgIGNvbnN0IGF2YWlsYWJsZVJlZ2lzdGVycyA9IG5ldyBTZXQoKCFpc0hhcnBvb25Nb2RlID8gc2V0dGluZ3MucmVnaXN0ZXJMaXN0IDogc2V0dGluZ3MuaGFycG9vblJlZ2lzdGVyTGlzdCkuc3BsaXQoJycpKTtcclxuICAgIGNvbnN0IGZpbHRlcmVkTWFya3M6IE1hcmtbXSA9IG1hcmtzLmZpbHRlcihlbCA9PiBhdmFpbGFibGVSZWdpc3RlcnMuaGFzKGVsLnN5bWJvbCkpO1xyXG4gICAgaWYgKCFpc0hhcnBvb25Nb2RlICYmIHNldHRpbmdzLnJlZ2lzdGVyU29ydEJ5TGlzdCkge1xyXG4gICAgICAgIC8vIFNvcnQgbWFya3MgYnkgdGhlIG9yZGVyIG9mIHRoZSBrZXkgc3ltYm9scyBpbiB0aGUgcmVnaXN0ZXIgbGlzdFxyXG4gICAgICAgIGNvbnN0IHJlZ2lzdGVyTGlzdCA9IHNldHRpbmdzLnJlZ2lzdGVyTGlzdDtcclxuICAgICAgICBzb3J0TWFya3NCeVNldHRpbmdzUmVnaXN0ZXJPcmRlcihmaWx0ZXJlZE1hcmtzLCByZWdpc3Rlckxpc3QpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaXNIYXJwb29uTW9kZSAmJiBzZXR0aW5ncy5oYXJwb29uUmVnaXN0ZXJTb3J0QnlMaXN0KSB7XHJcbiAgICAgICAgLy8gU29ydCBtYXJrcyBieSB0aGUgb3JkZXIgb2YgdGhlIGtleSBzeW1ib2xzIGluIHRoZSBoYXJwb29uIHJlZ2lzdGVyIGxpc3RcclxuICAgICAgICBjb25zdCByZWdpc3Rlckxpc3QgPSBzZXR0aW5ncy5oYXJwb29uUmVnaXN0ZXJMaXN0O1xyXG4gICAgICAgIHNvcnRNYXJrc0J5U2V0dGluZ3NSZWdpc3Rlck9yZGVyKGZpbHRlcmVkTWFya3MsIHJlZ2lzdGVyTGlzdCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBzb3J0TWFya3NBbHBoYWJldGljYWxseShmaWx0ZXJlZE1hcmtzKTtcclxuICAgIH1cclxuICAgIHJldHVybiBmaWx0ZXJlZE1hcmtzO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc29ydE1hcmtzQnlTZXR0aW5nc1JlZ2lzdGVyT3JkZXIobWFya3M6IE1hcmtbXSwgcmVnaXN0ZXJzOiBzdHJpbmcgfCBzdHJpbmdbXSkge1xyXG4gICAgY29uc3QgcmVnaXN0ZXJPcmRlciA9IG5ldyBNYXAoWy4uLnJlZ2lzdGVyc10ubWFwKChzeW1ib2wsIGluZGV4KSA9PiBbc3ltYm9sLCBpbmRleF0pKTtcclxuICAgIG1hcmtzLnNvcnQoKGEsIGIpID0+IChyZWdpc3Rlck9yZGVyLmdldChhLnN5bWJvbCkgPz8gSW5maW5pdHkpIC0gKHJlZ2lzdGVyT3JkZXIuZ2V0KGIuc3ltYm9sKSA/PyBJbmZpbml0eSkpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlR2Fwc0ZvckhhcnBvb25NYXJrcyhtYXJrc1RvQ29weTogTWFya1tdLCBoYXJwb29uUmVnaXN0ZXJzOiBzdHJpbmdbXSk6IE1hcmtbXSB7XHJcbiAgICBsZXQgbWFya3MgPSBbLi4ubWFya3NUb0NvcHldO1xyXG5cclxuICAgIGxldCBsZWZ0Q3VyID0gMDtcclxuICAgIGxldCByaWdodEN1ciA9IDA7XHJcblxyXG4gICAgd2hpbGUgKHJpZ2h0Q3VyIDwgaGFycG9vblJlZ2lzdGVycy5sZW5ndGgpIHtcclxuICAgICAgICBjb25zdCBtYXJrRWwgPSBtYXJrcy5maW5kKGVsID0+IGVsLnN5bWJvbCA9PT0gaGFycG9vblJlZ2lzdGVyc1tyaWdodEN1cl0pO1xyXG5cclxuICAgICAgICBpZiAobWFya0VsICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgY29uc3Qgc3ltYm9sVG9TZXRUbyA9IGhhcnBvb25SZWdpc3RlcnNbbGVmdEN1cl07XHJcbiAgICAgICAgICAgIGxldCBmaWx0ZXJlZE1hcmtzID0gbWFya3MuZmlsdGVyKGVsID0+IGVsLnN5bWJvbCAhPT0gaGFycG9vblJlZ2lzdGVyc1tsZWZ0Q3VyXSk7XHJcbiAgICAgICAgICAgIGZpbHRlcmVkTWFya3MucHVzaCh7IHN5bWJvbDogc3ltYm9sVG9TZXRUbywgZmlsZVBhdGg6IG1hcmtFbC5maWxlUGF0aCB9KVxyXG4gICAgICAgICAgICBtYXJrcyA9IGZpbHRlcmVkTWFya3M7XHJcbiAgICAgICAgICAgIGxlZnRDdXIgKz0gMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmlnaHRDdXIgKz0gMTtcclxuICAgIH1cclxuXHJcbiAgICB3aGlsZSAobGVmdEN1ciA8IGhhcnBvb25SZWdpc3RlcnMubGVuZ3RoKSB7XHJcbiAgICAgICAgbWFya3MgPSBtYXJrcy5maWx0ZXIoZWwgPT4gZWwuc3ltYm9sICE9PSBoYXJwb29uUmVnaXN0ZXJzW2xlZnRDdXJdKTtcclxuICAgICAgICBsZWZ0Q3VyICs9IDE7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG1hcmtzO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVzdG9yZUxhc3RDaGFuZ2VkTWFyayhtYXJrczogTWFya1tdLCBsYXN0Q2hhbmdlZE1hcmsgOiBNYXJrKSA6IHttYXJrczogTWFya1tdLCBtYXJrVG9EaXNjYXJkOiBNYXJrIHwgdW5kZWZpbmVkfSB7XHJcbiAgICBjb25zdCBtYXJrVG9SZXN0b3JlID0geyAuLi5sYXN0Q2hhbmdlZE1hcmsgfTtcclxuICAgIGNvbnN0IG1hcmtUb0Rpc2NhcmQgPSBtYXJrcy5maW5kKG0gPT4gbS5zeW1ib2wgPT09IG1hcmtUb1Jlc3RvcmUuc3ltYm9sKTtcclxuICAgIGNvbnN0IG1hcmtzV2l0aG91dERpc2NhcmRlZCA9IG1hcmtzLmZpbHRlcihtID0+IG0uc3ltYm9sICE9PSBtYXJrVG9SZXN0b3JlLnN5bWJvbCk7XHJcblxyXG4gICAgbWFya3NXaXRob3V0RGlzY2FyZGVkLnB1c2goeyBzeW1ib2w6IG1hcmtUb1Jlc3RvcmUuc3ltYm9sLCBmaWxlUGF0aDogbWFya1RvUmVzdG9yZS5maWxlUGF0aCB9KTtcclxuICAgIHJldHVybiB7bWFya3M6IG1hcmtzV2l0aG91dERpc2NhcmRlZCwgbWFya1RvRGlzY2FyZDogbWFya1RvRGlzY2FyZH1cclxufVxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzZXROZXdPck92ZXJ3cml0ZU1hcmsobWFya3M6IE1hcmtbXSwgc2V0TWFyayA6IE1hcmssIGZpbGVQYXRoIDogc3RyaW5nKSA6IHttYXJrczogTWFya1tdLCBvdmVyd3JpdHRlbk1hcms/OiBNYXJrfSB7XHJcbiAgICBjb25zdCB7bWFya3M6IGZpbHRlcmVkTWFya3MsIGRlbGV0ZWRNYXJrOiBvdmVyd3JpdHRlbk1hcmt9ID0gIGRlbGV0ZU1hcmsobWFya3MsIHNldE1hcmspO1xyXG4gICAgZmlsdGVyZWRNYXJrcy5wdXNoKHsgc3ltYm9sOiBzZXRNYXJrLnN5bWJvbCwgZmlsZVBhdGg6IGZpbGVQYXRoIH0pO1xyXG4gICAgcmV0dXJuIHttYXJrczogZmlsdGVyZWRNYXJrcywgb3ZlcndyaXR0ZW5NYXJrfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGRlbGV0ZU1hcmsobWFya3M6IE1hcmtbXSwgbWFya1RvRGVsZXRlOiBNYXJrKSA6IHttYXJrczogTWFya1tdLCBkZWxldGVkTWFyaz86IE1hcmt9IHtcclxuICAgIGNvbnN0IGNNYXJrID0geyAuLi5tYXJrVG9EZWxldGUgfTtcclxuICAgIGNvbnN0IGRlbGV0ZWRNYXJrID0gbWFya3MuZmluZChtID0+IG0uc3ltYm9sID09PSBjTWFyay5zeW1ib2wpO1xyXG4gICAgY29uc3QgZmlsdGVyZWRNYXJrcyA9IG1hcmtzLmZpbHRlcihtID0+IG0uc3ltYm9sICE9PSBjTWFyay5zeW1ib2wpO1xyXG4gICAgcmV0dXJuIHttYXJrczogZmlsdGVyZWRNYXJrcywgZGVsZXRlZE1hcmt9O1xyXG59IiwgImltcG9ydCB7IG1vZGFsRGVmYXVsdEtleWJpbmRzLCBtb2RhbERlZmF1bHRLZXliaW5kc01hYyB9IGZyb20gXCIuL2RlZmF1bHRWYWx1ZXNcIjtcclxuaW1wb3J0IHsgTW9kYWxLZXliaW5kcyB9IGZyb20gXCIuLi90eXBlc1wiO1xyXG5pbXBvcnQgeyBTZXR0aW5ncyB9IGZyb20gXCIuLi90eXBlc1wiO1xyXG5cclxuLy8gVXRpbGl0eSB0byBwcmVwYXJlIGtleWJpbmRzIG9iamVjdFxyXG5leHBvcnQgZnVuY3Rpb24gcHJlcGFyZUtleWJpbmRzKGlzTWFjT1M6IGJvb2xlYW4sIHNldHRpbmdzOiBTZXR0aW5ncykge1xyXG4gICAgbGV0IGtleWJpbmRzOiBNb2RhbEtleWJpbmRzID0gKCFpc01hY09TKSA/IHsgLi4ubW9kYWxEZWZhdWx0S2V5YmluZHMgfSA6IHsgLi4ubW9kYWxEZWZhdWx0S2V5YmluZHNNYWMgfTtcclxuXHJcbiAgICBpZiAoc2V0dGluZ3MubW9kYWxMaXN0VXApIHtcclxuICAgICAgICBrZXliaW5kcy51cCA9IFtzZXR0aW5ncy5tb2RhbExpc3RVcF07XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHNldHRpbmdzLm1vZGFsTGlzdERvd24pIHtcclxuICAgICAgICBrZXliaW5kcy5kb3duID0gW3NldHRpbmdzLm1vZGFsTGlzdERvd25dO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChzZXR0aW5ncy5tb2RhbExpc3REZWxldGUpIHtcclxuICAgICAgICBrZXliaW5kcy5kZWxldGUgPSBbc2V0dGluZ3MubW9kYWxMaXN0RGVsZXRlXTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoc2V0dGluZ3MubW9kYWxMaXN0U2VsZWN0KSB7XHJcbiAgICAgICAga2V5YmluZHMuc2VsZWN0ID0gW3NldHRpbmdzLm1vZGFsTGlzdFNlbGVjdF07XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHNldHRpbmdzLm1vZGFsTGlzdFVuZG8pIHtcclxuICAgICAgICBrZXliaW5kcy51bmRvID0gW3NldHRpbmdzLm1vZGFsTGlzdFVuZG9dO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChzZXR0aW5ncy5tb2RhbExpc3RDYW5jZWwpIHtcclxuICAgICAgICBrZXliaW5kcy5jYW5jZWwgPSBbc2V0dGluZ3MubW9kYWxMaXN0Q2FuY2VsXTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ga2V5YmluZHM7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbWF0Y2hLZXliaW5kKGV2dDogS2V5Ym9hcmRFdmVudCwga2V5YmluZDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICAvLyBQYXJzZSBrZXliaW5kIHN0cmluZyBsaWtlICdjdHJsK3NoaWZ0K3AnLCAnY21kK24nLCBldGMuXHJcbiAgICBjb25zdCBwYXJ0cyA9IGtleWJpbmQuc3BsaXQoJysnKS5tYXAocCA9PiBwLnRyaW0oKSk7XHJcbiAgICBsZXQgcmVxdWlyZWQgPSB7IGN0cmw6IGZhbHNlLCBzaGlmdDogZmFsc2UsIGFsdDogZmFsc2UsIG1ldGE6IGZhbHNlLCBrZXk6ICcnIH07XHJcbiAgICBmb3IgKGNvbnN0IHBhcnQgb2YgcGFydHMpIHtcclxuICAgICAgICBpZiAocGFydCA9PT0gJ2N0cmwnKSByZXF1aXJlZC5jdHJsID0gdHJ1ZTtcclxuICAgICAgICBlbHNlIGlmIChwYXJ0ID09PSAnc2hpZnQnKSByZXF1aXJlZC5zaGlmdCA9IHRydWU7XHJcbiAgICAgICAgZWxzZSBpZiAocGFydCA9PT0gJ2FsdCcpIHJlcXVpcmVkLmFsdCA9IHRydWU7XHJcbiAgICAgICAgZWxzZSBpZiAocGFydCA9PT0gJ21ldGEnIHx8IHBhcnQgPT09ICdjbWQnIHx8IHBhcnQgPT09ICd3aW4nKSByZXF1aXJlZC5tZXRhID0gdHJ1ZTtcclxuICAgICAgICBlbHNlIHJlcXVpcmVkLmtleSA9IHBhcnQ7XHJcbiAgICB9XHJcbiAgICAvLyBDaGVjayBtb2RpZmllcnNcclxuICAgIGlmIChldnQuY3RybEtleSAhPT0gcmVxdWlyZWQuY3RybCkgcmV0dXJuIGZhbHNlO1xyXG4gICAgaWYgKGV2dC5zaGlmdEtleSAhPT0gcmVxdWlyZWQuc2hpZnQpIHJldHVybiBmYWxzZTtcclxuICAgIGlmIChldnQuYWx0S2V5ICE9PSByZXF1aXJlZC5hbHQpIHJldHVybiBmYWxzZTtcclxuICAgIGlmIChldnQubWV0YUtleSAhPT0gcmVxdWlyZWQubWV0YSkgcmV0dXJuIGZhbHNlO1xyXG4gICAgLy8gQ2hlY2sga2V5IChjYXNlLWluc2Vuc2l0aXZlKVxyXG4gICAgcmV0dXJuIGV2dC5rZXkgPT09IHJlcXVpcmVkLmtleTtcclxufSIsICJpbXBvcnQgeyBBcHAsIG5vcm1hbGl6ZVBhdGgsIE5vdGljZSwgVEZpbGUsIFdvcmtzcGFjZUxlYWYgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBvcGVuTmV3RmlsZShmaWxlUGF0aDogc3RyaW5nLCBvcGVuRmlsZUluTmV3VGFiOiBib29sZWFuLCBhcHA6IEFwcCkge1xyXG4gICAgY29uc3QgZmlsZSA9IGFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpO1xyXG4gICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG4gICAgICAgIGlmIChvcGVuRmlsZUluTmV3VGFiKSB7XHJcbiAgICAgICAgICAgIGFwcC53b3Jrc3BhY2UuZ2V0TGVhZigndGFiJykub3BlbkZpbGUoZmlsZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgYXBwLndvcmtzcGFjZS5nZXRMZWFmKCkub3BlbkZpbGUoZmlsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgbmV3IE5vdGljZShgRmlsZSBub3QgZm91bmQgZm9yIHBhdGggJHtmaWxlUGF0aH0uIFRoZSBmaWxlIG1heSBoYXZlIGJlZW4gZGVsZXRlZCwgbW92ZWQgb3IgcmVuYW1lZC5gKTtcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEZpbmRzIGFsbCBvcGVuZWQgZmlsZXMgaW4gdGhlIG1haW4gYXJlYSB0aHJvdWdoIHdvcmtzcGFjZS5nZXRMYXlvdXQoKS4gTm90IEFQSSBjb21wbGlhbnQuIENhbiBicmVhayBhbnl0aW1lLiBHZXRzIGFsbCBvcGVuZWQgZmlsZXMgcmVnYXJkbGVzcyBvZiBzdGF0ZS4gXHJcbiAqICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRBbGxPcGVuZWRGaWxlc0V4cGVyaW1lbnRhbChhcHA6IEFwcCk6IGFueSB7XHJcbiAgICAvLyBAdHMtaWdub3JlXHJcbiAgICBjb25zdCB0YWJHcm91cHMgPSBhcHAud29ya3NwYWNlLmdldExheW91dCgpLm1haW4/LmNoaWxkcmVuO1xyXG4gICAgY29uc3Qgb3V0ID0gW107XHJcbiAgICBmb3IgKGNvbnN0IGVsIG9mIHRhYkdyb3Vwcykge1xyXG4gICAgICAgIG91dC5wdXNoKC4uLmVsLmNoaWxkcmVuKVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG91dDtcclxufVxyXG5cclxuLyoqXHJcbiAqIEZpbmRzIGFsbCB3b3Jrc3BhY2UgbGVhdmVzIHRocm91Z2ggd29ya3NwYWNlLml0ZXJhdGVBbGxMZWF2ZXMuIEFQSSBjb21wbGlhbnQuIElnbm9yZXMgYWxsIHRoZSBub24gaW5zdGFudGlhdGVkIGxlYXZlcy5cclxuICogKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEFsbFdvcmtzcGFjZUxlYXZlcyhhcHA6IEFwcCk6IFdvcmtzcGFjZUxlYWZbXSB7XHJcbiAgICBjb25zdCBsaXN0OiBXb3Jrc3BhY2VMZWFmW10gPSBbXVxyXG4gICAgYXBwLndvcmtzcGFjZS5pdGVyYXRlQWxsTGVhdmVzKGxlYWYgPT4ge1xyXG4gICAgICAgIGxpc3QucHVzaChsZWFmKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBsaXN0O1xyXG59XHJcblxyXG4vKipcclxuICogU2V0cyBhY3RpdmUgYW4gb3BlbmVkIGZpbGUgdGhhdCBtYXRjaGVzIHRoZSBpbnB1dCBmaWxlIHBhdGguIFJlc3BlY3RzIHRhYiBncm91cGluZy4gUmV0dXJucyBzdWNjZXNzIGJvb2wuICBcclxuICogQHB1YmxpY1xyXG4gKiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gbmF2aWdhdGVUb09wZW5lZEZpbGVCeVBhdGgoZmlsZVBhdGg6IHN0cmluZywgZXhwZXJpbWVudGFsR290bzogYm9vbGVhbiwgYXBwOiBBcHApOiBib29sZWFuIHtcclxuICAgIGlmIChleHBlcmltZW50YWxHb3RvKSB7XHJcbiAgICAgICAgY29uc3Qgb3BlbmVkRmlsZXMgPSBnZXRBbGxPcGVuZWRGaWxlc0V4cGVyaW1lbnRhbChhcHApXHJcbiAgICAgICAgZm9yIChjb25zdCBvcGVuZWRGaWxlIG9mIG9wZW5lZEZpbGVzKSB7XHJcbiAgICAgICAgICAgIGlmIChvcGVuZWRGaWxlLnR5cGUgPT0gJ2xlYWYnICYmIG9wZW5lZEZpbGUuc3RhdGUuc3RhdGUuZmlsZSA9PT0gZmlsZVBhdGgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGxlYWYgPSBhcHAud29ya3NwYWNlLmdldExlYWZCeUlkKG9wZW5lZEZpbGUuaWQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGxlYWYgJiYgbGVhZi5wYXJlbnQgPT09IGFwcC53b3Jrc3BhY2UuZ2V0TGVhZigpLnBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFwcC53b3Jrc3BhY2Uuc2V0QWN0aXZlTGVhZihsZWFmLCB7IGZvY3VzOiB0cnVlIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgY29uc3QgbGVhdmVzID0gZ2V0QWxsV29ya3NwYWNlTGVhdmVzKGFwcCk7XHJcbiAgICAgICAgZm9yIChjb25zdCBsZWFmIG9mIGxlYXZlcykge1xyXG4gICAgICAgICAgICBjb25zdCB2aWV3ID0gbGVhZi52aWV3O1xyXG4gICAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yXHJcbiAgICAgICAgICAgIGlmICh2aWV3LmZpbGUgJiYgdmlldy5maWxlLnBhdGggPT09IGZpbGVQYXRoICYmIGxlYWYucGFyZW50ID09PSBhcHAud29ya3NwYWNlLmdldExlYWYoKS5wYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgIGFwcC53b3Jrc3BhY2Uuc2V0QWN0aXZlTGVhZihsZWFmLCB7IGZvY3VzOiB0cnVlIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG59IiwgImltcG9ydCBUZXRoZXJNYXJrc1BsdWdpbiBmcm9tICcuL21haW4nO1xyXG5pbXBvcnQgeyBNYXJrTGlzdE1vZGFsIH0gZnJvbSAnLi91aS9NYXJrTGlzdE1vZGFsJztcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZXRHbG9iYWxNYXJrKHBsdWdpbjogVGV0aGVyTWFya3NQbHVnaW4pIHtcclxuICAgIG5ldyBNYXJrTGlzdE1vZGFsKHBsdWdpbi5hcHAsIHBsdWdpbiwgJ3NldCcpLm9wZW4oKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdvVG9HbG9iYWxNYXJrKHBsdWdpbjogVGV0aGVyTWFya3NQbHVnaW4pIHtcclxuICAgIG5ldyBNYXJrTGlzdE1vZGFsKHBsdWdpbi5hcHAsIHBsdWdpbiwgJ2dvdG8nKS5vcGVuKCk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVHbG9iYWxNYXJrKHBsdWdpbjogVGV0aGVyTWFya3NQbHVnaW4pIHtcclxuICAgIG5ldyBNYXJrTGlzdE1vZGFsKHBsdWdpbi5hcHAsIHBsdWdpbiwgJ2RlbGV0ZScpLm9wZW4oKTtcclxufVxyXG5cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhZGRGaWxlVG9IYXJwb29uKHBsdWdpbjogVGV0aGVyTWFya3NQbHVnaW4pIHtcclxuICAgIG5ldyBNYXJrTGlzdE1vZGFsKHBsdWdpbi5hcHAsIHBsdWdpbiwgJ2dvdG8nKS5hZGRGaWxlVG9IYXJwb29uKCk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnb1RvSGFycG9vbk1hcmsocGx1Z2luOiBUZXRoZXJNYXJrc1BsdWdpbikge1xyXG4gICAgbmV3IE1hcmtMaXN0TW9kYWwocGx1Z2luLmFwcCwgcGx1Z2luLCAnZ290bycsIHRydWUpLm9wZW4oKTtcclxufSIsICJpbXBvcnQgeyBBcHAsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgVGV0aGVyTWFya3NQbHVnaW4gZnJvbSAnLi4vbWFpbic7XG5pbXBvcnQgeyBTZXR0aW5ncyB9IGZyb20gJy4uL3R5cGVzL2luZGV4JztcbmltcG9ydCB7IGRlZmF1bHRTZXR0aW5ncyB9IGZyb20gJy4uL3V0aWxzL2RlZmF1bHRWYWx1ZXMnO1xuXG5leHBvcnQgY2xhc3MgU2V0dGluZ3NUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcbiAgICBwbHVnaW46IFRldGhlck1hcmtzUGx1Z2luO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogVGV0aGVyTWFya3NQbHVnaW4pIHtcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB9XG5cbiAgICBkaXNwbGF5KCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuICAgICAgICBjb25zdCBkcyA9IGRlZmF1bHRTZXR0aW5ncztcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdPcGVuIG1hcmsgaW4gbmV3IHRhYicpXG4gICAgICAgICAgICAuc2V0RGVzYygnT3BlbiBhIGZpbGUgaW4gdGhlIG5ldyB0YWIgd2hlbiB1c2luZyBcImdvIHRvXCIgY29tbWFuZC4gSWYgZGlzYWJsZWQsIGl0IHdpbGwgb3BlbiB0aGUgZmlsZSBpbiB0aGUgY3VycmVudCB0YWIuJylcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcGVuTWFya0luTmV3VGFiID8/IGRzLm9wZW5NYXJrSW5OZXdUYWIpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcGVuTWFya0luTmV3VGFiID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ05vIGR1cGxpY2F0aW9uIG9mIG9wZW5lZCBmaWxlcyB3aGVuIHVzaW5nIEdvIHRvIGNvbW1hbmRzIChleHBlcmltZW50YWwpJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdQcmV2ZW50cyBkdXBsaWNhdGUgdGFicyB3aGVuIHN3aXRjaGluZyB0byBhbHJlYWR5IG9wZW5lZCBmaWxlcyB1c2luZyB0aGUgbWFyayBsaXN0IGFmdGVyIHJlc3RhcnRpbmcgT2JzaWRpYW4uIChFeHBlcmltZW50YWw6IG1heSBub3Qgd29yayBpbiBmdXR1cmUgT2JzaWRpYW4gdmVyc2lvbnMuKScpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhwZXJpbWVudGFsR290byA/PyBkcy5leHBlcmltZW50YWxHb3RvKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhwZXJpbWVudGFsR290byA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZSgnR2VuZXJhbCByZWdpc3RlcnMnKS5zZXRIZWFkaW5nKCk7XG4gICAgICAgIHRoaXMuY3JlYXRlUmVnaXN0ZXJMaXN0U2V0dGluZyhjb250YWluZXJFbCwgXCJSZWdpc3RlciBsaXN0XCIsIGRzLnJlZ2lzdGVyTGlzdCwgJ0tleSBzeW1ib2xzIHRvIGJlIHVzZWQgYXMgcmVnaXN0ZXJzLiBPbmx5IGluY2x1ZGUgc3ltYm9scyB0aGF0IHlvdSBjYW4gaW5wdXQgd2l0aCBhIHNpbmdsZSBrZXlzdHJva2UuJywgJ3JlZ2lzdGVyTGlzdCcpXG4gICAgICAgICAgICAuYWRkRXh0cmFCdXR0b24oKGJ0bikgPT4ge1xuICAgICAgICAgICAgICAgIGJ0blxuICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbigncmVmcmVzaC1jY3cnKVxuICAgICAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcCgnUmVzZXQgdG8gZGVmYXVsdCByZWdpc3RlciBsaXN0JylcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucmVnaXN0ZXJMaXN0ID0gZHMucmVnaXN0ZXJMaXN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTsgLy8gUmVmcmVzaCB0aGUgc2V0dGluZ3MgdGFiIHRvIHNob3cgdGhlIHVwZGF0ZWQgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSlcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdTb3J0IGFsbCBtYXJrcyBieSByZWdpc3RlciBsaXN0JylcbiAgICAgICAgICAgIC5zZXREZXNjKCdTb3J0IG1hcmtzIGJ5IHRoZSBvcmRlciBvZiB0aGUga2V5IHN5bWJvbHMgaW4gdGhlIHJlZ2lzdGVyIGxpc3QuIElmIGRpc2FibGVkLCBtYXJrcyB3aWxsIGJlIHNvcnRlZCBhbHBoYWJldGljYWxseSBhY2NvcmRpbmcgdG8gdGhlIGN1cnJlbnQgbG9jYWxlLicpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucmVnaXN0ZXJTb3J0QnlMaXN0ID8/IGRzLnJlZ2lzdGVyU29ydEJ5TGlzdClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnJlZ2lzdGVyU29ydEJ5TGlzdCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAvLyBUT0RPOiBpbXBsZW1lbnQgdGhpcyBmZWF0dXJlXG4gICAgICAgIC8vIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAvLyAgICAgLnNldE5hbWUoJ0hpZGUgbWFyayBsaXN0JylcbiAgICAgICAgLy8gICAgIC5zZXREZXNjKCdIaWRlIHRoZSBnbG9iYWwgbWFyayBsaXN0IGZvciBib3RoIGNvbW1hbmRzIChmb3IgZmFzdCBpbnB1dCwgbm8gZmxpY2tlcikuJylcbiAgICAgICAgLy8gICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuICAgICAgICAvLyAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5oaWRlTWFya0xpc3REdXJpbmdJbnB1dCA/PyBkcy5oaWRlTWFya0xpc3REdXJpbmdJbnB1dClcbiAgICAgICAgLy8gICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgIC8vICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmhpZGVNYXJrTGlzdER1cmluZ0lucHV0ID0gdmFsdWU7XG4gICAgICAgIC8vICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAvLyAgICAgICAgIH0pKTtcblxuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKCdIYXJwb29uIHJlZ2lzdGVycycpLnNldEhlYWRpbmcoKTtcbiAgICAgICAgdGhpcy5jcmVhdGVSZWdpc3Rlckxpc3RTZXR0aW5nKGNvbnRhaW5lckVsLCBcIkhhcnBvb24gcmVnaXN0ZXIgbGlzdFwiLCBkcy5oYXJwb29uUmVnaXN0ZXJMaXN0LCAnS2V5IHN5bWJvbHMgdG8gYmUgdXNlZCBhcyBIYXJwb29uIHJlZ2lzdGVycy4gT25seSBpbmNsdWRlIHN5bWJvbHMgdGhhdCB5b3UgY2FuIGlucHV0IHdpdGggYSBzaW5nbGUga2V5c3Ryb2tlLicsICdoYXJwb29uUmVnaXN0ZXJMaXN0JylcbiAgICAgICAgICAgIC5hZGRFeHRyYUJ1dHRvbigoYnRuKSA9PiB7XG4gICAgICAgICAgICAgICAgYnRuXG4gICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKCdyZWZyZXNoLWNjdycpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKCdSZXNldCB0byBkZWZhdWx0IEhhcnBvb24gcmVnaXN0ZXIgbGlzdCcpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmhhcnBvb25SZWdpc3Rlckxpc3QgPSBkcy5oYXJwb29uUmVnaXN0ZXJMaXN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTsgLy8gUmVmcmVzaCB0aGUgc2V0dGluZ3MgdGFiIHRvIHNob3cgdGhlIHVwZGF0ZWQgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSlcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdTb3J0IEhhcnBvb24gbWFya3MgYnkgSGFycG9vbiByZWdpc3RlciBsaXN0JylcbiAgICAgICAgICAgIC5zZXREZXNjKCdTb3J0IEhhcnBvb24gbWFya3MgYnkgdGhlIG9yZGVyIG9mIHRoZSBrZXkgc3ltYm9scyBpbiB0aGUgSGFycG9vbiByZWdpc3RlciBsaXN0LiBJZiBkaXNhYmxlZCwgbWFya3Mgd2lsbCBiZSBzb3J0ZWQgYWxwaGFiZXRpY2FsbHkgYWNjb3JkaW5nIHRvIHRoZSBjdXJyZW50IGxvY2FsZS4nKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmhhcnBvb25SZWdpc3RlclNvcnRCeUxpc3QgPz8gZHMuaGFycG9vblJlZ2lzdGVyU29ydEJ5TGlzdClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmhhcnBvb25SZWdpc3RlclNvcnRCeUxpc3QgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnUmVtb3ZlIGdhcHMgaW5iZXR3ZWVuIEhhcnBvb24gbWFya3MnKVxuICAgICAgICAgICAgLnNldERlc2MoJ0hhcnBvb24gbWFya3Mgd2lsbCBiZSBzaGlmdGVkIHRvIHRoZSBsZWZ0IGZvciBldmVyeSBnYXAgKHJlZ2lzdGVyIHdpdGggbm8gbWFyaykgYmFzZWQgb24gdGhlIG9yZGVyIG9mIHRoZSBIYXJwb29uIHJlZ2lzdGVyIGxpc3QuJylcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5oYXJwb29uUmVnaXN0ZXJHYXBSZW1vdmFsID8/IGRzLmhhcnBvb25SZWdpc3RlckdhcFJlbW92YWwpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5oYXJwb29uUmVnaXN0ZXJHYXBSZW1vdmFsID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuXG5cbiAgICAgICAgLy8gQWRkIGtleWJvYXJkIHNob3J0Y3V0IHNldHRpbmdzXG4gICAgICAgIC8vIFRPRE86IHNldHRpbmcgdGhvc2UgdmFsdWVzIGhlcmUgbGlrZSBmZWVscyB3cm9uZywgZXNwZWNpYWxseSBwYXNzaW5nIG9iamVjdCBwcm9wZXJ0eSBhcyBzdHJpbmdcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnTGlzdCBuYXZpZ2F0aW9uIHNob3J0Y3V0cycgfSk7XG4gICAgICAgIHRoaXMuY3JlYXRlU2hvcnRjdXRTZXR0aW5nKGNvbnRhaW5lckVsLCAnVXAnLCBkcy5tb2RhbExpc3RVcCwgJ1Nob3J0Y3V0IGZvciBtb3ZpbmcgdXAgaW4gdGhlIGxpc3QnLCAnbW9kYWxMaXN0VXAnKTtcbiAgICAgICAgdGhpcy5jcmVhdGVTaG9ydGN1dFNldHRpbmcoY29udGFpbmVyRWwsICdEb3duJywgZHMubW9kYWxMaXN0RG93biwgJ1Nob3J0Y3V0IGZvciBtb3ZpbmcgZG93biBpbiB0aGUgbGlzdCcsICdtb2RhbExpc3REb3duJyk7XG4gICAgICAgIHRoaXMuY3JlYXRlU2hvcnRjdXRTZXR0aW5nKGNvbnRhaW5lckVsLCAnU2VsZWN0JywgZHMubW9kYWxMaXN0U2VsZWN0LCAnU2hvcnRjdXQgZm9yIHNlbGVjdGluZyBhIG1hcmsnLCAnbW9kYWxMaXN0U2VsZWN0Jyk7XG4gICAgICAgIHRoaXMuY3JlYXRlU2hvcnRjdXRTZXR0aW5nKGNvbnRhaW5lckVsLCAnQ2FuY2VsJywgZHMubW9kYWxMaXN0Q2FuY2VsLCAnU2hvcnRjdXQgZm9yIGNhbmNlbGxpbmcgdGhlIG1vZGFsJywgJ21vZGFsTGlzdENhbmNlbCcpO1xuICAgICAgICB0aGlzLmNyZWF0ZVNob3J0Y3V0U2V0dGluZyhjb250YWluZXJFbCwgJ0RlbGV0ZScsIGRzLm1vZGFsTGlzdERlbGV0ZSwgJ1Nob3J0Y3V0IGZvciBkZWxldGluZyBhIG1hcmsnLCAnbW9kYWxMaXN0RGVsZXRlJyk7XG4gICAgICAgIHRoaXMuY3JlYXRlU2hvcnRjdXRTZXR0aW5nKGNvbnRhaW5lckVsLCAnUmVzdG9yZSBsYXN0IGNoYW5nZWQgbWFyaycsIGRzLm1vZGFsTGlzdFVuZG8sICdTaG9ydGN1dCBmb3IgdW5kb2luZyBsYXN0IGFjdGlvbiBvZiBjaGFuZ2luZyBhIG1hcmsnLCAnbW9kYWxMaXN0VW5kbycpO1xuXG5cbiAgICB9XG5cbiAgICAvLyB1c2Ugb25seSBmb3Igc3RyaW5nIHZhbHVlcyBmcm9tIFNldHRpbmdzIHR5cGVcbiAgICBjcmVhdGVTaG9ydGN1dFNldHRpbmcoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LCBuYW1lOiBzdHJpbmcsIGRlZmF1bHRWYWx1ZTogc3RyaW5nLCBkZXNjOiBzdHJpbmcsIGtleToga2V5b2YgU2V0dGluZ3MpIHtcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShuYW1lKVxuICAgICAgICAgICAgLnNldERlc2MoZGVzYylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShTdHJpbmcodGhpcy5wbHVnaW4uc2V0dGluZ3Nba2V5XSA/PyBkZWZhdWx0VmFsdWUpKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgKHRoaXMucGx1Z2luLnNldHRpbmdzIGFzIGFueSlba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgfVxuXG4gICAgY3JlYXRlUmVnaXN0ZXJMaXN0U2V0dGluZyhjb250YWluZXJFbDogSFRNTEVsZW1lbnQsIG5hbWU6IHN0cmluZywgZGVmYXVsdFZhbHVlOiBzdHJpbmcsIGRlc2M6IHN0cmluZywga2V5OiBrZXlvZiBTZXR0aW5ncyk6IFNldHRpbmcge1xuICAgICAgICByZXR1cm4gbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShuYW1lKVxuICAgICAgICAgICAgLnNldERlc2MoZGVzYylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShTdHJpbmcodGhpcy5wbHVnaW4uc2V0dGluZ3Nba2V5XSA/PyBkZWZhdWx0VmFsdWUpKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgKHRoaXMucGx1Z2luLnNldHRpbmdzIGFzIGFueSlba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgfVxufSIsICJpbXBvcnQgeyBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCBUZXRoZXJNYXJrc1BsdWdpbiBmcm9tICcuLi9tYWluJztcclxuaW1wb3J0IHsgU2V0dGluZ3MsIE1hcmsgfSBmcm9tICcuLi90eXBlcy9pbmRleCc7XHJcbmltcG9ydCB7IGRlZmF1bHRTZXR0aW5ncywgSlNPTnNjaGVtYVZlcnNpb24gYXMgbGF0ZXN0SlNPTlNjaGVtYVZlcnNpb24gfSBmcm9tICcuL2RlZmF1bHRWYWx1ZXMnO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvYWRTZXR0aW5ncyhwbHVnaW46IFRldGhlck1hcmtzUGx1Z2luKTogUHJvbWlzZTxTZXR0aW5ncz4ge1xyXG4gICAgcmV0dXJuIChhd2FpdCBwbHVnaW4ubG9hZERhdGEoKSk/LnNldHRpbmdzIHx8IGRlZmF1bHRTZXR0aW5ncztcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNhdmVTZXR0aW5ncyhwbHVnaW46IFRldGhlck1hcmtzUGx1Z2luLCBzZXR0aW5nczogU2V0dGluZ3MpIHtcclxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBwbHVnaW4ubG9hZERhdGEoKSB8fCB7fTtcclxuICAgIGRhdGEuc2V0dGluZ3MgPSBzZXR0aW5ncztcclxuICAgIGF3YWl0IHBsdWdpbi5zYXZlRGF0YShkYXRhKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvYWRNYXJrcyhwbHVnaW46IFRldGhlck1hcmtzUGx1Z2luKTogUHJvbWlzZTxNYXJrW10+IHtcclxuICAgIHJldHVybiAoYXdhaXQgcGx1Z2luLmxvYWREYXRhKCkpPy5tYXJrcyB8fCBbXTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNhdmVNYXJrcyhwbHVnaW46IFRldGhlck1hcmtzUGx1Z2luLCBtYXJrczogTWFya1tdKSB7XHJcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcGx1Z2luLmxvYWREYXRhKCkgfHwge307XHJcbiAgICBkYXRhLm1hcmtzID0gbWFya3M7XHJcbiAgICBhd2FpdCBwbHVnaW4uc2F2ZURhdGEoZGF0YSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkTGFzdENoYW5nZWRNYXJrKHBsdWdpbjogVGV0aGVyTWFya3NQbHVnaW4pOiBQcm9taXNlPE1hcms+IHtcclxuICAgIHJldHVybiAoYXdhaXQgcGx1Z2luLmxvYWREYXRhKCkpPy5sYXN0Q2hhbmdlZE1hcmsgfHwge307XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzYXZlTGFzdENoYW5nZWRNYXJrKHBsdWdpbjogVGV0aGVyTWFya3NQbHVnaW4sIGxhc3RDaGFuZ2VkTWFyazogTWFyaykge1xyXG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHBsdWdpbi5sb2FkRGF0YSgpIHx8IHt9O1xyXG4gICAgZGF0YS5sYXN0Q2hhbmdlZE1hcmsgPSBsYXN0Q2hhbmdlZE1hcms7XHJcbiAgICBhd2FpdCBwbHVnaW4uc2F2ZURhdGEoZGF0YSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBKU09Oc2NoZW1hQ2hlY2socGx1Z2luOiBUZXRoZXJNYXJrc1BsdWdpbikge1xyXG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHBsdWdpbi5sb2FkRGF0YSgpIHx8IHtzY2hlbWFWZXJzaW9uOiBsYXRlc3RKU09OU2NoZW1hVmVyc2lvbn07XHJcblxyXG4gICAgaWYgKGRhdGEuc2NoZW1hVmVyc2lvbiAmJiBkYXRhLnNjaGVtYVZlcnNpb24gPT09IGxhdGVzdEpTT05TY2hlbWFWZXJzaW9uKXtcclxuICAgICAgICByZXR1cm5cclxuICAgIH1cclxuXHJcbiAgICBuZXcgTm90aWNlKHBsdWdpbi5tYW5pZmVzdC5uYW1lICsgXCI6IEZhdWx0eSBkYXRhLiBDaGVjayBkZXZlbG9wZXIgdG9vbHMgZm9yIG1vcmUgaW5mby5cIik7XHJcbiAgICBjb25zb2xlLmVycm9yKHBsdWdpbi5tYW5pZmVzdC5pZCArIFwiOiBUaGUgZGF0YSBsb2FkZWQgaXMgbm90IGluIGNvcnJlY3QgZm9ybWF0LiBUaGUgcGx1Z2luIG1heSBub3Qgd29yayBwcm9wZXJseS4gVGhpcyB1c3VhbGx5IGhhcHBlbnMgYWZ0ZXIgcGx1Z2luIHVwZGF0ZSB0aGF0IGNoYW5nZXMgdGhlIEpTT04gc2NoZW1hLiBcIik7XHJcbiAgICAvLyBUT0RPOiBtYWtlIGF1dG9tYXRpYyBjb252ZXJzaW9ucyBoZXJlIGlmIG5lY2Vzc2FyeSBpbiB0aGUgZnV0dXJlLiBCZSBzdXJlIHRvIHNhdmUgdGhlIGxlZ2FjeSBwcmUgY29udmVyc2lvbiBkYXRhIGFzIGJhY2t1cCBpbiB0aGUgXCJsZWdhY3lTY2hlbWFEYXRhXCIgZmllbGQuIFxyXG59Il0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQUFBQSxtQkFBdUI7OztBQ0F2QixJQUFBQyxtQkFBaUU7OztBQ0UxRCxJQUFNLHVCQUFzQztBQUFBLEVBQy9DLElBQUksQ0FBQyxVQUFVLFFBQVE7QUFBQSxFQUN2QixNQUFNLENBQUMsVUFBVSxRQUFRO0FBQUEsRUFDekIsUUFBUSxDQUFDLFFBQVE7QUFBQSxFQUNqQixRQUFRLENBQUMsT0FBTztBQUFBLEVBQ2hCLFFBQVEsQ0FBQyxRQUFRO0FBQUEsRUFDakIsTUFBTSxDQUFDLFFBQVE7QUFDbkI7QUFFTyxJQUFNLDBCQUF5QztBQUFBLEVBQ2xELElBQUksQ0FBQyxTQUFTLE9BQU87QUFBQSxFQUNyQixNQUFNLENBQUMsU0FBUyxPQUFPO0FBQUEsRUFDdkIsUUFBUSxDQUFDLE9BQU87QUFBQSxFQUNoQixRQUFRLENBQUMsT0FBTztBQUFBLEVBQ2hCLFFBQVEsQ0FBQyxRQUFRO0FB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LE9BQU8sU0FBUyxLQUFLLHVKQUF1SjtBQUU5TDs7O0FSdkNBLElBQXFCLG9CQUFyQixjQUErQyx3QkFBTztBQUFBLEVBQXREO0FBQUE7QUFFSSxpQkFBZ0IsQ0FBQztBQUNqQiwyQkFBK0I7QUFBQTtBQUFBLEVBRS9CLE1BQU0sU0FBUztBQUNYLFVBQU0sZ0JBQWdCLElBQUk7QUFFMUIsU0FBSyxXQUFXLE1BQU0sYUFBYSxJQUFJO0FBQ3ZDLFNBQUssUUFBUSxNQUFNLFVBQVUsSUFBSTtBQUNqQyxTQUFLLGtCQUFrQixNQUFNLG9CQUFvQixJQUFJO0FBRXJELFNBQUssV0FBVztBQUFBLE1BQ1osSUFBSTtBQUFBLE1BQ0osTUFBTTtBQUFBLE1BQ04sVUFBVSxNQUFNLGNBQWMsSUFBSTtBQUFBLElBQ3RDLENBQUM7QUFFRCxTQUFLLFdBQVc7QUFBQSxNQUNaLElBQUk7QUFBQSxNQUNKLE1BQU07QUFBQSxNQUNOLFVBQVUsTUFBTSxlQUFlLElBQUk7QUFBQSxJQUN2QyxDQUFDO0FBRUQsU0FBSyxXQUFXO0FBQUEsTUFDWixJQUFJO0FBQUEsTUFDSixNQUFNO0FBQUEsTUFDTixVQUFVLE1BQU0saUJBQWlCLElBQUk7QUFBQSxJQUN6QyxDQUFDO0FBRUQsU0FBSyxXQUFXO0FBQUEsTUFDWixJQUFJO0FBQUEsTUFDSixNQUFNO0FBQUEsTUFDTixVQUFVLE1BQU0saUJBQWlCLElBQUk7QUFBQSxJQUN6QyxDQUFDO0FBRUQsU0FBSyxXQUFXO0FBQUEsTUFDWixJQUFJO0FBQUEsTUFDSixNQUFNO0FBQUEsTUFDTixVQUFVLE1BQU0sZ0JBQWdCLElBQUk7QUFBQSxJQUN4QyxDQUFDO0FBRUQsU0FBSyxjQUFjLElBQUksWUFBWSxLQUFLLEtBQUssSUFBSSxDQUFDO0FBRWxELFlBQVEsSUFBSSxhQUFhLEtBQUssU0FBUyxFQUFFO0FBQUEsRUFDN0M7QUFBQSxFQUVBLE1BQU0sZUFBZTtBQUNqQixVQUFNLGFBQWEsTUFBTSxLQUFLLFFBQVE7QUFBQSxFQUMxQztBQUFBLEVBRUEsTUFBTSxVQUFVLE9BQWU7QUFDM0IsU0FBSyxRQUFRO0FBQ2IsVUFBTSxVQUFVLE1BQU0sS0FBSztBQUFBLEVBQy9CO0FBQUEsRUFFQSxNQUFNLG9CQUFvQixpQkFBdUI7QUFDN0MsU0FBSyxrQkFBa0I7QUFDdkIsVUFBTSxvQkFBb0IsTUFBTSxlQUFlO0FBQUEsRUFDbkQ7QUFBQSxFQUVBLFdBQVc7QUFDUCxZQUFRLElBQUksZUFBZSxLQUFLLFNBQVMsRUFBRTtBQUFBLEVBQy9DO0FBQ0o7IiwKICAibmFtZXMiOiBbImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiJdCn0K
